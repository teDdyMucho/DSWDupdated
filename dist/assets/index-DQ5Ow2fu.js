function _b(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function V2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var U2={exports:{}},Uh={},z2={exports:{}},et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uu=Symbol.for("react.element"),yb=Symbol.for("react.portal"),wb=Symbol.for("react.fragment"),Eb=Symbol.for("react.strict_mode"),Tb=Symbol.for("react.profiler"),kb=Symbol.for("react.provider"),Sb=Symbol.for("react.context"),Ab=Symbol.for("react.forward_ref"),Ib=Symbol.for("react.suspense"),bb=Symbol.for("react.memo"),Cb=Symbol.for("react.lazy"),L1=Symbol.iterator;function Nb(t){return t===null||typeof t!="object"?null:(t=L1&&t[L1]||t["@@iterator"],typeof t=="function"?t:null)}var W2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H2=Object.assign,$2={};function Ol(t,e,r){this.props=t,this.context=e,this.refs=$2,this.updater=r||W2}Ol.prototype.isReactComponent={};Ol.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ol.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function G2(){}G2.prototype=Ol.prototype;function Rg(t,e,r){this.props=t,this.context=e,this.refs=$2,this.updater=r||W2}var Fg=Rg.prototype=new G2;Fg.constructor=Rg;H2(Fg,Ol.prototype);Fg.isPureReactComponent=!0;var M1=Array.isArray,q2=Object.prototype.hasOwnProperty,Pg={current:null},K2={key:!0,ref:!0,__self:!0,__source:!0};function X2(t,e,r){var n,i={},a=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)q2.call(e,n)&&!K2.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Uu,type:t,key:a,ref:s,props:i,_owner:Pg.current}}function Rb(t,e){return{$$typeof:Uu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Dg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uu}function Fb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var j1=/\/+/g;function $d(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Fb(""+t.key):e.toString(36)}function d0(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Uu:case yb:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+$d(s,0):n,M1(i)?(r="",t!=null&&(r=t.replace(j1,"$&/")+"/"),d0(i,e,r,"",function(c){return c})):i!=null&&(Dg(i)&&(i=Rb(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(j1,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",M1(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+$d(a,o);s+=d0(a,e,r,l,i)}else if(l=Nb(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+$d(a,o++),s+=d0(a,e,r,l,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Ff(t,e,r){if(t==null)return t;var n=[],i=0;return d0(t,n,"","",function(a){return e.call(r,a,i++)}),n}function Pb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cn={current:null},p0={transition:null},Db={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:p0,ReactCurrentOwner:Pg};function Y2(){throw Error("act(...) is not supported in production builds of React.")}et.Children={map:Ff,forEach:function(t,e,r){Ff(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ff(t,function(){e++}),e},toArray:function(t){return Ff(t,function(e){return e})||[]},only:function(t){if(!Dg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};et.Component=Ol;et.Fragment=wb;et.Profiler=Tb;et.PureComponent=Rg;et.StrictMode=Eb;et.Suspense=Ib;et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Db;et.act=Y2;et.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=H2({},t.props),i=t.key,a=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=Pg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)q2.call(e,l)&&!K2.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Uu,type:t.type,key:i,ref:a,props:n,_owner:s}};et.createContext=function(t){return t={$$typeof:Sb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kb,_context:t},t.Consumer=t};et.createElement=X2;et.createFactory=function(t){var e=X2.bind(null,t);return e.type=t,e};et.createRef=function(){return{current:null}};et.forwardRef=function(t){return{$$typeof:Ab,render:t}};et.isValidElement=Dg;et.lazy=function(t){return{$$typeof:Cb,_payload:{_status:-1,_result:t},_init:Pb}};et.memo=function(t,e){return{$$typeof:bb,type:t,compare:e===void 0?null:e}};et.startTransition=function(t){var e=p0.transition;p0.transition={};try{t()}finally{p0.transition=e}};et.unstable_act=Y2;et.useCallback=function(t,e){return cn.current.useCallback(t,e)};et.useContext=function(t){return cn.current.useContext(t)};et.useDebugValue=function(){};et.useDeferredValue=function(t){return cn.current.useDeferredValue(t)};et.useEffect=function(t,e){return cn.current.useEffect(t,e)};et.useId=function(){return cn.current.useId()};et.useImperativeHandle=function(t,e,r){return cn.current.useImperativeHandle(t,e,r)};et.useInsertionEffect=function(t,e){return cn.current.useInsertionEffect(t,e)};et.useLayoutEffect=function(t,e){return cn.current.useLayoutEffect(t,e)};et.useMemo=function(t,e){return cn.current.useMemo(t,e)};et.useReducer=function(t,e,r){return cn.current.useReducer(t,e,r)};et.useRef=function(t){return cn.current.useRef(t)};et.useState=function(t){return cn.current.useState(t)};et.useSyncExternalStore=function(t,e,r){return cn.current.useSyncExternalStore(t,e,r)};et.useTransition=function(){return cn.current.useTransition()};et.version="18.3.1";z2.exports=et;var X=z2.exports;const zh=V2(X),Ob=_b({__proto__:null,default:zh},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lb=X,Mb=Symbol.for("react.element"),jb=Symbol.for("react.fragment"),Bb=Object.prototype.hasOwnProperty,Vb=Lb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ub={key:!0,ref:!0,__self:!0,__source:!0};function Q2(t,e,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)Bb.call(e,n)&&!Ub.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Mb,type:t,key:a,ref:s,props:i,_owner:Vb.current}}Uh.Fragment=jb;Uh.jsx=Q2;Uh.jsxs=Q2;U2.exports=Uh;var x=U2.exports,Gp={},J2={exports:{}},jn={},Z2={exports:{}},eE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(le,P){var Q=le.length;le.push(P);e:for(;0<Q;){var re=Q-1>>>1,O=le[re];if(0<i(O,P))le[re]=P,le[Q]=O,Q=re;else break e}}function r(le){return le.length===0?null:le[0]}function n(le){if(le.length===0)return null;var P=le[0],Q=le.pop();if(Q!==P){le[0]=Q;e:for(var re=0,O=le.length,q=O>>>1;re<q;){var H=2*(re+1)-1,G=le[H],K=H+1,ne=le[K];if(0>i(G,Q))K<O&&0>i(ne,G)?(le[re]=ne,le[K]=Q,re=K):(le[re]=G,le[H]=Q,re=H);else if(K<O&&0>i(ne,Q))le[re]=ne,le[K]=Q,re=K;else break e}}return P}function i(le,P){var Q=le.sortIndex-P.sortIndex;return Q!==0?Q:le.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,g=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(le){for(var P=r(c);P!==null;){if(P.callback===null)n(c);else if(P.startTime<=le)n(c),P.sortIndex=P.expirationTime,e(l,P);else break;P=r(c)}}function R(le){if(m=!1,w(le),!g)if(r(l)!==null)g=!0,Ae(j);else{var P=r(c);P!==null&&ve(R,P.startTime-le)}}function j(le,P){g=!1,m&&(m=!1,y(S),S=-1),p=!0;var Q=d;try{for(w(P),h=r(l);h!==null&&(!(h.expirationTime>P)||le&&!b());){var re=h.callback;if(typeof re=="function"){h.callback=null,d=h.priorityLevel;var O=re(h.expirationTime<=P);P=t.unstable_now(),typeof O=="function"?h.callback=O:h===r(l)&&n(l),w(P)}else n(l);h=r(l)}if(h!==null)var q=!0;else{var H=r(c);H!==null&&ve(R,H.startTime-P),q=!1}return q}finally{h=null,d=Q,p=!1}}var D=!1,E=null,S=-1,k=5,I=-1;function b(){return!(t.unstable_now()-I<k)}function N(){if(E!==null){var le=t.unstable_now();I=le;var P=!0;try{P=E(!0,le)}finally{P?F():(D=!1,E=null)}}else D=!1}var F;if(typeof T=="function")F=function(){T(N)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,de=he.port2;he.port1.onmessage=N,F=function(){de.postMessage(null)}}else F=function(){_(N,0)};function Ae(le){E=le,D||(D=!0,F())}function ve(le,P){S=_(function(){le(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(le){le.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,Ae(j))},t.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<le?Math.floor(1e3/le):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(le){switch(d){case 1:case 2:case 3:var P=3;break;default:P=d}var Q=d;d=P;try{return le()}finally{d=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(le,P){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var Q=d;d=le;try{return P()}finally{d=Q}},t.unstable_scheduleCallback=function(le,P,Q){var re=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?re+Q:re):Q=re,le){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Q+O,le={id:u++,callback:P,priorityLevel:le,startTime:Q,expirationTime:O,sortIndex:-1},Q>re?(le.sortIndex=Q,e(c,le),r(l)===null&&le===r(c)&&(m?(y(S),S=-1):m=!0,ve(R,Q-re))):(le.sortIndex=O,e(l,le),g||p||(g=!0,Ae(j))),le},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(le){var P=d;return function(){var Q=d;d=P;try{return le.apply(this,arguments)}finally{d=Q}}}})(eE);Z2.exports=eE;var zb=Z2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wb=X,Ln=zb;function xe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tE=new Set,Qc={};function uo(t,e){gl(t,e),gl(t+"Capture",e)}function gl(t,e){for(Qc[t]=e,t=0;t<e.length;t++)tE.add(e[t])}var aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qp=Object.prototype.hasOwnProperty,Hb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B1={},V1={};function $b(t){return qp.call(V1,t)?!0:qp.call(B1,t)?!1:Hb.test(t)?V1[t]=!0:(B1[t]=!0,!1)}function Gb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function qb(t,e,r,n){if(e===null||typeof e>"u"||Gb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,r,n,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var Dr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dr[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dr[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dr[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dr[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dr[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Dr[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Dr[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Dr[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Dr[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var Og=/[\-:]([a-z])/g;function Lg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Og,Lg);Dr[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Og,Lg);Dr[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Og,Lg);Dr[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Dr[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});Dr.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Dr[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function Mg(t,e,r,n){var i=Dr.hasOwnProperty(e)?Dr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qb(e,r,i,n)&&(r=null),n||i===null?$b(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var pa=Wb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pf=Symbol.for("react.element"),Bo=Symbol.for("react.portal"),Vo=Symbol.for("react.fragment"),jg=Symbol.for("react.strict_mode"),Kp=Symbol.for("react.profiler"),rE=Symbol.for("react.provider"),nE=Symbol.for("react.context"),Bg=Symbol.for("react.forward_ref"),Xp=Symbol.for("react.suspense"),Yp=Symbol.for("react.suspense_list"),Vg=Symbol.for("react.memo"),Ca=Symbol.for("react.lazy"),iE=Symbol.for("react.offscreen"),U1=Symbol.iterator;function nc(t){return t===null||typeof t!="object"?null:(t=U1&&t[U1]||t["@@iterator"],typeof t=="function"?t:null)}var Wt=Object.assign,Gd;function pc(t){if(Gd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Gd=e&&e[1]||""}return`
`+Gd+t}var qd=!1;function Kd(t,e){if(!t||qd)return"";qd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=o);break}}}finally{qd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?pc(t):""}function Kb(t){switch(t.tag){case 5:return pc(t.type);case 16:return pc("Lazy");case 13:return pc("Suspense");case 19:return pc("SuspenseList");case 0:case 2:case 15:return t=Kd(t.type,!1),t;case 11:return t=Kd(t.type.render,!1),t;case 1:return t=Kd(t.type,!0),t;default:return""}}function Qp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vo:return"Fragment";case Bo:return"Portal";case Kp:return"Profiler";case jg:return"StrictMode";case Xp:return"Suspense";case Yp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case nE:return(t.displayName||"Context")+".Consumer";case rE:return(t._context.displayName||"Context")+".Provider";case Bg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Vg:return e=t.displayName||null,e!==null?e:Qp(t.type)||"Memo";case Ca:e=t._payload,t=t._init;try{return Qp(t(e))}catch{}}return null}function Xb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qp(e);case 8:return e===jg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function is(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function aE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Yb(t){var e=aE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Df(t){t._valueTracker||(t._valueTracker=Yb(t))}function sE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=aE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function D0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Jp(t,e){var r=e.checked;return Wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function z1(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=is(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function oE(t,e){e=e.checked,e!=null&&Mg(t,"checked",e,!1)}function Zp(t,e){oE(t,e);var r=is(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?em(t,e.type,r):e.hasOwnProperty("defaultValue")&&em(t,e.type,is(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function W1(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function em(t,e,r){(e!=="number"||D0(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var mc=Array.isArray;function Zo(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+is(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function tm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xe(91));return Wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function H1(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(xe(92));if(mc(r)){if(1<r.length)throw Error(xe(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:is(r)}}function lE(t,e){var r=is(e.value),n=is(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function $1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Of,uE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Of=Of||document.createElement("div"),Of.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Of.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Jc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var bc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qb=["Webkit","ms","Moz","O"];Object.keys(bc).forEach(function(t){Qb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bc[e]=bc[t]})});function fE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||bc.hasOwnProperty(t)&&bc[t]?(""+e).trim():e+"px"}function hE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=fE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Jb=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nm(t,e){if(e){if(Jb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xe(62))}}function im(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var am=null;function Ug(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sm=null,el=null,tl=null;function G1(t){if(t=Hu(t)){if(typeof sm!="function")throw Error(xe(280));var e=t.stateNode;e&&(e=qh(e),sm(t.stateNode,t.type,e))}}function dE(t){el?tl?tl.push(t):tl=[t]:el=t}function pE(){if(el){var t=el,e=tl;if(tl=el=null,G1(t),e)for(t=0;t<e.length;t++)G1(e[t])}}function mE(t,e){return t(e)}function gE(){}var Xd=!1;function vE(t,e,r){if(Xd)return t(e,r);Xd=!0;try{return mE(t,e,r)}finally{Xd=!1,(el!==null||tl!==null)&&(gE(),pE())}}function Zc(t,e){var r=t.stateNode;if(r===null)return null;var n=qh(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(xe(231,e,typeof r));return r}var om=!1;if(aa)try{var ic={};Object.defineProperty(ic,"passive",{get:function(){om=!0}}),window.addEventListener("test",ic,ic),window.removeEventListener("test",ic,ic)}catch{om=!1}function Zb(t,e,r,n,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var Cc=!1,O0=null,L0=!1,lm=null,eC={onError:function(t){Cc=!0,O0=t}};function tC(t,e,r,n,i,a,s,o,l){Cc=!1,O0=null,Zb.apply(eC,arguments)}function rC(t,e,r,n,i,a,s,o,l){if(tC.apply(this,arguments),Cc){if(Cc){var c=O0;Cc=!1,O0=null}else throw Error(xe(198));L0||(L0=!0,lm=c)}}function fo(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function xE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function q1(t){if(fo(t)!==t)throw Error(xe(188))}function nC(t){var e=t.alternate;if(!e){if(e=fo(t),e===null)throw Error(xe(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return q1(i),t;if(a===n)return q1(i),e;a=a.sibling}throw Error(xe(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(xe(189))}}if(r.alternate!==n)throw Error(xe(190))}if(r.tag!==3)throw Error(xe(188));return r.stateNode.current===r?t:e}function _E(t){return t=nC(t),t!==null?yE(t):null}function yE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=yE(t);if(e!==null)return e;t=t.sibling}return null}var wE=Ln.unstable_scheduleCallback,K1=Ln.unstable_cancelCallback,iC=Ln.unstable_shouldYield,aC=Ln.unstable_requestPaint,Zt=Ln.unstable_now,sC=Ln.unstable_getCurrentPriorityLevel,zg=Ln.unstable_ImmediatePriority,EE=Ln.unstable_UserBlockingPriority,M0=Ln.unstable_NormalPriority,oC=Ln.unstable_LowPriority,TE=Ln.unstable_IdlePriority,Wh=null,bi=null;function lC(t){if(bi&&typeof bi.onCommitFiberRoot=="function")try{bi.onCommitFiberRoot(Wh,t,void 0,(t.current.flags&128)===128)}catch{}}var ci=Math.clz32?Math.clz32:fC,cC=Math.log,uC=Math.LN2;function fC(t){return t>>>=0,t===0?32:31-(cC(t)/uC|0)|0}var Lf=64,Mf=4194304;function gc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function j0(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,a=t.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=gc(o):(a&=s,a!==0&&(n=gc(a)))}else s=r&~i,s!==0?n=gc(s):a!==0&&(n=gc(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ci(e),i=1<<r,n|=t[r],e&=~i;return n}function hC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var s=31-ci(a),o=1<<s,l=i[s];l===-1?(!(o&r)||o&n)&&(i[s]=hC(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function cm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function kE(){var t=Lf;return Lf<<=1,!(Lf&4194240)&&(Lf=64),t}function Yd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function zu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ci(e),t[e]=r}function pC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ci(r),a=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~a}}function Wg(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ci(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var vt=0;function SE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var AE,Hg,IE,bE,CE,um=!1,jf=[],$a=null,Ga=null,qa=null,eu=new Map,tu=new Map,Ra=[],mC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function X1(t,e){switch(t){case"focusin":case"focusout":$a=null;break;case"dragenter":case"dragleave":Ga=null;break;case"mouseover":case"mouseout":qa=null;break;case"pointerover":case"pointerout":eu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":tu.delete(e.pointerId)}}function ac(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Hu(e),e!==null&&Hg(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function gC(t,e,r,n,i){switch(e){case"focusin":return $a=ac($a,t,e,r,n,i),!0;case"dragenter":return Ga=ac(Ga,t,e,r,n,i),!0;case"mouseover":return qa=ac(qa,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return eu.set(a,ac(eu.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,tu.set(a,ac(tu.get(a)||null,t,e,r,n,i)),!0}return!1}function NE(t){var e=Ds(t.target);if(e!==null){var r=fo(e);if(r!==null){if(e=r.tag,e===13){if(e=xE(r),e!==null){t.blockedOn=e,CE(t.priority,function(){IE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function m0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);am=n,r.target.dispatchEvent(n),am=null}else return e=Hu(r),e!==null&&Hg(e),t.blockedOn=r,!1;e.shift()}return!0}function Y1(t,e,r){m0(t)&&r.delete(e)}function vC(){um=!1,$a!==null&&m0($a)&&($a=null),Ga!==null&&m0(Ga)&&(Ga=null),qa!==null&&m0(qa)&&(qa=null),eu.forEach(Y1),tu.forEach(Y1)}function sc(t,e){t.blockedOn===e&&(t.blockedOn=null,um||(um=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,vC)))}function ru(t){function e(i){return sc(i,t)}if(0<jf.length){sc(jf[0],t);for(var r=1;r<jf.length;r++){var n=jf[r];n.blockedOn===t&&(n.blockedOn=null)}}for($a!==null&&sc($a,t),Ga!==null&&sc(Ga,t),qa!==null&&sc(qa,t),eu.forEach(e),tu.forEach(e),r=0;r<Ra.length;r++)n=Ra[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ra.length&&(r=Ra[0],r.blockedOn===null);)NE(r),r.blockedOn===null&&Ra.shift()}var rl=pa.ReactCurrentBatchConfig,B0=!0;function xC(t,e,r,n){var i=vt,a=rl.transition;rl.transition=null;try{vt=1,$g(t,e,r,n)}finally{vt=i,rl.transition=a}}function _C(t,e,r,n){var i=vt,a=rl.transition;rl.transition=null;try{vt=4,$g(t,e,r,n)}finally{vt=i,rl.transition=a}}function $g(t,e,r,n){if(B0){var i=fm(t,e,r,n);if(i===null)sp(t,e,n,V0,r),X1(t,n);else if(gC(i,t,e,r,n))n.stopPropagation();else if(X1(t,n),e&4&&-1<mC.indexOf(t)){for(;i!==null;){var a=Hu(i);if(a!==null&&AE(a),a=fm(t,e,r,n),a===null&&sp(t,e,n,V0,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else sp(t,e,n,null,r)}}var V0=null;function fm(t,e,r,n){if(V0=null,t=Ug(n),t=Ds(t),t!==null)if(e=fo(t),e===null)t=null;else if(r=e.tag,r===13){if(t=xE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return V0=t,null}function RE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sC()){case zg:return 1;case EE:return 4;case M0:case oC:return 16;case TE:return 536870912;default:return 16}default:return 16}}var ja=null,Gg=null,g0=null;function FE(){if(g0)return g0;var t,e=Gg,r=e.length,n,i="value"in ja?ja.value:ja.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[a-n];n++);return g0=i.slice(t,1<n?1-n:void 0)}function v0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Bf(){return!0}function Q1(){return!1}function Bn(t){function e(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Bf:Q1,this.isPropagationStopped=Q1,this}return Wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Bf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Bf)},persist:function(){},isPersistent:Bf}),e}var Ll={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qg=Bn(Ll),Wu=Wt({},Ll,{view:0,detail:0}),yC=Bn(Wu),Qd,Jd,oc,Hh=Wt({},Wu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==oc&&(oc&&t.type==="mousemove"?(Qd=t.screenX-oc.screenX,Jd=t.screenY-oc.screenY):Jd=Qd=0,oc=t),Qd)},movementY:function(t){return"movementY"in t?t.movementY:Jd}}),J1=Bn(Hh),wC=Wt({},Hh,{dataTransfer:0}),EC=Bn(wC),TC=Wt({},Wu,{relatedTarget:0}),Zd=Bn(TC),kC=Wt({},Ll,{animationName:0,elapsedTime:0,pseudoElement:0}),SC=Bn(kC),AC=Wt({},Ll,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),IC=Bn(AC),bC=Wt({},Ll,{data:0}),Z1=Bn(bC),CC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=RC[t])?!!e[t]:!1}function Kg(){return FC}var PC=Wt({},Wu,{key:function(t){if(t.key){var e=CC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=v0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?NC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kg,charCode:function(t){return t.type==="keypress"?v0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?v0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),DC=Bn(PC),OC=Wt({},Hh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e_=Bn(OC),LC=Wt({},Wu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kg}),MC=Bn(LC),jC=Wt({},Ll,{propertyName:0,elapsedTime:0,pseudoElement:0}),BC=Bn(jC),VC=Wt({},Hh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),UC=Bn(VC),zC=[9,13,27,32],Xg=aa&&"CompositionEvent"in window,Nc=null;aa&&"documentMode"in document&&(Nc=document.documentMode);var WC=aa&&"TextEvent"in window&&!Nc,PE=aa&&(!Xg||Nc&&8<Nc&&11>=Nc),t_=" ",r_=!1;function DE(t,e){switch(t){case"keyup":return zC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function OE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Uo=!1;function HC(t,e){switch(t){case"compositionend":return OE(e);case"keypress":return e.which!==32?null:(r_=!0,t_);case"textInput":return t=e.data,t===t_&&r_?null:t;default:return null}}function $C(t,e){if(Uo)return t==="compositionend"||!Xg&&DE(t,e)?(t=FE(),g0=Gg=ja=null,Uo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PE&&e.locale!=="ko"?null:e.data;default:return null}}var GC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!GC[t.type]:e==="textarea"}function LE(t,e,r,n){dE(n),e=U0(e,"onChange"),0<e.length&&(r=new qg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Rc=null,nu=null;function qC(t){qE(t,0)}function $h(t){var e=Ho(t);if(sE(e))return t}function KC(t,e){if(t==="change")return e}var ME=!1;if(aa){var ep;if(aa){var tp="oninput"in document;if(!tp){var i_=document.createElement("div");i_.setAttribute("oninput","return;"),tp=typeof i_.oninput=="function"}ep=tp}else ep=!1;ME=ep&&(!document.documentMode||9<document.documentMode)}function a_(){Rc&&(Rc.detachEvent("onpropertychange",jE),nu=Rc=null)}function jE(t){if(t.propertyName==="value"&&$h(nu)){var e=[];LE(e,nu,t,Ug(t)),vE(qC,e)}}function XC(t,e,r){t==="focusin"?(a_(),Rc=e,nu=r,Rc.attachEvent("onpropertychange",jE)):t==="focusout"&&a_()}function YC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $h(nu)}function QC(t,e){if(t==="click")return $h(e)}function JC(t,e){if(t==="input"||t==="change")return $h(e)}function ZC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var di=typeof Object.is=="function"?Object.is:ZC;function iu(t,e){if(di(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!qp.call(e,i)||!di(t[i],e[i]))return!1}return!0}function s_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function o_(t,e){var r=s_(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=s_(r)}}function BE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?BE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function VE(){for(var t=window,e=D0();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=D0(t.document)}return e}function Yg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function eN(t){var e=VE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&BE(r.ownerDocument.documentElement,r)){if(n!==null&&Yg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!t.extend&&a>n&&(i=n,n=a,a=i),i=o_(r,a);var s=o_(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var tN=aa&&"documentMode"in document&&11>=document.documentMode,zo=null,hm=null,Fc=null,dm=!1;function l_(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;dm||zo==null||zo!==D0(n)||(n=zo,"selectionStart"in n&&Yg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fc&&iu(Fc,n)||(Fc=n,n=U0(hm,"onSelect"),0<n.length&&(e=new qg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=zo)))}function Vf(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Wo={animationend:Vf("Animation","AnimationEnd"),animationiteration:Vf("Animation","AnimationIteration"),animationstart:Vf("Animation","AnimationStart"),transitionend:Vf("Transition","TransitionEnd")},rp={},UE={};aa&&(UE=document.createElement("div").style,"AnimationEvent"in window||(delete Wo.animationend.animation,delete Wo.animationiteration.animation,delete Wo.animationstart.animation),"TransitionEvent"in window||delete Wo.transitionend.transition);function Gh(t){if(rp[t])return rp[t];if(!Wo[t])return t;var e=Wo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in UE)return rp[t]=e[r];return t}var zE=Gh("animationend"),WE=Gh("animationiteration"),HE=Gh("animationstart"),$E=Gh("transitionend"),GE=new Map,c_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ds(t,e){GE.set(t,e),uo(e,[t])}for(var np=0;np<c_.length;np++){var ip=c_[np],rN=ip.toLowerCase(),nN=ip[0].toUpperCase()+ip.slice(1);ds(rN,"on"+nN)}ds(zE,"onAnimationEnd");ds(WE,"onAnimationIteration");ds(HE,"onAnimationStart");ds("dblclick","onDoubleClick");ds("focusin","onFocus");ds("focusout","onBlur");ds($E,"onTransitionEnd");gl("onMouseEnter",["mouseout","mouseover"]);gl("onMouseLeave",["mouseout","mouseover"]);gl("onPointerEnter",["pointerout","pointerover"]);gl("onPointerLeave",["pointerout","pointerover"]);uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iN=new Set("cancel close invalid load scroll toggle".split(" ").concat(vc));function u_(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,rC(n,e,void 0,t),t.currentTarget=null}function qE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;u_(i,o,c),a=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;u_(i,o,c),a=l}}}if(L0)throw t=lm,L0=!1,lm=null,t}function Ct(t,e){var r=e[xm];r===void 0&&(r=e[xm]=new Set);var n=t+"__bubble";r.has(n)||(KE(e,t,2,!1),r.add(n))}function ap(t,e,r){var n=0;e&&(n|=4),KE(r,t,n,e)}var Uf="_reactListening"+Math.random().toString(36).slice(2);function au(t){if(!t[Uf]){t[Uf]=!0,tE.forEach(function(r){r!=="selectionchange"&&(iN.has(r)||ap(r,!1,t),ap(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Uf]||(e[Uf]=!0,ap("selectionchange",!1,e))}}function KE(t,e,r,n){switch(RE(e)){case 1:var i=xC;break;case 4:i=_C;break;default:i=$g}r=i.bind(null,e,r,t),i=void 0,!om||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function sp(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=Ds(o),s===null)return;if(l=s.tag,l===5||l===6){n=a=s;continue e}o=o.parentNode}}n=n.return}vE(function(){var c=a,u=Ug(r),h=[];e:{var d=GE.get(t);if(d!==void 0){var p=qg,g=t;switch(t){case"keypress":if(v0(r)===0)break e;case"keydown":case"keyup":p=DC;break;case"focusin":g="focus",p=Zd;break;case"focusout":g="blur",p=Zd;break;case"beforeblur":case"afterblur":p=Zd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=J1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=EC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=MC;break;case zE:case WE:case HE:p=SC;break;case $E:p=BC;break;case"scroll":p=yC;break;case"wheel":p=UC;break;case"copy":case"cut":case"paste":p=IC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=e_}var m=(e&4)!==0,_=!m&&t==="scroll",y=m?d!==null?d+"Capture":null:d;m=[];for(var T=c,w;T!==null;){w=T;var R=w.stateNode;if(w.tag===5&&R!==null&&(w=R,y!==null&&(R=Zc(T,y),R!=null&&m.push(su(T,R,w)))),_)break;T=T.return}0<m.length&&(d=new p(d,g,null,r,u),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&r!==am&&(g=r.relatedTarget||r.fromElement)&&(Ds(g)||g[sa]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?Ds(g):null,g!==null&&(_=fo(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(m=J1,R="onMouseLeave",y="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(m=e_,R="onPointerLeave",y="onPointerEnter",T="pointer"),_=p==null?d:Ho(p),w=g==null?d:Ho(g),d=new m(R,T+"leave",p,r,u),d.target=_,d.relatedTarget=w,R=null,Ds(u)===c&&(m=new m(y,T+"enter",g,r,u),m.target=w,m.relatedTarget=_,R=m),_=R,p&&g)t:{for(m=p,y=g,T=0,w=m;w;w=Ro(w))T++;for(w=0,R=y;R;R=Ro(R))w++;for(;0<T-w;)m=Ro(m),T--;for(;0<w-T;)y=Ro(y),w--;for(;T--;){if(m===y||y!==null&&m===y.alternate)break t;m=Ro(m),y=Ro(y)}m=null}else m=null;p!==null&&f_(h,d,p,m,!1),g!==null&&_!==null&&f_(h,_,g,m,!0)}}e:{if(d=c?Ho(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var j=KC;else if(n_(d))if(ME)j=JC;else{j=YC;var D=XC}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(j=QC);if(j&&(j=j(t,c))){LE(h,j,r,u);break e}D&&D(t,d,c),t==="focusout"&&(D=d._wrapperState)&&D.controlled&&d.type==="number"&&em(d,"number",d.value)}switch(D=c?Ho(c):window,t){case"focusin":(n_(D)||D.contentEditable==="true")&&(zo=D,hm=c,Fc=null);break;case"focusout":Fc=hm=zo=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,l_(h,r,u);break;case"selectionchange":if(tN)break;case"keydown":case"keyup":l_(h,r,u)}var E;if(Xg)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Uo?DE(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(PE&&r.locale!=="ko"&&(Uo||S!=="onCompositionStart"?S==="onCompositionEnd"&&Uo&&(E=FE()):(ja=u,Gg="value"in ja?ja.value:ja.textContent,Uo=!0)),D=U0(c,S),0<D.length&&(S=new Z1(S,t,null,r,u),h.push({event:S,listeners:D}),E?S.data=E:(E=OE(r),E!==null&&(S.data=E)))),(E=WC?HC(t,r):$C(t,r))&&(c=U0(c,"onBeforeInput"),0<c.length&&(u=new Z1("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=E))}qE(h,e)})}function su(t,e,r){return{instance:t,listener:e,currentTarget:r}}function U0(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Zc(t,r),a!=null&&n.unshift(su(t,a,i)),a=Zc(t,e),a!=null&&n.push(su(t,a,i))),t=t.return}return n}function Ro(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function f_(t,e,r,n,i){for(var a=e._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Zc(r,a),l!=null&&s.unshift(su(r,l,o))):i||(l=Zc(r,a),l!=null&&s.push(su(r,l,o)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var aN=/\r\n?/g,sN=/\u0000|\uFFFD/g;function h_(t){return(typeof t=="string"?t:""+t).replace(aN,`
`).replace(sN,"")}function zf(t,e,r){if(e=h_(e),h_(t)!==e&&r)throw Error(xe(425))}function z0(){}var pm=null,mm=null;function gm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vm=typeof setTimeout=="function"?setTimeout:void 0,oN=typeof clearTimeout=="function"?clearTimeout:void 0,d_=typeof Promise=="function"?Promise:void 0,lN=typeof queueMicrotask=="function"?queueMicrotask:typeof d_<"u"?function(t){return d_.resolve(null).then(t).catch(cN)}:vm;function cN(t){setTimeout(function(){throw t})}function op(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),ru(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ru(e)}function Ka(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function p_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ml=Math.random().toString(36).slice(2),Si="__reactFiber$"+Ml,ou="__reactProps$"+Ml,sa="__reactContainer$"+Ml,xm="__reactEvents$"+Ml,uN="__reactListeners$"+Ml,fN="__reactHandles$"+Ml;function Ds(t){var e=t[Si];if(e)return e;for(var r=t.parentNode;r;){if(e=r[sa]||r[Si]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=p_(t);t!==null;){if(r=t[Si])return r;t=p_(t)}return e}t=r,r=t.parentNode}return null}function Hu(t){return t=t[Si]||t[sa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ho(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(xe(33))}function qh(t){return t[ou]||null}var _m=[],$o=-1;function ps(t){return{current:t}}function Ft(t){0>$o||(t.current=_m[$o],_m[$o]=null,$o--)}function It(t,e){$o++,_m[$o]=t.current,t.current=e}var as={},Qr=ps(as),xn=ps(!1),qs=as;function vl(t,e){var r=t.type.contextTypes;if(!r)return as;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function _n(t){return t=t.childContextTypes,t!=null}function W0(){Ft(xn),Ft(Qr)}function m_(t,e,r){if(Qr.current!==as)throw Error(xe(168));It(Qr,e),It(xn,r)}function XE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(xe(108,Xb(t)||"Unknown",i));return Wt({},r,n)}function H0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||as,qs=Qr.current,It(Qr,t),It(xn,xn.current),!0}function g_(t,e,r){var n=t.stateNode;if(!n)throw Error(xe(169));r?(t=XE(t,e,qs),n.__reactInternalMemoizedMergedChildContext=t,Ft(xn),Ft(Qr),It(Qr,t)):Ft(xn),It(xn,r)}var Gi=null,Kh=!1,lp=!1;function YE(t){Gi===null?Gi=[t]:Gi.push(t)}function hN(t){Kh=!0,YE(t)}function ms(){if(!lp&&Gi!==null){lp=!0;var t=0,e=vt;try{var r=Gi;for(vt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Gi=null,Kh=!1}catch(i){throw Gi!==null&&(Gi=Gi.slice(t+1)),wE(zg,ms),i}finally{vt=e,lp=!1}}return null}var Go=[],qo=0,$0=null,G0=0,Gn=[],qn=0,Ks=null,qi=1,Ki="";function Cs(t,e){Go[qo++]=G0,Go[qo++]=$0,$0=t,G0=e}function QE(t,e,r){Gn[qn++]=qi,Gn[qn++]=Ki,Gn[qn++]=Ks,Ks=t;var n=qi;t=Ki;var i=32-ci(n)-1;n&=~(1<<i),r+=1;var a=32-ci(e)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,qi=1<<32-ci(e)+i|r<<i|n,Ki=a+t}else qi=1<<a|r<<i|n,Ki=t}function Qg(t){t.return!==null&&(Cs(t,1),QE(t,1,0))}function Jg(t){for(;t===$0;)$0=Go[--qo],Go[qo]=null,G0=Go[--qo],Go[qo]=null;for(;t===Ks;)Ks=Gn[--qn],Gn[qn]=null,Ki=Gn[--qn],Gn[qn]=null,qi=Gn[--qn],Gn[qn]=null}var On=null,Pn=null,Mt=!1,si=null;function JE(t,e){var r=Kn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function v_(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,On=t,Pn=Ka(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,On=t,Pn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ks!==null?{id:qi,overflow:Ki}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Kn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,On=t,Pn=null,!0):!1;default:return!1}}function ym(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wm(t){if(Mt){var e=Pn;if(e){var r=e;if(!v_(t,e)){if(ym(t))throw Error(xe(418));e=Ka(r.nextSibling);var n=On;e&&v_(t,e)?JE(n,r):(t.flags=t.flags&-4097|2,Mt=!1,On=t)}}else{if(ym(t))throw Error(xe(418));t.flags=t.flags&-4097|2,Mt=!1,On=t}}}function x_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;On=t}function Wf(t){if(t!==On)return!1;if(!Mt)return x_(t),Mt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!gm(t.type,t.memoizedProps)),e&&(e=Pn)){if(ym(t))throw ZE(),Error(xe(418));for(;e;)JE(t,e),e=Ka(e.nextSibling)}if(x_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(xe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Pn=Ka(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Pn=null}}else Pn=On?Ka(t.stateNode.nextSibling):null;return!0}function ZE(){for(var t=Pn;t;)t=Ka(t.nextSibling)}function xl(){Pn=On=null,Mt=!1}function Zg(t){si===null?si=[t]:si.push(t)}var dN=pa.ReactCurrentBatchConfig;function lc(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(xe(309));var n=r.stateNode}if(!n)throw Error(xe(147,t));var i=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},e._stringRef=a,e)}if(typeof t!="string")throw Error(xe(284));if(!r._owner)throw Error(xe(290,t))}return t}function Hf(t,e){throw t=Object.prototype.toString.call(e),Error(xe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function __(t){var e=t._init;return e(t._payload)}function eT(t){function e(y,T){if(t){var w=y.deletions;w===null?(y.deletions=[T],y.flags|=16):w.push(T)}}function r(y,T){if(!t)return null;for(;T!==null;)e(y,T),T=T.sibling;return null}function n(y,T){for(y=new Map;T!==null;)T.key!==null?y.set(T.key,T):y.set(T.index,T),T=T.sibling;return y}function i(y,T){return y=Ja(y,T),y.index=0,y.sibling=null,y}function a(y,T,w){return y.index=w,t?(w=y.alternate,w!==null?(w=w.index,w<T?(y.flags|=2,T):w):(y.flags|=2,T)):(y.flags|=1048576,T)}function s(y){return t&&y.alternate===null&&(y.flags|=2),y}function o(y,T,w,R){return T===null||T.tag!==6?(T=mp(w,y.mode,R),T.return=y,T):(T=i(T,w),T.return=y,T)}function l(y,T,w,R){var j=w.type;return j===Vo?u(y,T,w.props.children,R,w.key):T!==null&&(T.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ca&&__(j)===T.type)?(R=i(T,w.props),R.ref=lc(y,T,w),R.return=y,R):(R=k0(w.type,w.key,w.props,null,y.mode,R),R.ref=lc(y,T,w),R.return=y,R)}function c(y,T,w,R){return T===null||T.tag!==4||T.stateNode.containerInfo!==w.containerInfo||T.stateNode.implementation!==w.implementation?(T=gp(w,y.mode,R),T.return=y,T):(T=i(T,w.children||[]),T.return=y,T)}function u(y,T,w,R,j){return T===null||T.tag!==7?(T=Us(w,y.mode,R,j),T.return=y,T):(T=i(T,w),T.return=y,T)}function h(y,T,w){if(typeof T=="string"&&T!==""||typeof T=="number")return T=mp(""+T,y.mode,w),T.return=y,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Pf:return w=k0(T.type,T.key,T.props,null,y.mode,w),w.ref=lc(y,null,T),w.return=y,w;case Bo:return T=gp(T,y.mode,w),T.return=y,T;case Ca:var R=T._init;return h(y,R(T._payload),w)}if(mc(T)||nc(T))return T=Us(T,y.mode,w,null),T.return=y,T;Hf(y,T)}return null}function d(y,T,w,R){var j=T!==null?T.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:o(y,T,""+w,R);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Pf:return w.key===j?l(y,T,w,R):null;case Bo:return w.key===j?c(y,T,w,R):null;case Ca:return j=w._init,d(y,T,j(w._payload),R)}if(mc(w)||nc(w))return j!==null?null:u(y,T,w,R,null);Hf(y,w)}return null}function p(y,T,w,R,j){if(typeof R=="string"&&R!==""||typeof R=="number")return y=y.get(w)||null,o(T,y,""+R,j);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Pf:return y=y.get(R.key===null?w:R.key)||null,l(T,y,R,j);case Bo:return y=y.get(R.key===null?w:R.key)||null,c(T,y,R,j);case Ca:var D=R._init;return p(y,T,w,D(R._payload),j)}if(mc(R)||nc(R))return y=y.get(w)||null,u(T,y,R,j,null);Hf(T,R)}return null}function g(y,T,w,R){for(var j=null,D=null,E=T,S=T=0,k=null;E!==null&&S<w.length;S++){E.index>S?(k=E,E=null):k=E.sibling;var I=d(y,E,w[S],R);if(I===null){E===null&&(E=k);break}t&&E&&I.alternate===null&&e(y,E),T=a(I,T,S),D===null?j=I:D.sibling=I,D=I,E=k}if(S===w.length)return r(y,E),Mt&&Cs(y,S),j;if(E===null){for(;S<w.length;S++)E=h(y,w[S],R),E!==null&&(T=a(E,T,S),D===null?j=E:D.sibling=E,D=E);return Mt&&Cs(y,S),j}for(E=n(y,E);S<w.length;S++)k=p(E,y,S,w[S],R),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?S:k.key),T=a(k,T,S),D===null?j=k:D.sibling=k,D=k);return t&&E.forEach(function(b){return e(y,b)}),Mt&&Cs(y,S),j}function m(y,T,w,R){var j=nc(w);if(typeof j!="function")throw Error(xe(150));if(w=j.call(w),w==null)throw Error(xe(151));for(var D=j=null,E=T,S=T=0,k=null,I=w.next();E!==null&&!I.done;S++,I=w.next()){E.index>S?(k=E,E=null):k=E.sibling;var b=d(y,E,I.value,R);if(b===null){E===null&&(E=k);break}t&&E&&b.alternate===null&&e(y,E),T=a(b,T,S),D===null?j=b:D.sibling=b,D=b,E=k}if(I.done)return r(y,E),Mt&&Cs(y,S),j;if(E===null){for(;!I.done;S++,I=w.next())I=h(y,I.value,R),I!==null&&(T=a(I,T,S),D===null?j=I:D.sibling=I,D=I);return Mt&&Cs(y,S),j}for(E=n(y,E);!I.done;S++,I=w.next())I=p(E,y,S,I.value,R),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?S:I.key),T=a(I,T,S),D===null?j=I:D.sibling=I,D=I);return t&&E.forEach(function(N){return e(y,N)}),Mt&&Cs(y,S),j}function _(y,T,w,R){if(typeof w=="object"&&w!==null&&w.type===Vo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Pf:e:{for(var j=w.key,D=T;D!==null;){if(D.key===j){if(j=w.type,j===Vo){if(D.tag===7){r(y,D.sibling),T=i(D,w.props.children),T.return=y,y=T;break e}}else if(D.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Ca&&__(j)===D.type){r(y,D.sibling),T=i(D,w.props),T.ref=lc(y,D,w),T.return=y,y=T;break e}r(y,D);break}else e(y,D);D=D.sibling}w.type===Vo?(T=Us(w.props.children,y.mode,R,w.key),T.return=y,y=T):(R=k0(w.type,w.key,w.props,null,y.mode,R),R.ref=lc(y,T,w),R.return=y,y=R)}return s(y);case Bo:e:{for(D=w.key;T!==null;){if(T.key===D)if(T.tag===4&&T.stateNode.containerInfo===w.containerInfo&&T.stateNode.implementation===w.implementation){r(y,T.sibling),T=i(T,w.children||[]),T.return=y,y=T;break e}else{r(y,T);break}else e(y,T);T=T.sibling}T=gp(w,y.mode,R),T.return=y,y=T}return s(y);case Ca:return D=w._init,_(y,T,D(w._payload),R)}if(mc(w))return g(y,T,w,R);if(nc(w))return m(y,T,w,R);Hf(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,T!==null&&T.tag===6?(r(y,T.sibling),T=i(T,w),T.return=y,y=T):(r(y,T),T=mp(w,y.mode,R),T.return=y,y=T),s(y)):r(y,T)}return _}var _l=eT(!0),tT=eT(!1),q0=ps(null),K0=null,Ko=null,ev=null;function tv(){ev=Ko=K0=null}function rv(t){var e=q0.current;Ft(q0),t._currentValue=e}function Em(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function nl(t,e){K0=t,ev=Ko=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vn=!0),t.firstContext=null)}function Qn(t){var e=t._currentValue;if(ev!==t)if(t={context:t,memoizedValue:e,next:null},Ko===null){if(K0===null)throw Error(xe(308));Ko=t,K0.dependencies={lanes:0,firstContext:t}}else Ko=Ko.next=t;return e}var Os=null;function nv(t){Os===null?Os=[t]:Os.push(t)}function rT(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,nv(e)):(r.next=i.next,i.next=r),e.interleaved=r,oa(t,n)}function oa(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Na=!1;function iv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xa(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,st&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,oa(t,r)}return i=n.interleaved,i===null?(e.next=e,nv(n)):(e.next=i.next,i.next=e),n.interleaved=e,oa(t,r)}function x0(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Wg(t,r)}}function y_(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function X0(t,e,r,n){var i=t.updateQueue;Na=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?a=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var h=i.baseState;s=0,u=c=l=null,o=a;do{var d=o.lane,p=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,m=o;switch(d=e,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(p,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,d=typeof g=="function"?g.call(p,h,d):g,d==null)break e;h=Wt({},h,d);break e;case 2:Na=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,s|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Ys|=s,t.lanes=s,t.memoizedState=h}}function w_(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(xe(191,i));i.call(n)}}}var $u={},Ci=ps($u),lu=ps($u),cu=ps($u);function Ls(t){if(t===$u)throw Error(xe(174));return t}function av(t,e){switch(It(cu,e),It(lu,t),It(Ci,$u),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rm(e,t)}Ft(Ci),It(Ci,e)}function yl(){Ft(Ci),Ft(lu),Ft(cu)}function iT(t){Ls(cu.current);var e=Ls(Ci.current),r=rm(e,t.type);e!==r&&(It(lu,t),It(Ci,r))}function sv(t){lu.current===t&&(Ft(Ci),Ft(lu))}var Bt=ps(0);function Y0(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cp=[];function ov(){for(var t=0;t<cp.length;t++)cp[t]._workInProgressVersionPrimary=null;cp.length=0}var _0=pa.ReactCurrentDispatcher,up=pa.ReactCurrentBatchConfig,Xs=0,zt=null,hr=null,_r=null,Q0=!1,Pc=!1,uu=0,pN=0;function jr(){throw Error(xe(321))}function lv(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!di(t[r],e[r]))return!1;return!0}function cv(t,e,r,n,i,a){if(Xs=a,zt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_0.current=t===null||t.memoizedState===null?xN:_N,t=r(n,i),Pc){a=0;do{if(Pc=!1,uu=0,25<=a)throw Error(xe(301));a+=1,_r=hr=null,e.updateQueue=null,_0.current=yN,t=r(n,i)}while(Pc)}if(_0.current=J0,e=hr!==null&&hr.next!==null,Xs=0,_r=hr=zt=null,Q0=!1,e)throw Error(xe(300));return t}function uv(){var t=uu!==0;return uu=0,t}function ki(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _r===null?zt.memoizedState=_r=t:_r=_r.next=t,_r}function Jn(){if(hr===null){var t=zt.alternate;t=t!==null?t.memoizedState:null}else t=hr.next;var e=_r===null?zt.memoizedState:_r.next;if(e!==null)_r=e,hr=t;else{if(t===null)throw Error(xe(310));hr=t,t={memoizedState:hr.memoizedState,baseState:hr.baseState,baseQueue:hr.baseQueue,queue:hr.queue,next:null},_r===null?zt.memoizedState=_r=t:_r=_r.next=t}return _r}function fu(t,e){return typeof e=="function"?e(t):e}function fp(t){var e=Jn(),r=e.queue;if(r===null)throw Error(xe(311));r.lastRenderedReducer=t;var n=hr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,l=null,c=a;do{var u=c.lane;if((Xs&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,s=n):l=l.next=h,zt.lanes|=u,Ys|=u}c=c.next}while(c!==null&&c!==a);l===null?s=n:l.next=o,di(n,e.memoizedState)||(vn=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do a=i.lane,zt.lanes|=a,Ys|=a,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function hp(t){var e=Jn(),r=e.queue;if(r===null)throw Error(xe(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=t(a,s.action),s=s.next;while(s!==i);di(a,e.memoizedState)||(vn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function aT(){}function sT(t,e){var r=zt,n=Jn(),i=e(),a=!di(n.memoizedState,i);if(a&&(n.memoizedState=i,vn=!0),n=n.queue,fv(cT.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||_r!==null&&_r.memoizedState.tag&1){if(r.flags|=2048,hu(9,lT.bind(null,r,n,i,e),void 0,null),Er===null)throw Error(xe(349));Xs&30||oT(r,e,i)}return i}function oT(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=zt.updateQueue,e===null?(e={lastEffect:null,stores:null},zt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function lT(t,e,r,n){e.value=r,e.getSnapshot=n,uT(e)&&fT(t)}function cT(t,e,r){return r(function(){uT(e)&&fT(t)})}function uT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!di(t,r)}catch{return!0}}function fT(t){var e=oa(t,1);e!==null&&ui(e,t,1,-1)}function E_(t){var e=ki();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fu,lastRenderedState:t},e.queue=t,t=t.dispatch=vN.bind(null,zt,t),[e.memoizedState,t]}function hu(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=zt.updateQueue,e===null?(e={lastEffect:null,stores:null},zt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function hT(){return Jn().memoizedState}function y0(t,e,r,n){var i=ki();zt.flags|=t,i.memoizedState=hu(1|e,r,void 0,n===void 0?null:n)}function Xh(t,e,r,n){var i=Jn();n=n===void 0?null:n;var a=void 0;if(hr!==null){var s=hr.memoizedState;if(a=s.destroy,n!==null&&lv(n,s.deps)){i.memoizedState=hu(e,r,a,n);return}}zt.flags|=t,i.memoizedState=hu(1|e,r,a,n)}function T_(t,e){return y0(8390656,8,t,e)}function fv(t,e){return Xh(2048,8,t,e)}function dT(t,e){return Xh(4,2,t,e)}function pT(t,e){return Xh(4,4,t,e)}function mT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function gT(t,e,r){return r=r!=null?r.concat([t]):null,Xh(4,4,mT.bind(null,e,t),r)}function hv(){}function vT(t,e){var r=Jn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&lv(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function xT(t,e){var r=Jn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&lv(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function _T(t,e,r){return Xs&21?(di(r,e)||(r=kE(),zt.lanes|=r,Ys|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vn=!0),t.memoizedState=r)}function mN(t,e){var r=vt;vt=r!==0&&4>r?r:4,t(!0);var n=up.transition;up.transition={};try{t(!1),e()}finally{vt=r,up.transition=n}}function yT(){return Jn().memoizedState}function gN(t,e,r){var n=Qa(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},wT(t))ET(e,r);else if(r=rT(t,e,r,n),r!==null){var i=on();ui(r,t,n,i),TT(r,e,n)}}function vN(t,e,r){var n=Qa(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(wT(t))ET(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,di(o,s)){var l=e.interleaved;l===null?(i.next=i,nv(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=rT(t,e,i,n),r!==null&&(i=on(),ui(r,t,n,i),TT(r,e,n))}}function wT(t){var e=t.alternate;return t===zt||e!==null&&e===zt}function ET(t,e){Pc=Q0=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function TT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Wg(t,r)}}var J0={readContext:Qn,useCallback:jr,useContext:jr,useEffect:jr,useImperativeHandle:jr,useInsertionEffect:jr,useLayoutEffect:jr,useMemo:jr,useReducer:jr,useRef:jr,useState:jr,useDebugValue:jr,useDeferredValue:jr,useTransition:jr,useMutableSource:jr,useSyncExternalStore:jr,useId:jr,unstable_isNewReconciler:!1},xN={readContext:Qn,useCallback:function(t,e){return ki().memoizedState=[t,e===void 0?null:e],t},useContext:Qn,useEffect:T_,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,y0(4194308,4,mT.bind(null,e,t),r)},useLayoutEffect:function(t,e){return y0(4194308,4,t,e)},useInsertionEffect:function(t,e){return y0(4,2,t,e)},useMemo:function(t,e){var r=ki();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=ki();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=gN.bind(null,zt,t),[n.memoizedState,t]},useRef:function(t){var e=ki();return t={current:t},e.memoizedState=t},useState:E_,useDebugValue:hv,useDeferredValue:function(t){return ki().memoizedState=t},useTransition:function(){var t=E_(!1),e=t[0];return t=mN.bind(null,t[1]),ki().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=zt,i=ki();if(Mt){if(r===void 0)throw Error(xe(407));r=r()}else{if(r=e(),Er===null)throw Error(xe(349));Xs&30||oT(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,T_(cT.bind(null,n,a,t),[t]),n.flags|=2048,hu(9,lT.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=ki(),e=Er.identifierPrefix;if(Mt){var r=Ki,n=qi;r=(n&~(1<<32-ci(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=uu++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=pN++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},_N={readContext:Qn,useCallback:vT,useContext:Qn,useEffect:fv,useImperativeHandle:gT,useInsertionEffect:dT,useLayoutEffect:pT,useMemo:xT,useReducer:fp,useRef:hT,useState:function(){return fp(fu)},useDebugValue:hv,useDeferredValue:function(t){var e=Jn();return _T(e,hr.memoizedState,t)},useTransition:function(){var t=fp(fu)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:aT,useSyncExternalStore:sT,useId:yT,unstable_isNewReconciler:!1},yN={readContext:Qn,useCallback:vT,useContext:Qn,useEffect:fv,useImperativeHandle:gT,useInsertionEffect:dT,useLayoutEffect:pT,useMemo:xT,useReducer:hp,useRef:hT,useState:function(){return hp(fu)},useDebugValue:hv,useDeferredValue:function(t){var e=Jn();return hr===null?e.memoizedState=t:_T(e,hr.memoizedState,t)},useTransition:function(){var t=hp(fu)[0],e=Jn().memoizedState;return[t,e]},useMutableSource:aT,useSyncExternalStore:sT,useId:yT,unstable_isNewReconciler:!1};function ii(t,e){if(t&&t.defaultProps){e=Wt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Tm(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Wt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Yh={isMounted:function(t){return(t=t._reactInternals)?fo(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=on(),i=Qa(t),a=Zi(n,i);a.payload=e,r!=null&&(a.callback=r),e=Xa(t,a,i),e!==null&&(ui(e,t,i,n),x0(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=on(),i=Qa(t),a=Zi(n,i);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Xa(t,a,i),e!==null&&(ui(e,t,i,n),x0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=on(),n=Qa(t),i=Zi(r,n);i.tag=2,e!=null&&(i.callback=e),e=Xa(t,i,n),e!==null&&(ui(e,t,n,r),x0(e,t,n))}};function k_(t,e,r,n,i,a,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,s):e.prototype&&e.prototype.isPureReactComponent?!iu(r,n)||!iu(i,a):!0}function kT(t,e,r){var n=!1,i=as,a=e.contextType;return typeof a=="object"&&a!==null?a=Qn(a):(i=_n(e)?qs:Qr.current,n=e.contextTypes,a=(n=n!=null)?vl(t,i):as),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yh,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function S_(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Yh.enqueueReplaceState(e,e.state,null)}function km(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},iv(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Qn(a):(a=_n(e)?qs:Qr.current,i.context=vl(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Tm(t,e,a,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Yh.enqueueReplaceState(i,i.state,null),X0(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function wl(t,e){try{var r="",n=e;do r+=Kb(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function dp(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Sm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var wN=typeof WeakMap=="function"?WeakMap:Map;function ST(t,e,r){r=Zi(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){eh||(eh=!0,Om=n),Sm(t,e)},r}function AT(t,e,r){r=Zi(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Sm(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Sm(t,e),typeof n!="function"&&(Ya===null?Ya=new Set([this]):Ya.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function A_(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new wN;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=ON.bind(null,t,e,r),e.then(t,t))}function I_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function b_(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Zi(-1,1),e.tag=2,Xa(r,e,1))),r.lanes|=1),t)}var EN=pa.ReactCurrentOwner,vn=!1;function rn(t,e,r,n){e.child=t===null?tT(e,null,r,n):_l(e,t.child,r,n)}function C_(t,e,r,n,i){r=r.render;var a=e.ref;return nl(e,i),n=cv(t,e,r,n,a,i),r=uv(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,la(t,e,i)):(Mt&&r&&Qg(e),e.flags|=1,rn(t,e,n,i),e.child)}function N_(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!yv(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,IT(t,e,a,n,i)):(t=k0(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:iu,r(s,n)&&t.ref===e.ref)return la(t,e,i)}return e.flags|=1,t=Ja(a,n),t.ref=e.ref,t.return=e,e.child=t}function IT(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(iu(a,n)&&t.ref===e.ref)if(vn=!1,e.pendingProps=n=a,(t.lanes&i)!==0)t.flags&131072&&(vn=!0);else return e.lanes=t.lanes,la(t,e,i)}return Am(t,e,r,n,i)}function bT(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(Yo,bn),bn|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,It(Yo,bn),bn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,It(Yo,bn),bn|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,It(Yo,bn),bn|=n;return rn(t,e,i,r),e.child}function CT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Am(t,e,r,n,i){var a=_n(r)?qs:Qr.current;return a=vl(e,a),nl(e,i),r=cv(t,e,r,n,a,i),n=uv(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,la(t,e,i)):(Mt&&n&&Qg(e),e.flags|=1,rn(t,e,r,i),e.child)}function R_(t,e,r,n,i){if(_n(r)){var a=!0;H0(e)}else a=!1;if(nl(e,i),e.stateNode===null)w0(t,e),kT(e,r,n),km(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=Qn(c):(c=_n(r)?qs:Qr.current,c=vl(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&S_(e,s,n,c),Na=!1;var d=e.memoizedState;s.state=d,X0(e,n,s,i),l=e.memoizedState,o!==n||d!==l||xn.current||Na?(typeof u=="function"&&(Tm(e,r,u,n),l=e.memoizedState),(o=Na||k_(e,r,o,n,d,l,c))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,nT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:ii(e.type,o),s.props=c,h=e.pendingProps,d=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=Qn(l):(l=_n(r)?qs:Qr.current,l=vl(e,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||d!==l)&&S_(e,s,n,l),Na=!1,d=e.memoizedState,s.state=d,X0(e,n,s,i);var g=e.memoizedState;o!==h||d!==g||xn.current||Na?(typeof p=="function"&&(Tm(e,r,p,n),g=e.memoizedState),(c=Na||k_(e,r,c,n,d,g,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,g,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,g,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),s.props=n,s.state=g,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Im(t,e,r,n,a,i)}function Im(t,e,r,n,i,a){CT(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&g_(e,r,!1),la(t,e,a);n=e.stateNode,EN.current=e;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=_l(e,t.child,null,a),e.child=_l(e,null,o,a)):rn(t,e,o,a),e.memoizedState=n.state,i&&g_(e,r,!0),e.child}function NT(t){var e=t.stateNode;e.pendingContext?m_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&m_(t,e.context,!1),av(t,e.containerInfo)}function F_(t,e,r,n,i){return xl(),Zg(i),e.flags|=256,rn(t,e,r,n),e.child}var bm={dehydrated:null,treeContext:null,retryLane:0};function Cm(t){return{baseLanes:t,cachePool:null,transitions:null}}function RT(t,e,r){var n=e.pendingProps,i=Bt.current,a=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),It(Bt,i&1),t===null)return wm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,a?(n=e.mode,a=e.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=Zh(s,n,0,null),t=Us(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Cm(r),e.memoizedState=bm,t):dv(e,s));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return TN(t,e,s,n,o,i,r);if(a){a=n.fallback,s=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Ja(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Ja(o,a):(a=Us(a,s,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,s=t.child.memoizedState,s=s===null?Cm(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=t.childLanes&~r,e.memoizedState=bm,n}return a=t.child,t=a.sibling,n=Ja(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function dv(t,e){return e=Zh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $f(t,e,r,n){return n!==null&&Zg(n),_l(e,t.child,null,r),t=dv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function TN(t,e,r,n,i,a,s){if(r)return e.flags&256?(e.flags&=-257,n=dp(Error(xe(422))),$f(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,i=e.mode,n=Zh({mode:"visible",children:n.children},i,0,null),a=Us(a,i,s,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&_l(e,t.child,null,s),e.child.memoizedState=Cm(s),e.memoizedState=bm,a);if(!(e.mode&1))return $f(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(xe(419)),n=dp(a,n,void 0),$f(t,e,s,n)}if(o=(s&t.childLanes)!==0,vn||o){if(n=Er,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,oa(t,i),ui(n,t,i,-1))}return _v(),n=dp(Error(xe(421))),$f(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=LN.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Pn=Ka(i.nextSibling),On=e,Mt=!0,si=null,t!==null&&(Gn[qn++]=qi,Gn[qn++]=Ki,Gn[qn++]=Ks,qi=t.id,Ki=t.overflow,Ks=e),e=dv(e,n.children),e.flags|=4096,e)}function P_(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Em(t.return,e,r)}function pp(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function FT(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(rn(t,e,n.children,r),n=Bt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&P_(t,r,e);else if(t.tag===19)P_(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(It(Bt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Y0(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),pp(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Y0(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}pp(e,!0,r,null,a);break;case"together":pp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function w0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function la(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ys|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(xe(153));if(e.child!==null){for(t=e.child,r=Ja(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ja(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function kN(t,e,r){switch(e.tag){case 3:NT(e),xl();break;case 5:iT(e);break;case 1:_n(e.type)&&H0(e);break;case 4:av(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;It(q0,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(It(Bt,Bt.current&1),e.flags|=128,null):r&e.child.childLanes?RT(t,e,r):(It(Bt,Bt.current&1),t=la(t,e,r),t!==null?t.sibling:null);It(Bt,Bt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return FT(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),It(Bt,Bt.current),n)break;return null;case 22:case 23:return e.lanes=0,bT(t,e,r)}return la(t,e,r)}var PT,Nm,DT,OT;PT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Nm=function(){};DT=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Ls(Ci.current);var a=null;switch(r){case"input":i=Jp(t,i),n=Jp(t,n),a=[];break;case"select":i=Wt({},i,{value:void 0}),n=Wt({},n,{value:void 0}),a=[];break;case"textarea":i=tm(t,i),n=tm(t,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=z0)}nm(r,n);var s;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qc.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ct("scroll",t),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(e.updateQueue=c)&&(e.flags|=4)}};OT=function(t,e,r,n){r!==n&&(e.flags|=4)};function cc(t,e){if(!Mt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Br(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function SN(t,e,r){var n=e.pendingProps;switch(Jg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Br(e),null;case 1:return _n(e.type)&&W0(),Br(e),null;case 3:return n=e.stateNode,yl(),Ft(xn),Ft(Qr),ov(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Wf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,si!==null&&(jm(si),si=null))),Nm(t,e),Br(e),null;case 5:sv(e);var i=Ls(cu.current);if(r=e.type,t!==null&&e.stateNode!=null)DT(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(xe(166));return Br(e),null}if(t=Ls(Ci.current),Wf(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[Si]=e,n[ou]=a,t=(e.mode&1)!==0,r){case"dialog":Ct("cancel",n),Ct("close",n);break;case"iframe":case"object":case"embed":Ct("load",n);break;case"video":case"audio":for(i=0;i<vc.length;i++)Ct(vc[i],n);break;case"source":Ct("error",n);break;case"img":case"image":case"link":Ct("error",n),Ct("load",n);break;case"details":Ct("toggle",n);break;case"input":z1(n,a),Ct("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Ct("invalid",n);break;case"textarea":H1(n,a),Ct("invalid",n)}nm(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&zf(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&zf(n.textContent,o,t),i=["children",""+o]):Qc.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Ct("scroll",n)}switch(r){case"input":Df(n),W1(n,a,!0);break;case"textarea":Df(n),$1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=z0)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[Si]=e,t[ou]=n,PT(t,e,!1,!1),e.stateNode=t;e:{switch(s=im(r,n),r){case"dialog":Ct("cancel",t),Ct("close",t),i=n;break;case"iframe":case"object":case"embed":Ct("load",t),i=n;break;case"video":case"audio":for(i=0;i<vc.length;i++)Ct(vc[i],t);i=n;break;case"source":Ct("error",t),i=n;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),i=n;break;case"details":Ct("toggle",t),i=n;break;case"input":z1(t,n),i=Jp(t,n),Ct("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Wt({},n,{value:void 0}),Ct("invalid",t);break;case"textarea":H1(t,n),i=tm(t,n),Ct("invalid",t);break;default:i=n}nm(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?hE(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&uE(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Jc(t,l):typeof l=="number"&&Jc(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Qc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Ct("scroll",t):l!=null&&Mg(t,a,l,s))}switch(r){case"input":Df(t),W1(t,n,!1);break;case"textarea":Df(t),$1(t);break;case"option":n.value!=null&&t.setAttribute("value",""+is(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?Zo(t,!!n.multiple,a,!1):n.defaultValue!=null&&Zo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=z0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Br(e),null;case 6:if(t&&e.stateNode!=null)OT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(xe(166));if(r=Ls(cu.current),Ls(Ci.current),Wf(e)){if(n=e.stateNode,r=e.memoizedProps,n[Si]=e,(a=n.nodeValue!==r)&&(t=On,t!==null))switch(t.tag){case 3:zf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zf(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Si]=e,e.stateNode=n}return Br(e),null;case 13:if(Ft(Bt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Mt&&Pn!==null&&e.mode&1&&!(e.flags&128))ZE(),xl(),e.flags|=98560,a=!1;else if(a=Wf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(xe(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(xe(317));a[Si]=e}else xl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Br(e),a=!1}else si!==null&&(jm(si),si=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Bt.current&1?pr===0&&(pr=3):_v())),e.updateQueue!==null&&(e.flags|=4),Br(e),null);case 4:return yl(),Nm(t,e),t===null&&au(e.stateNode.containerInfo),Br(e),null;case 10:return rv(e.type._context),Br(e),null;case 17:return _n(e.type)&&W0(),Br(e),null;case 19:if(Ft(Bt),a=e.memoizedState,a===null)return Br(e),null;if(n=(e.flags&128)!==0,s=a.rendering,s===null)if(n)cc(a,!1);else{if(pr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Y0(t),s!==null){for(e.flags|=128,cc(a,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return It(Bt,Bt.current&1|2),e.child}t=t.sibling}a.tail!==null&&Zt()>El&&(e.flags|=128,n=!0,cc(a,!1),e.lanes=4194304)}else{if(!n)if(t=Y0(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),cc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!Mt)return Br(e),null}else 2*Zt()-a.renderingStartTime>El&&r!==1073741824&&(e.flags|=128,n=!0,cc(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(r=a.last,r!==null?r.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Zt(),e.sibling=null,r=Bt.current,It(Bt,n?r&1|2:r&1),e):(Br(e),null);case 22:case 23:return xv(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?bn&1073741824&&(Br(e),e.subtreeFlags&6&&(e.flags|=8192)):Br(e),null;case 24:return null;case 25:return null}throw Error(xe(156,e.tag))}function AN(t,e){switch(Jg(e),e.tag){case 1:return _n(e.type)&&W0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return yl(),Ft(xn),Ft(Qr),ov(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return sv(e),null;case 13:if(Ft(Bt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(xe(340));xl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ft(Bt),null;case 4:return yl(),null;case 10:return rv(e.type._context),null;case 22:case 23:return xv(),null;case 24:return null;default:return null}}var Gf=!1,Gr=!1,IN=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Xo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){qt(t,e,n)}else r.current=null}function Rm(t,e,r){try{r()}catch(n){qt(t,e,n)}}var D_=!1;function bN(t,e){if(pm=B0,t=VE(),Yg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(o=s+i),h!==a||n!==0&&h.nodeType!==3||(l=s+n),h.nodeType===3&&(s+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===r&&++c===i&&(o=s),d===a&&++u===n&&(l=s),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(mm={focusedElem:t,selectionRange:r},B0=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,_=g.memoizedState,y=e.stateNode,T=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:ii(e.type,m),_);y.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(R){qt(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return g=D_,D_=!1,g}function Dc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Rm(e,r,a)}i=i.next}while(i!==n)}}function Qh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Fm(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function LT(t){var e=t.alternate;e!==null&&(t.alternate=null,LT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Si],delete e[ou],delete e[xm],delete e[uN],delete e[fN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function MT(t){return t.tag===5||t.tag===3||t.tag===4}function O_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||MT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=z0));else if(n!==4&&(t=t.child,t!==null))for(Pm(t,e,r),t=t.sibling;t!==null;)Pm(t,e,r),t=t.sibling}function Dm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Dm(t,e,r),t=t.sibling;t!==null;)Dm(t,e,r),t=t.sibling}var Ar=null,ai=!1;function Sa(t,e,r){for(r=r.child;r!==null;)jT(t,e,r),r=r.sibling}function jT(t,e,r){if(bi&&typeof bi.onCommitFiberUnmount=="function")try{bi.onCommitFiberUnmount(Wh,r)}catch{}switch(r.tag){case 5:Gr||Xo(r,e);case 6:var n=Ar,i=ai;Ar=null,Sa(t,e,r),Ar=n,ai=i,Ar!==null&&(ai?(t=Ar,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Ar.removeChild(r.stateNode));break;case 18:Ar!==null&&(ai?(t=Ar,r=r.stateNode,t.nodeType===8?op(t.parentNode,r):t.nodeType===1&&op(t,r),ru(t)):op(Ar,r.stateNode));break;case 4:n=Ar,i=ai,Ar=r.stateNode.containerInfo,ai=!0,Sa(t,e,r),Ar=n,ai=i;break;case 0:case 11:case 14:case 15:if(!Gr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&Rm(r,e,s),i=i.next}while(i!==n)}Sa(t,e,r);break;case 1:if(!Gr&&(Xo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){qt(r,e,o)}Sa(t,e,r);break;case 21:Sa(t,e,r);break;case 22:r.mode&1?(Gr=(n=Gr)||r.memoizedState!==null,Sa(t,e,r),Gr=n):Sa(t,e,r);break;default:Sa(t,e,r)}}function L_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new IN),e.forEach(function(n){var i=MN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ri(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=t,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:Ar=o.stateNode,ai=!1;break e;case 3:Ar=o.stateNode.containerInfo,ai=!0;break e;case 4:Ar=o.stateNode.containerInfo,ai=!0;break e}o=o.return}if(Ar===null)throw Error(xe(160));jT(a,s,i),Ar=null,ai=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){qt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BT(e,t),e=e.sibling}function BT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ri(e,t),_i(t),n&4){try{Dc(3,t,t.return),Qh(3,t)}catch(m){qt(t,t.return,m)}try{Dc(5,t,t.return)}catch(m){qt(t,t.return,m)}}break;case 1:ri(e,t),_i(t),n&512&&r!==null&&Xo(r,r.return);break;case 5:if(ri(e,t),_i(t),n&512&&r!==null&&Xo(r,r.return),t.flags&32){var i=t.stateNode;try{Jc(i,"")}catch(m){qt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,s=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&oE(i,a),im(o,s);var c=im(o,a);for(s=0;s<l.length;s+=2){var u=l[s],h=l[s+1];u==="style"?hE(i,h):u==="dangerouslySetInnerHTML"?uE(i,h):u==="children"?Jc(i,h):Mg(i,u,h,c)}switch(o){case"input":Zp(i,a);break;case"textarea":lE(i,a);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Zo(i,!!a.multiple,p,!1):d!==!!a.multiple&&(a.defaultValue!=null?Zo(i,!!a.multiple,a.defaultValue,!0):Zo(i,!!a.multiple,a.multiple?[]:"",!1))}i[ou]=a}catch(m){qt(t,t.return,m)}}break;case 6:if(ri(e,t),_i(t),n&4){if(t.stateNode===null)throw Error(xe(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(m){qt(t,t.return,m)}}break;case 3:if(ri(e,t),_i(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ru(e.containerInfo)}catch(m){qt(t,t.return,m)}break;case 4:ri(e,t),_i(t);break;case 13:ri(e,t),_i(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(gv=Zt())),n&4&&L_(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Gr=(c=Gr)||u,ri(e,t),Gr=c):ri(e,t),_i(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ne=t,u=t.child;u!==null;){for(h=Ne=u;Ne!==null;){switch(d=Ne,p=d.child,d.tag){case 0:case 11:case 14:case 15:Dc(4,d,d.return);break;case 1:Xo(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){qt(n,r,m)}}break;case 5:Xo(d,d.return);break;case 22:if(d.memoizedState!==null){j_(h);continue}}p!==null?(p.return=d,Ne=p):j_(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=fE("display",s))}catch(m){qt(t,t.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){qt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ri(e,t),_i(t),n&4&&L_(t);break;case 21:break;default:ri(e,t),_i(t)}}function _i(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(MT(r)){var n=r;break e}r=r.return}throw Error(xe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Jc(i,""),n.flags&=-33);var a=O_(t);Dm(t,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=O_(t);Pm(t,o,s);break;default:throw Error(xe(161))}}catch(l){qt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function CN(t,e,r){Ne=t,VT(t)}function VT(t,e,r){for(var n=(t.mode&1)!==0;Ne!==null;){var i=Ne,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Gf;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Gr;o=Gf;var c=Gr;if(Gf=s,(Gr=l)&&!c)for(Ne=i;Ne!==null;)s=Ne,l=s.child,s.tag===22&&s.memoizedState!==null?B_(i):l!==null?(l.return=s,Ne=l):B_(i);for(;a!==null;)Ne=a,VT(a),a=a.sibling;Ne=i,Gf=o,Gr=c}M_(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Ne=a):M_(t)}}function M_(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gr||Qh(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Gr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ii(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&w_(e,a,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}w_(e,s,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&ru(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}Gr||e.flags&512&&Fm(e)}catch(d){qt(e,e.return,d)}}if(e===t){Ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function j_(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function B_(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Qh(4,e)}catch(l){qt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){qt(e,i,l)}}var a=e.return;try{Fm(e)}catch(l){qt(e,a,l)}break;case 5:var s=e.return;try{Fm(e)}catch(l){qt(e,s,l)}}}catch(l){qt(e,e.return,l)}if(e===t){Ne=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ne=o;break}Ne=e.return}}var NN=Math.ceil,Z0=pa.ReactCurrentDispatcher,pv=pa.ReactCurrentOwner,Xn=pa.ReactCurrentBatchConfig,st=0,Er=null,lr=null,Fr=0,bn=0,Yo=ps(0),pr=0,du=null,Ys=0,Jh=0,mv=0,Oc=null,pn=null,gv=0,El=1/0,$i=null,eh=!1,Om=null,Ya=null,qf=!1,Ba=null,th=0,Lc=0,Lm=null,E0=-1,T0=0;function on(){return st&6?Zt():E0!==-1?E0:E0=Zt()}function Qa(t){return t.mode&1?st&2&&Fr!==0?Fr&-Fr:dN.transition!==null?(T0===0&&(T0=kE()),T0):(t=vt,t!==0||(t=window.event,t=t===void 0?16:RE(t.type)),t):1}function ui(t,e,r,n){if(50<Lc)throw Lc=0,Lm=null,Error(xe(185));zu(t,r,n),(!(st&2)||t!==Er)&&(t===Er&&(!(st&2)&&(Jh|=r),pr===4&&Fa(t,Fr)),yn(t,n),r===1&&st===0&&!(e.mode&1)&&(El=Zt()+500,Kh&&ms()))}function yn(t,e){var r=t.callbackNode;dC(t,e);var n=j0(t,t===Er?Fr:0);if(n===0)r!==null&&K1(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&K1(r),e===1)t.tag===0?hN(V_.bind(null,t)):YE(V_.bind(null,t)),lN(function(){!(st&6)&&ms()}),r=null;else{switch(SE(n)){case 1:r=zg;break;case 4:r=EE;break;case 16:r=M0;break;case 536870912:r=TE;break;default:r=M0}r=KT(r,UT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function UT(t,e){if(E0=-1,T0=0,st&6)throw Error(xe(327));var r=t.callbackNode;if(il()&&t.callbackNode!==r)return null;var n=j0(t,t===Er?Fr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=rh(t,n);else{e=n;var i=st;st|=2;var a=WT();(Er!==t||Fr!==e)&&($i=null,El=Zt()+500,Vs(t,e));do try{PN();break}catch(o){zT(t,o)}while(!0);tv(),Z0.current=a,st=i,lr!==null?e=0:(Er=null,Fr=0,e=pr)}if(e!==0){if(e===2&&(i=cm(t),i!==0&&(n=i,e=Mm(t,i))),e===1)throw r=du,Vs(t,0),Fa(t,n),yn(t,Zt()),r;if(e===6)Fa(t,n);else{if(i=t.current.alternate,!(n&30)&&!RN(i)&&(e=rh(t,n),e===2&&(a=cm(t),a!==0&&(n=a,e=Mm(t,a))),e===1))throw r=du,Vs(t,0),Fa(t,n),yn(t,Zt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(xe(345));case 2:Ns(t,pn,$i);break;case 3:if(Fa(t,n),(n&130023424)===n&&(e=gv+500-Zt(),10<e)){if(j0(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){on(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=vm(Ns.bind(null,t,pn,$i),e);break}Ns(t,pn,$i);break;case 4:if(Fa(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-ci(n);a=1<<s,s=e[s],s>i&&(i=s),n&=~a}if(n=i,n=Zt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*NN(n/1960))-n,10<n){t.timeoutHandle=vm(Ns.bind(null,t,pn,$i),n);break}Ns(t,pn,$i);break;case 5:Ns(t,pn,$i);break;default:throw Error(xe(329))}}}return yn(t,Zt()),t.callbackNode===r?UT.bind(null,t):null}function Mm(t,e){var r=Oc;return t.current.memoizedState.isDehydrated&&(Vs(t,e).flags|=256),t=rh(t,e),t!==2&&(e=pn,pn=r,e!==null&&jm(e)),t}function jm(t){pn===null?pn=t:pn.push.apply(pn,t)}function RN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!di(a(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fa(t,e){for(e&=~mv,e&=~Jh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ci(e),n=1<<r;t[r]=-1,e&=~n}}function V_(t){if(st&6)throw Error(xe(327));il();var e=j0(t,0);if(!(e&1))return yn(t,Zt()),null;var r=rh(t,e);if(t.tag!==0&&r===2){var n=cm(t);n!==0&&(e=n,r=Mm(t,n))}if(r===1)throw r=du,Vs(t,0),Fa(t,e),yn(t,Zt()),r;if(r===6)throw Error(xe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ns(t,pn,$i),yn(t,Zt()),null}function vv(t,e){var r=st;st|=1;try{return t(e)}finally{st=r,st===0&&(El=Zt()+500,Kh&&ms())}}function Qs(t){Ba!==null&&Ba.tag===0&&!(st&6)&&il();var e=st;st|=1;var r=Xn.transition,n=vt;try{if(Xn.transition=null,vt=1,t)return t()}finally{vt=n,Xn.transition=r,st=e,!(st&6)&&ms()}}function xv(){bn=Yo.current,Ft(Yo)}function Vs(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,oN(r)),lr!==null)for(r=lr.return;r!==null;){var n=r;switch(Jg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&W0();break;case 3:yl(),Ft(xn),Ft(Qr),ov();break;case 5:sv(n);break;case 4:yl();break;case 13:Ft(Bt);break;case 19:Ft(Bt);break;case 10:rv(n.type._context);break;case 22:case 23:xv()}r=r.return}if(Er=t,lr=t=Ja(t.current,null),Fr=bn=e,pr=0,du=null,mv=Jh=Ys=0,pn=Oc=null,Os!==null){for(e=0;e<Os.length;e++)if(r=Os[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}Os=null}return t}function zT(t,e){do{var r=lr;try{if(tv(),_0.current=J0,Q0){for(var n=zt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Q0=!1}if(Xs=0,_r=hr=zt=null,Pc=!1,uu=0,pv.current=null,r===null||r.return===null){pr=1,du=e,lr=null;break}e:{var a=t,s=r.return,o=r,l=e;if(e=Fr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=I_(s);if(p!==null){p.flags&=-257,b_(p,s,o,a,e),p.mode&1&&A_(a,c,e),e=p,l=c;var g=e.updateQueue;if(g===null){var m=new Set;m.add(l),e.updateQueue=m}else g.add(l);break e}else{if(!(e&1)){A_(a,c,e),_v();break e}l=Error(xe(426))}}else if(Mt&&o.mode&1){var _=I_(s);if(_!==null){!(_.flags&65536)&&(_.flags|=256),b_(_,s,o,a,e),Zg(wl(l,o));break e}}a=l=wl(l,o),pr!==4&&(pr=2),Oc===null?Oc=[a]:Oc.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var y=ST(a,l,e);y_(a,y);break e;case 1:o=l;var T=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ya===null||!Ya.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e;var R=AT(a,o,e);y_(a,R);break e}}a=a.return}while(a!==null)}$T(r)}catch(j){e=j,lr===r&&r!==null&&(lr=r=r.return);continue}break}while(!0)}function WT(){var t=Z0.current;return Z0.current=J0,t===null?J0:t}function _v(){(pr===0||pr===3||pr===2)&&(pr=4),Er===null||!(Ys&268435455)&&!(Jh&268435455)||Fa(Er,Fr)}function rh(t,e){var r=st;st|=2;var n=WT();(Er!==t||Fr!==e)&&($i=null,Vs(t,e));do try{FN();break}catch(i){zT(t,i)}while(!0);if(tv(),st=r,Z0.current=n,lr!==null)throw Error(xe(261));return Er=null,Fr=0,pr}function FN(){for(;lr!==null;)HT(lr)}function PN(){for(;lr!==null&&!iC();)HT(lr)}function HT(t){var e=qT(t.alternate,t,bn);t.memoizedProps=t.pendingProps,e===null?$T(t):lr=e,pv.current=null}function $T(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=AN(r,e),r!==null){r.flags&=32767,lr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{pr=6,lr=null;return}}else if(r=SN(r,e,bn),r!==null){lr=r;return}if(e=e.sibling,e!==null){lr=e;return}lr=e=t}while(e!==null);pr===0&&(pr=5)}function Ns(t,e,r){var n=vt,i=Xn.transition;try{Xn.transition=null,vt=1,DN(t,e,r,n)}finally{Xn.transition=i,vt=n}return null}function DN(t,e,r,n){do il();while(Ba!==null);if(st&6)throw Error(xe(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(xe(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(pC(t,a),t===Er&&(lr=Er=null,Fr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||qf||(qf=!0,KT(M0,function(){return il(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Xn.transition,Xn.transition=null;var s=vt;vt=1;var o=st;st|=4,pv.current=null,bN(t,r),BT(r,t),eN(mm),B0=!!pm,mm=pm=null,t.current=r,CN(r),aC(),st=o,vt=s,Xn.transition=a}else t.current=r;if(qf&&(qf=!1,Ba=t,th=i),a=t.pendingLanes,a===0&&(Ya=null),lC(r.stateNode),yn(t,Zt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(eh)throw eh=!1,t=Om,Om=null,t;return th&1&&t.tag!==0&&il(),a=t.pendingLanes,a&1?t===Lm?Lc++:(Lc=0,Lm=t):Lc=0,ms(),null}function il(){if(Ba!==null){var t=SE(th),e=Xn.transition,r=vt;try{if(Xn.transition=null,vt=16>t?16:t,Ba===null)var n=!1;else{if(t=Ba,Ba=null,th=0,st&6)throw Error(xe(331));var i=st;for(st|=4,Ne=t.current;Ne!==null;){var a=Ne,s=a.child;if(Ne.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var u=Ne;switch(u.tag){case 0:case 11:case 15:Dc(8,u,a)}var h=u.child;if(h!==null)h.return=u,Ne=h;else for(;Ne!==null;){u=Ne;var d=u.sibling,p=u.return;if(LT(u),u===c){Ne=null;break}if(d!==null){d.return=p,Ne=d;break}Ne=p}}}var g=a.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}Ne=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,Ne=s;else e:for(;Ne!==null;){if(a=Ne,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Dc(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,Ne=y;break e}Ne=a.return}}var T=t.current;for(Ne=T;Ne!==null;){s=Ne;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,Ne=w;else e:for(s=T;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Qh(9,o)}}catch(j){qt(o,o.return,j)}if(o===s){Ne=null;break e}var R=o.sibling;if(R!==null){R.return=o.return,Ne=R;break e}Ne=o.return}}if(st=i,ms(),bi&&typeof bi.onPostCommitFiberRoot=="function")try{bi.onPostCommitFiberRoot(Wh,t)}catch{}n=!0}return n}finally{vt=r,Xn.transition=e}}return!1}function U_(t,e,r){e=wl(r,e),e=ST(t,e,1),t=Xa(t,e,1),e=on(),t!==null&&(zu(t,1,e),yn(t,e))}function qt(t,e,r){if(t.tag===3)U_(t,t,r);else for(;e!==null;){if(e.tag===3){U_(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ya===null||!Ya.has(n))){t=wl(r,t),t=AT(e,t,1),e=Xa(e,t,1),t=on(),e!==null&&(zu(e,1,t),yn(e,t));break}}e=e.return}}function ON(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=on(),t.pingedLanes|=t.suspendedLanes&r,Er===t&&(Fr&r)===r&&(pr===4||pr===3&&(Fr&130023424)===Fr&&500>Zt()-gv?Vs(t,0):mv|=r),yn(t,e)}function GT(t,e){e===0&&(t.mode&1?(e=Mf,Mf<<=1,!(Mf&130023424)&&(Mf=4194304)):e=1);var r=on();t=oa(t,e),t!==null&&(zu(t,e,r),yn(t,r))}function LN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),GT(t,r)}function MN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(xe(314))}n!==null&&n.delete(e),GT(t,r)}var qT;qT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||xn.current)vn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return vn=!1,kN(t,e,r);vn=!!(t.flags&131072)}else vn=!1,Mt&&e.flags&1048576&&QE(e,G0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;w0(t,e),t=e.pendingProps;var i=vl(e,Qr.current);nl(e,r),i=cv(null,e,n,t,i,r);var a=uv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_n(n)?(a=!0,H0(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,iv(e),i.updater=Yh,e.stateNode=i,i._reactInternals=e,km(e,n,t,r),e=Im(null,e,n,!0,a,r)):(e.tag=0,Mt&&a&&Qg(e),rn(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(w0(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=BN(n),t=ii(n,t),i){case 0:e=Am(null,e,n,t,r);break e;case 1:e=R_(null,e,n,t,r);break e;case 11:e=C_(null,e,n,t,r);break e;case 14:e=N_(null,e,n,ii(n.type,t),r);break e}throw Error(xe(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ii(n,i),Am(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ii(n,i),R_(t,e,n,i,r);case 3:e:{if(NT(e),t===null)throw Error(xe(387));n=e.pendingProps,a=e.memoizedState,i=a.element,nT(t,e),X0(e,n,null,r);var s=e.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=wl(Error(xe(423)),e),e=F_(t,e,n,r,i);break e}else if(n!==i){i=wl(Error(xe(424)),e),e=F_(t,e,n,r,i);break e}else for(Pn=Ka(e.stateNode.containerInfo.firstChild),On=e,Mt=!0,si=null,r=tT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(xl(),n===i){e=la(t,e,r);break e}rn(t,e,n,r)}e=e.child}return e;case 5:return iT(e),t===null&&wm(e),n=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,s=i.children,gm(n,i)?s=null:a!==null&&gm(n,a)&&(e.flags|=32),CT(t,e),rn(t,e,s,r),e.child;case 6:return t===null&&wm(e),null;case 13:return RT(t,e,r);case 4:return av(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=_l(e,null,n,r):rn(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ii(n,i),C_(t,e,n,i,r);case 7:return rn(t,e,e.pendingProps,r),e.child;case 8:return rn(t,e,e.pendingProps.children,r),e.child;case 12:return rn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,It(q0,n._currentValue),n._currentValue=s,a!==null)if(di(a.value,s)){if(a.children===i.children&&!xn.current){e=la(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Zi(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Em(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(xe(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Em(s,r,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}rn(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,nl(e,r),i=Qn(i),n=n(i),e.flags|=1,rn(t,e,n,r),e.child;case 14:return n=e.type,i=ii(n,e.pendingProps),i=ii(n.type,i),N_(t,e,n,i,r);case 15:return IT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ii(n,i),w0(t,e),e.tag=1,_n(n)?(t=!0,H0(e)):t=!1,nl(e,r),kT(e,n,i),km(e,n,i,r),Im(null,e,n,!0,t,r);case 19:return FT(t,e,r);case 22:return bT(t,e,r)}throw Error(xe(156,e.tag))};function KT(t,e){return wE(t,e)}function jN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(t,e,r,n){return new jN(t,e,r,n)}function yv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function BN(t){if(typeof t=="function")return yv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bg)return 11;if(t===Vg)return 14}return 2}function Ja(t,e){var r=t.alternate;return r===null?(r=Kn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function k0(t,e,r,n,i,a){var s=2;if(n=t,typeof t=="function")yv(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Vo:return Us(r.children,i,a,e);case jg:s=8,i|=8;break;case Kp:return t=Kn(12,r,e,i|2),t.elementType=Kp,t.lanes=a,t;case Xp:return t=Kn(13,r,e,i),t.elementType=Xp,t.lanes=a,t;case Yp:return t=Kn(19,r,e,i),t.elementType=Yp,t.lanes=a,t;case iE:return Zh(r,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case rE:s=10;break e;case nE:s=9;break e;case Bg:s=11;break e;case Vg:s=14;break e;case Ca:s=16,n=null;break e}throw Error(xe(130,t==null?t:typeof t,""))}return e=Kn(s,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function Us(t,e,r,n){return t=Kn(7,t,n,e),t.lanes=r,t}function Zh(t,e,r,n){return t=Kn(22,t,n,e),t.elementType=iE,t.lanes=r,t.stateNode={isHidden:!1},t}function mp(t,e,r){return t=Kn(6,t,null,e),t.lanes=r,t}function gp(t,e,r){return e=Kn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function VN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yd(0),this.expirationTimes=Yd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function wv(t,e,r,n,i,a,s,o,l){return t=new VN(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Kn(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},iv(a),t}function UN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bo,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function XT(t){if(!t)return as;t=t._reactInternals;e:{if(fo(t)!==t||t.tag!==1)throw Error(xe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xe(171))}if(t.tag===1){var r=t.type;if(_n(r))return XE(t,r,e)}return e}function YT(t,e,r,n,i,a,s,o,l){return t=wv(r,n,!0,t,i,a,s,o,l),t.context=XT(null),r=t.current,n=on(),i=Qa(r),a=Zi(n,i),a.callback=e??null,Xa(r,a,i),t.current.lanes=i,zu(t,i,n),yn(t,n),t}function ed(t,e,r,n){var i=e.current,a=on(),s=Qa(i);return r=XT(r),e.context===null?e.context=r:e.pendingContext=r,e=Zi(a,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Xa(i,e,s),t!==null&&(ui(t,i,s,a),x0(t,i,s)),s}function nh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function z_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Ev(t,e){z_(t,e),(t=t.alternate)&&z_(t,e)}function zN(){return null}var QT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tv(t){this._internalRoot=t}td.prototype.render=Tv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(xe(409));ed(t,e,null,null)};td.prototype.unmount=Tv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qs(function(){ed(null,t,null,null)}),e[sa]=null}};function td(t){this._internalRoot=t}td.prototype.unstable_scheduleHydration=function(t){if(t){var e=bE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ra.length&&e!==0&&e<Ra[r].priority;r++);Ra.splice(r,0,t),r===0&&NE(t)}};function kv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function rd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function W_(){}function WN(t,e,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var c=nh(s);a.call(c)}}var s=YT(e,n,t,0,null,!1,!1,"",W_);return t._reactRootContainer=s,t[sa]=s.current,au(t.nodeType===8?t.parentNode:t),Qs(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=nh(l);o.call(c)}}var l=wv(t,0,!1,null,null,!1,!1,"",W_);return t._reactRootContainer=l,t[sa]=l.current,au(t.nodeType===8?t.parentNode:t),Qs(function(){ed(e,l,r,n)}),l}function nd(t,e,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=nh(s);o.call(l)}}ed(e,s,t,i)}else s=WN(r,e,t,i,n);return nh(s)}AE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=gc(e.pendingLanes);r!==0&&(Wg(e,r|1),yn(e,Zt()),!(st&6)&&(El=Zt()+500,ms()))}break;case 13:Qs(function(){var n=oa(t,1);if(n!==null){var i=on();ui(n,t,1,i)}}),Ev(t,1)}};Hg=function(t){if(t.tag===13){var e=oa(t,134217728);if(e!==null){var r=on();ui(e,t,134217728,r)}Ev(t,134217728)}};IE=function(t){if(t.tag===13){var e=Qa(t),r=oa(t,e);if(r!==null){var n=on();ui(r,t,e,n)}Ev(t,e)}};bE=function(){return vt};CE=function(t,e){var r=vt;try{return vt=t,e()}finally{vt=r}};sm=function(t,e,r){switch(e){case"input":if(Zp(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=qh(n);if(!i)throw Error(xe(90));sE(n),Zp(n,i)}}}break;case"textarea":lE(t,r);break;case"select":e=r.value,e!=null&&Zo(t,!!r.multiple,e,!1)}};mE=vv;gE=Qs;var HN={usingClientEntryPoint:!1,Events:[Hu,Ho,qh,dE,pE,vv]},uc={findFiberByHostInstance:Ds,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$N={bundleType:uc.bundleType,version:uc.version,rendererPackageName:uc.rendererPackageName,rendererConfig:uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_E(t),t===null?null:t.stateNode},findFiberByHostInstance:uc.findFiberByHostInstance||zN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kf.isDisabled&&Kf.supportsFiber)try{Wh=Kf.inject($N),bi=Kf}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HN;jn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kv(e))throw Error(xe(200));return UN(t,e,null,r)};jn.createRoot=function(t,e){if(!kv(t))throw Error(xe(299));var r=!1,n="",i=QT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=wv(t,1,!1,null,null,r,!1,n,i),t[sa]=e.current,au(t.nodeType===8?t.parentNode:t),new Tv(e)};jn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(xe(188)):(t=Object.keys(t).join(","),Error(xe(268,t)));return t=_E(e),t=t===null?null:t.stateNode,t};jn.flushSync=function(t){return Qs(t)};jn.hydrate=function(t,e,r){if(!rd(e))throw Error(xe(200));return nd(null,t,e,!0,r)};jn.hydrateRoot=function(t,e,r){if(!kv(t))throw Error(xe(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=QT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=YT(e,null,t,1,r??null,i,!1,a,s),t[sa]=e.current,au(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new td(e)};jn.render=function(t,e,r){if(!rd(e))throw Error(xe(200));return nd(null,t,e,!1,r)};jn.unmountComponentAtNode=function(t){if(!rd(t))throw Error(xe(40));return t._reactRootContainer?(Qs(function(){nd(null,null,t,!1,function(){t._reactRootContainer=null,t[sa]=null})}),!0):!1};jn.unstable_batchedUpdates=vv;jn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!rd(r))throw Error(xe(200));if(t==null||t._reactInternals===void 0)throw Error(xe(38));return nd(t,e,r,!1,n)};jn.version="18.3.1-next-f1338f8080-20240426";function JT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(JT)}catch(t){console.error(t)}}JT(),J2.exports=jn;var GN=J2.exports,H_=GN;Gp.createRoot=H_.createRoot,Gp.hydrateRoot=H_.hydrateRoot;var ZT={exports:{}},qN="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",KN=qN,XN=KN;function ek(){}function tk(){}tk.resetWarningCache=ek;var YN=function(){function t(n,i,a,s,o,l){if(l!==XN){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:tk,resetWarningCache:ek};return r.PropTypes=r,r};ZT.exports=YN();var QN=ZT.exports;const St=V2(QN);function Sv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function ho(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?a(u.value):i(u.value).then(o,l)}c((n=n.apply(t,e||[])).next())})}const JN=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Tl(t,e,r){const n=ZN(t),{webkitRelativePath:i}=t,a=typeof e=="string"?e:typeof i=="string"&&i.length>0?i:`./${t.name}`;return typeof n.path!="string"&&$_(n,"path",a),$_(n,"relativePath",a),n}function ZN(t){const{name:e}=t;if(e&&e.lastIndexOf(".")!==-1&&!t.type){const n=e.split(".").pop().toLowerCase(),i=JN.get(n);i&&Object.defineProperty(t,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return t}function $_(t,e,r){Object.defineProperty(t,e,{value:r,writable:!1,configurable:!1,enumerable:!0})}const eR=[".DS_Store","Thumbs.db"];function tR(t){return ho(this,void 0,void 0,function*(){return ih(t)&&rR(t.dataTransfer)?sR(t.dataTransfer,t.type):nR(t)?iR(t):Array.isArray(t)&&t.every(e=>"getFile"in e&&typeof e.getFile=="function")?aR(t):[]})}function rR(t){return ih(t)}function nR(t){return ih(t)&&ih(t.target)}function ih(t){return typeof t=="object"&&t!==null}function iR(t){return Bm(t.target.files).map(e=>Tl(e))}function aR(t){return ho(this,void 0,void 0,function*(){return(yield Promise.all(t.map(r=>r.getFile()))).map(r=>Tl(r))})}function sR(t,e){return ho(this,void 0,void 0,function*(){if(t.items){const r=Bm(t.items).filter(i=>i.kind==="file");if(e!=="drop")return r;const n=yield Promise.all(r.map(oR));return G_(rk(n))}return G_(Bm(t.files).map(r=>Tl(r)))})}function G_(t){return t.filter(e=>eR.indexOf(e.name)===-1)}function Bm(t){if(t===null)return[];const e=[];for(let r=0;r<t.length;r++){const n=t[r];e.push(n)}return e}function oR(t){if(typeof t.webkitGetAsEntry!="function")return q_(t);const e=t.webkitGetAsEntry();return e&&e.isDirectory?nk(e):q_(t,e)}function rk(t){return t.reduce((e,r)=>[...e,...Array.isArray(r)?rk(r):[r]],[])}function q_(t,e){return ho(this,void 0,void 0,function*(){var r;if(globalThis.isSecureContext&&typeof t.getAsFileSystemHandle=="function"){const a=yield t.getAsFileSystemHandle();if(a===null)throw new Error(`${t} is not a File`);if(a!==void 0){const s=yield a.getFile();return s.handle=a,Tl(s)}}const n=t.getAsFile();if(!n)throw new Error(`${t} is not a File`);return Tl(n,(r=e==null?void 0:e.fullPath)!==null&&r!==void 0?r:void 0)})}function lR(t){return ho(this,void 0,void 0,function*(){return t.isDirectory?nk(t):cR(t)})}function nk(t){const e=t.createReader();return new Promise((r,n)=>{const i=[];function a(){e.readEntries(s=>ho(this,void 0,void 0,function*(){if(s.length){const o=Promise.all(s.map(lR));i.push(o),a()}else try{const o=yield Promise.all(i);r(o)}catch(o){n(o)}}),s=>{n(s)})}a()})}function cR(t){return ho(this,void 0,void 0,function*(){return new Promise((e,r)=>{t.file(n=>{const i=Tl(n,t.fullPath);e(i)},n=>{r(n)})})})}var vp=function(t,e){if(t&&e){var r=Array.isArray(e)?e:e.split(",");if(r.length===0)return!0;var n=t.name||"",i=(t.type||"").toLowerCase(),a=i.replace(/\/.*$/,"");return r.some(function(s){var o=s.trim().toLowerCase();return o.charAt(0)==="."?n.toLowerCase().endsWith(o):o.endsWith("/*")?a===o.replace(/\/.*$/,""):i===o})}return!0};function K_(t){return hR(t)||fR(t)||ak(t)||uR()}function uR(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fR(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hR(t){if(Array.isArray(t))return Vm(t)}function X_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Y_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?X_(Object(r),!0).forEach(function(n){ik(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):X_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ik(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pu(t,e){return mR(t)||pR(t,e)||ak(t,e)||dR()}function dR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ak(t,e){if(t){if(typeof t=="string")return Vm(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vm(t,e)}}function Vm(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pR(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],i=!0,a=!1,s,o;try{for(r=r.call(t);!(i=(s=r.next()).done)&&(n.push(s.value),!(e&&n.length===e));i=!0);}catch(l){a=!0,o=l}finally{try{!i&&r.return!=null&&r.return()}finally{if(a)throw o}}return n}}function mR(t){if(Array.isArray(t))return t}var gR=typeof vp=="function"?vp:vp.default,vR="file-invalid-type",xR="file-too-large",_R="file-too-small",yR="too-many-files",wR=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=e.split(","),n=r.length>1?"one of ".concat(r.join(", ")):r[0];return{code:vR,message:"File type must be ".concat(n)}},Q_=function(e){return{code:xR,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},J_=function(e){return{code:_R,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},ER={code:yR,message:"Too many files"};function sk(t,e){var r=t.type==="application/x-moz-file"||gR(t,e);return[r,r?null:wR(e)]}function ok(t,e,r){if(Fs(t.size))if(Fs(e)&&Fs(r)){if(t.size>r)return[!1,Q_(r)];if(t.size<e)return[!1,J_(e)]}else{if(Fs(e)&&t.size<e)return[!1,J_(e)];if(Fs(r)&&t.size>r)return[!1,Q_(r)]}return[!0,null]}function Fs(t){return t!=null}function TR(t){var e=t.files,r=t.accept,n=t.minSize,i=t.maxSize,a=t.multiple,s=t.maxFiles,o=t.validator;return!a&&e.length>1||a&&s>=1&&e.length>s?!1:e.every(function(l){var c=sk(l,r),u=pu(c,1),h=u[0],d=ok(l,n,i),p=pu(d,1),g=p[0],m=o?o(l):null;return h&&g&&!m})}function ah(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble<"u"?t.cancelBubble:!1}function Xf(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!t.target&&!!t.target.files}function Z_(t){t.preventDefault()}function kR(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function SR(t){return t.indexOf("Edge/")!==-1}function AR(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return kR(t)||SR(t)}function yi(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];return e.some(function(o){return!ah(n)&&o&&o.apply(void 0,[n].concat(a)),ah(n)})}}function IR(){return"showOpenFilePicker"in window}function bR(t){if(Fs(t)){var e=Object.entries(t).filter(function(r){var n=pu(r,2),i=n[0],a=n[1],s=!0;return lk(i)||(console.warn('Skipped "'.concat(i,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),s=!1),(!Array.isArray(a)||!a.every(ck))&&(console.warn('Skipped "'.concat(i,'" because an invalid file extension was provided.')),s=!1),s}).reduce(function(r,n){var i=pu(n,2),a=i[0],s=i[1];return Y_(Y_({},r),{},ik({},a,s))},{});return[{description:"Files",accept:e}]}return t}function CR(t){if(Fs(t))return Object.entries(t).reduce(function(e,r){var n=pu(r,2),i=n[0],a=n[1];return[].concat(K_(e),[i],K_(a))},[]).filter(function(e){return lk(e)||ck(e)}).join(",")}function NR(t){return t instanceof DOMException&&(t.name==="AbortError"||t.code===t.ABORT_ERR)}function RR(t){return t instanceof DOMException&&(t.name==="SecurityError"||t.code===t.SECURITY_ERR)}function lk(t){return t==="audio/*"||t==="video/*"||t==="image/*"||t==="text/*"||t==="application/*"||/\w+\/[-+.\w]+/g.test(t)}function ck(t){return/^.*\.[\w]+$/.test(t)}var FR=["children"],PR=["open"],DR=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],OR=["refKey","onChange","onClick"];function LR(t){return BR(t)||jR(t)||uk(t)||MR()}function MR(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jR(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function BR(t){if(Array.isArray(t))return Um(t)}function xp(t,e){return zR(t)||UR(t,e)||uk(t,e)||VR()}function VR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uk(t,e){if(t){if(typeof t=="string")return Um(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Um(t,e)}}function Um(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function UR(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],i=!0,a=!1,s,o;try{for(r=r.call(t);!(i=(s=r.next()).done)&&(n.push(s.value),!(e&&n.length===e));i=!0);}catch(l){a=!0,o=l}finally{try{!i&&r.return!=null&&r.return()}finally{if(a)throw o}}return n}}function zR(t){if(Array.isArray(t))return t}function ey(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function jt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ey(Object(r),!0).forEach(function(n){zm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ey(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zm(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sh(t,e){if(t==null)return{};var r=WR(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function WR(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var Av=X.forwardRef(function(t,e){var r=t.children,n=sh(t,FR),i=hk(n),a=i.open,s=sh(i,PR);return X.useImperativeHandle(e,function(){return{open:a}},[a]),zh.createElement(X.Fragment,null,r(jt(jt({},s),{},{open:a})))});Av.displayName="Dropzone";var fk={disabled:!1,getFilesFromEvent:tR,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Av.defaultProps=fk;Av.propTypes={children:St.func,accept:St.objectOf(St.arrayOf(St.string)),multiple:St.bool,preventDropOnDocument:St.bool,noClick:St.bool,noKeyboard:St.bool,noDrag:St.bool,noDragEventsBubbling:St.bool,minSize:St.number,maxSize:St.number,maxFiles:St.number,disabled:St.bool,getFilesFromEvent:St.func,onFileDialogCancel:St.func,onFileDialogOpen:St.func,useFsAccessApi:St.bool,autoFocus:St.bool,onDragEnter:St.func,onDragLeave:St.func,onDragOver:St.func,onDrop:St.func,onDropAccepted:St.func,onDropRejected:St.func,onError:St.func,validator:St.func};var Wm={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function hk(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=jt(jt({},fk),t),r=e.accept,n=e.disabled,i=e.getFilesFromEvent,a=e.maxSize,s=e.minSize,o=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,h=e.onDragOver,d=e.onDrop,p=e.onDropAccepted,g=e.onDropRejected,m=e.onFileDialogCancel,_=e.onFileDialogOpen,y=e.useFsAccessApi,T=e.autoFocus,w=e.preventDropOnDocument,R=e.noClick,j=e.noKeyboard,D=e.noDrag,E=e.noDragEventsBubbling,S=e.onError,k=e.validator,I=X.useMemo(function(){return CR(r)},[r]),b=X.useMemo(function(){return bR(r)},[r]),N=X.useMemo(function(){return typeof _=="function"?_:ty},[_]),F=X.useMemo(function(){return typeof m=="function"?m:ty},[m]),he=X.useRef(null),de=X.useRef(null),Ae=X.useReducer(HR,Wm),ve=xp(Ae,2),le=ve[0],P=ve[1],Q=le.isFocused,re=le.isFileDialogActive,O=X.useRef(typeof window<"u"&&window.isSecureContext&&y&&IR()),q=function(){!O.current&&re&&setTimeout(function(){if(de.current){var Fe=de.current.files;Fe.length||(P({type:"closeDialog"}),F())}},300)};X.useEffect(function(){return window.addEventListener("focus",q,!1),function(){window.removeEventListener("focus",q,!1)}},[de,re,F,O]);var H=X.useRef([]),G=function(Fe){he.current&&he.current.contains(Fe.target)||(Fe.preventDefault(),H.current=[])};X.useEffect(function(){return w&&(document.addEventListener("dragover",Z_,!1),document.addEventListener("drop",G,!1)),function(){w&&(document.removeEventListener("dragover",Z_),document.removeEventListener("drop",G))}},[he,w]),X.useEffect(function(){return!n&&T&&he.current&&he.current.focus(),function(){}},[he,T,n]);var K=X.useCallback(function(ye){S?S(ye):console.error(ye)},[S]),ne=X.useCallback(function(ye){ye.preventDefault(),ye.persist(),ur(ye),H.current=[].concat(LR(H.current),[ye.target]),Xf(ye)&&Promise.resolve(i(ye)).then(function(Fe){if(!(ah(ye)&&!E)){var Ue=Fe.length,Ye=Ue>0&&TR({files:Fe,accept:I,minSize:s,maxSize:a,multiple:o,maxFiles:l,validator:k}),it=Ue>0&&!Ye;P({isDragAccept:Ye,isDragReject:it,isDragActive:!0,type:"setDraggedFiles"}),c&&c(ye)}}).catch(function(Fe){return K(Fe)})},[i,c,K,E,I,s,a,o,l,k]),ae=X.useCallback(function(ye){ye.preventDefault(),ye.persist(),ur(ye);var Fe=Xf(ye);if(Fe&&ye.dataTransfer)try{ye.dataTransfer.dropEffect="copy"}catch{}return Fe&&h&&h(ye),!1},[h,E]),ue=X.useCallback(function(ye){ye.preventDefault(),ye.persist(),ur(ye);var Fe=H.current.filter(function(Ye){return he.current&&he.current.contains(Ye)}),Ue=Fe.indexOf(ye.target);Ue!==-1&&Fe.splice(Ue,1),H.current=Fe,!(Fe.length>0)&&(P({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Xf(ye)&&u&&u(ye))},[he,u,E]),ce=X.useCallback(function(ye,Fe){var Ue=[],Ye=[];ye.forEach(function(it){var fr=sk(it,I),je=xp(fr,2),Et=je[0],$t=je[1],At=ok(it,s,a),tn=xp(At,2),gi=tn[0],ys=tn[1],ws=k?k(it):null;if(Et&&gi&&!ws)Ue.push(it);else{var vi=[$t,ys];ws&&(vi=vi.concat(ws)),Ye.push({file:it,errors:vi.filter(function(Es){return Es})})}}),(!o&&Ue.length>1||o&&l>=1&&Ue.length>l)&&(Ue.forEach(function(it){Ye.push({file:it,errors:[ER]})}),Ue.splice(0)),P({acceptedFiles:Ue,fileRejections:Ye,isDragReject:Ye.length>0,type:"setFiles"}),d&&d(Ue,Ye,Fe),Ye.length>0&&g&&g(Ye,Fe),Ue.length>0&&p&&p(Ue,Fe)},[P,o,I,s,a,l,d,p,g,k]),De=X.useCallback(function(ye){ye.preventDefault(),ye.persist(),ur(ye),H.current=[],Xf(ye)&&Promise.resolve(i(ye)).then(function(Fe){ah(ye)&&!E||ce(Fe,ye)}).catch(function(Fe){return K(Fe)}),P({type:"reset"})},[i,ce,K,E]),W=X.useCallback(function(){if(O.current){P({type:"openDialog"}),N();var ye={multiple:o,types:b};window.showOpenFilePicker(ye).then(function(Fe){return i(Fe)}).then(function(Fe){ce(Fe,null),P({type:"closeDialog"})}).catch(function(Fe){NR(Fe)?(F(Fe),P({type:"closeDialog"})):RR(Fe)?(O.current=!1,de.current?(de.current.value=null,de.current.click()):K(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):K(Fe)});return}de.current&&(P({type:"openDialog"}),N(),de.current.value=null,de.current.click())},[P,N,F,y,ce,K,b,o]),ct=X.useCallback(function(ye){!he.current||!he.current.isEqualNode(ye.target)||(ye.key===" "||ye.key==="Enter"||ye.keyCode===32||ye.keyCode===13)&&(ye.preventDefault(),W())},[he,W]),Ke=X.useCallback(function(){P({type:"focus"})},[]),nt=X.useCallback(function(){P({type:"blur"})},[]),Ge=X.useCallback(function(){R||(AR()?setTimeout(W,0):W())},[R,W]),Te=function(Fe){return n?null:Fe},wt=function(Fe){return j?null:Te(Fe)},nr=function(Fe){return D?null:Te(Fe)},ur=function(Fe){E&&Fe.stopPropagation()},fn=X.useMemo(function(){return function(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Fe=ye.refKey,Ue=Fe===void 0?"ref":Fe,Ye=ye.role,it=ye.onKeyDown,fr=ye.onFocus,je=ye.onBlur,Et=ye.onClick,$t=ye.onDragEnter,At=ye.onDragOver,tn=ye.onDragLeave,gi=ye.onDrop,ys=sh(ye,DR);return jt(jt(zm({onKeyDown:wt(yi(it,ct)),onFocus:wt(yi(fr,Ke)),onBlur:wt(yi(je,nt)),onClick:Te(yi(Et,Ge)),onDragEnter:nr(yi($t,ne)),onDragOver:nr(yi(At,ae)),onDragLeave:nr(yi(tn,ue)),onDrop:nr(yi(gi,De)),role:typeof Ye=="string"&&Ye!==""?Ye:"presentation"},Ue,he),!n&&!j?{tabIndex:0}:{}),ys)}},[he,ct,Ke,nt,Ge,ne,ae,ue,De,j,D,n]),ji=X.useCallback(function(ye){ye.stopPropagation()},[]),hn=X.useMemo(function(){return function(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Fe=ye.refKey,Ue=Fe===void 0?"ref":Fe,Ye=ye.onChange,it=ye.onClick,fr=sh(ye,OR),je=zm({accept:I,multiple:o,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Te(yi(Ye,De)),onClick:Te(yi(it,ji)),tabIndex:-1},Ue,de);return jt(jt({},je),fr)}},[de,r,o,De,n]);return jt(jt({},le),{},{isFocused:Q&&!n,getRootProps:fn,getInputProps:hn,rootRef:he,inputRef:de,open:Te(W)})}function HR(t,e){switch(e.type){case"focus":return jt(jt({},t),{},{isFocused:!0});case"blur":return jt(jt({},t),{},{isFocused:!1});case"openDialog":return jt(jt({},Wm),{},{isFileDialogActive:!0});case"closeDialog":return jt(jt({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":return jt(jt({},t),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return jt(jt({},t),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return jt({},Wm);default:return t}}function ty(){}/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $R={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=(t,e)=>{const r=X.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:o="",children:l,...c},u)=>X.createElement("svg",{ref:u,...$R,width:i,height:i,stroke:n,strokeWidth:s?Number(a)*24/Number(i):a,className:["lucide",`lucide-${GR(t)}`,o].join(" "),...c},[...e.map(([h,d])=>X.createElement(h,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=yt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=yt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=yt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=yt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=yt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=yt("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=yt("CloudUpload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=yt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=yt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=yt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=yt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=yt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=yt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=yt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=yt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=yt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=yt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=yt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=yt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=yt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=yt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=yt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=yt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=yt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=yt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=yt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ch={};ch.version="0.18.5";var vk=1252,s3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Cv=function(t){s3.indexOf(t)!=-1&&(vk=bv[0]=t)};function o3(){Cv(1252)}var oi=function(t){Cv(t)};function Nv(){oi(1200),o3()}function ay(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function l3(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function xk(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var xc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?l3(t.slice(2)):e==254&&r==255?xk(t.slice(2)):e==65279?t.slice(1):t},Yf=function(e){return String.fromCharCode(e)},sy=function(e){return String.fromCharCode(e)},Pa,Ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xu(t){for(var e="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),a=r>>2,n=t.charCodeAt(c++),s=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ua.charAt(a)+Ua.charAt(s)+Ua.charAt(o)+Ua.charAt(l);return e}function Mn(t){var e="",r=0,n=0,i=0,a=0,s=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=Ua.indexOf(t.charAt(c++)),s=Ua.indexOf(t.charAt(c++)),r=a<<2|s>>4,e+=String.fromCharCode(r),o=Ua.indexOf(t.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ua.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Je=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ma=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ss(t){return Je?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function oy(t){return Je?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Rn=function(e){return Je?ma(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function id(t){if(typeof ArrayBuffer>"u")return Rn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function gs(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function c3(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Rv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Rv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var yr=Je?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ma(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function u3(t){for(var e=[],r=0,n=t.length+250,i=ss(t.length+255),a=0;a<t.length;++a){var s=t.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=t.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(e.push(i.slice(0,r)),r=0,i=ss(65535),n=65530)}return e.push(i.slice(0,r)),yr(e)}var ln=/\u0000/g,_c=/[\u0001-\u0006]/g;function al(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function li(t,e){var r=""+t;return r.length>=e?r:Kt("0",e-r.length)+r}function Fv(t,e){var r=""+t;return r.length>=e?r:Kt(" ",e-r.length)+r}function uh(t,e){var r=""+t;return r.length>=e?r:r+Kt(" ",e-r.length)}function f3(t,e){var r=""+Math.round(t);return r.length>=e?r:Kt("0",e-r.length)+r}function h3(t,e){var r=""+t;return r.length>=e?r:Kt("0",e-r.length)+r}var ly=Math.pow(2,32);function Fo(t,e){if(t>ly||t<-ly)return f3(t,e);var r=Math.round(t);return h3(r,e)}function fh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var cy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d3(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Le={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},uy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},p3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function hh(t,e,r){for(var n=t<0?-1:1,i=t*n,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*s+a,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),a=s,s=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=a):(u=c,o=s)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function js(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,s=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=y3(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var _k=new Date(1899,11,31,0,0,0),m3=_k.getTime(),g3=new Date(1900,2,1,0,0,0);function yk(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=g3&&(r+=24*60*60*1e3),(r-(m3+(t.getTimezoneOffset()-_k.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Pv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function v3(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function x3(t){var e=t<0?12:11,r=Pv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function _3(t){var e=Pv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function _u(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=x3(t):e===10?r=t.toFixed(10).substr(0,12):r=_3(t),Pv(v3(r.toUpperCase()))}function Js(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):_u(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Zn(14,yk(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function y3(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function w3(t,e,r,n){var i="",a=0,s=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return _p[r.m-1][1];case 5:return _p[r.m-1][0];default:return _p[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return cy[r.q][0];default:return cy[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?li(r.S,e.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),e==="s"?a===0?"0":""+a/s:(i=li(a,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?li(l,c):"";return u}function za(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var wk=/%/g;function E3(t,e,r){var n=e.replace(wk,""),i=e.length-n.length;return ea(t,n,r*Math.pow(10,2*i))+Kt("%",i)}function T3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ea(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Ek(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ek(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Tk=/# (\?+)( ?)\/( ?)(\d+)/;function k3(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?Kt(" ",t[1].length+1+t[4].length):Fv(s,t[1].length)+t[2]+"/"+t[3]+li(o,t[4].length))}function S3(t,e,r){return r+(e===0?"":""+e)+Kt(" ",t[1].length+2+t[4].length)}var kk=/^#*0*\.([0#]+)/,Sk=/\).*[0#]/,Ak=/\(###\) ###\\?-####/;function nn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function fy(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function hy(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function A3(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function I3(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Un(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Sk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Un("n",n,r):"("+Un("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return T3(t,e,r);if(e.indexOf("%")!==-1)return E3(t,e,r);if(e.indexOf("E")!==-1)return Ek(e,r);if(e.charCodeAt(0)===36)return"$"+Un(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Fo(l,e.length);if(e.match(/^[#?]+$/))return i=Fo(r,0),i==="0"&&(i=""),i.length>e.length?i:nn(e.substr(0,e.length-i.length))+i;if(a=e.match(Tk))return k3(a,l,c);if(e.match(/^#+0+$/))return c+Fo(l,e.length-e.indexOf("0"));if(a=e.match(kk))return i=fy(r,a[1].length).replace(/^([^\.]+)$/,"$1."+nn(a[1])).replace(/\.$/,"."+nn(a[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Kt("0",nn(a[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+fy(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+za(Fo(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Un(t,e,-r):za(""+(Math.floor(r)+A3(r,a[1].length)))+"."+li(hy(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Un(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=al(Un(t,e.replace(/[\\-]/g,""),r)),s=0,al(al(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(e.match(Ak))return i=Un(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=hh(l,Math.pow(10,s)-1,!1),i=""+c,u=ea("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=uh(o[2],s),u.length<a[4].length&&(u=nn(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=hh(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fv(o[1],s)+a[2]+"/"+a[3]+uh(o[2],s):Kt(" ",2*s+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=Fo(r,0),e.length<=i.length?i:nn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=e.indexOf(".")-s,d=e.length-i.length-h;return nn(e.substr(0,h)+i+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return s=hy(r,a[1].length),r<0?"-"+Un(t,e,-r):za(I3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?li(0,3-g.length):"")+g})+"."+li(s,a[1].length);switch(e){case"###,##0.00":return Un(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=za(Fo(l,0));return p!=="0"?c+p:"";case"###,###.00":return Un(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Un(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function b3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ea(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function C3(t,e,r){var n=e.replace(wk,""),i=e.length-n.length;return ea(t,n,r*Math.pow(10,2*i))+Kt("%",i)}function Ik(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ik(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ei(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Sk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ei("n",n,r):"("+Ei("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return b3(t,e,r);if(e.indexOf("%")!==-1)return C3(t,e,r);if(e.indexOf("E")!==-1)return Ik(e,r);if(e.charCodeAt(0)===36)return"$"+Ei(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+li(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:nn(e.substr(0,e.length-i.length))+i;if(a=e.match(Tk))return S3(a,l,c);if(e.match(/^#+0+$/))return c+li(l,e.length-e.indexOf("0"));if(a=e.match(kk))return i=(""+r).replace(/^([^\.]+)$/,"$1."+nn(a[1])).replace(/\.$/,"."+nn(a[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+Kt("0",nn(a[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+za(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ei(t,e,-r):za(""+r)+"."+Kt("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Ei(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=al(Ei(t,e.replace(/[\\-]/g,""),r)),s=0,al(al(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(e.match(Ak))return i=Ei(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=hh(l,Math.pow(10,s)-1,!1),i=""+c,u=ea("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=uh(o[2],s),u.length<a[4].length&&(u=nn(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=hh(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fv(o[1],s)+a[2]+"/"+a[3]+uh(o[2],s):Kt(" ",2*s+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:nn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=e.indexOf(".")-s,d=e.length-i.length-h;return nn(e.substr(0,h)+i+e.substr(e.length-d))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ei(t,e,-r):za(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?li(0,3-g.length):"")+g})+"."+li(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=za(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return Ei(t,e.slice(0,e.lastIndexOf(".")),r)+nn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ea(t,e,r){return(r|0)===r?Ei(t,e,r):Un(t,e,r)}function N3(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var bk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":fh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(bk))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function R3(t,e,r,n){for(var i=[],a="",s=0,o="",l="t",c,u,h,d="H";s<t.length;)switch(o=t.charAt(s)){case"G":if(!fh(t,s))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(h=t.charCodeAt(++s))!==34&&s<t.length;)a+=String.fromCharCode(h);i[i.length]={t:"t",v:a},++s;break;case"\\":var p=t.charAt(++s),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:e},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(c==null&&(c=js(e,r,t.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=js(e,r),c==null))return"";for(a=o;++s<t.length&&t.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=js(e,r)),t.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",s+=5,d="h"):t.substr(s,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",s+=5,d="h"):(m.t="t",++s),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(a=o;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(bk)){if(c==null&&(c=js(e,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",jl(t)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<t.length&&(o=t.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},l=o;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)a+=t.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++s;break}var _=0,y=0,T;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=d,l="h",_<1&&(_=1);break;case"s":(T=i[s].v.match(/\.0+$/))&&(y=Math.max(y,T[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[s].v.match(/[Hh]/)&&(_=1),_<2&&i[s].v.match(/[Mm]/)&&(_=2),_<3&&i[s].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",R;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=w3(i[s].t.charCodeAt(0),i[s].v,c,y),i[s].t="t";break;case"n":case"?":for(R=s+1;i[R]!=null&&((o=i[R].t)==="?"||o==="D"||(o===" "||o==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[s].v+=i[R].v,i[R]={v:"",t:";"},++R;w+=i[s].v,s=R-1;break;case"G":i[s].t="t",i[s].v=Js(e,r);break}var j="",D,E;if(w.length>0){w.charCodeAt(0)==40?(D=e<0&&w.charCodeAt(0)===45?-e:e,E=ea("n",w,D)):(D=e<0&&n>1?-e:e,E=ea("n",w,D),D<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),R=E.length-1;var S=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){S=s;break}var k=i.length;if(S===i.length&&E.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(R>=i[s].v.length-1?(R-=i[s].v.length,i[s].v=E.substr(R+1,i[s].v.length)):R<0?i[s].v="":(i[s].v=E.substr(0,R+1),R=-1),i[s].t="t",k=s);R>=0&&k<i.length&&(i[k].v=E.substr(0,R+1)+i[k].v)}else if(S!==i.length&&E.indexOf("E")===-1){for(R=E.indexOf(".")-1,s=S;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===S?i[s].v.indexOf(".")-1:i[s].v.length-1,j=i[s].v.substr(u+1);u>=0;--u)R>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(j=E.charAt(R--)+j);i[s].v=j,i[s].t="t",k=s}for(R>=0&&k<i.length&&(i[k].v=E.substr(0,R+1)+i[k].v),R=E.indexOf(".")+1,s=S;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==S)){for(u=i[s].v.indexOf(".")>-1&&s===S?i[s].v.indexOf(".")+1:0,j=i[s].v.substr(0,u);u<i[s].v.length;++u)R<E.length&&(j+=E.charAt(R++));i[s].v=j,i[s].t="t",k=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(D=n>1&&e<0&&s>0&&i[s-1].v==="-"?-e:e,i[s].v=ea(i[s].t,i[s].v,D),i[s].t="t");var I="";for(s=0;s!==i.length;++s)i[s]!=null&&(I+=i[s].v);return I}var dy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function py(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function F3(t,e){var r=N3(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(dy),o=r[1].match(dy);return py(e,s)?[n,r[0]]:py(e,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Zn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Le)[t],n==null&&(n=r.table&&r.table[uy[t]]||Le[uy[t]]),n==null&&(n=p3[t]||"General");break}if(fh(n,0))return Js(e,r);e instanceof Date&&(e=yk(e,r.date1904));var i=F3(n,e);if(fh(i[1]))return Js(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return R3(i[1],e,r,i[0])}function ta(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Le[r]==null){e<0&&(e=r);continue}if(Le[r]==t){e=r;break}}e<0&&(e=391)}return Le[e]=t,e}function ad(t){for(var e=0;e!=392;++e)t[e]!==void 0&&ta(t[e],e)}function Bl(){Le=d3()}var P3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ck=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function D3(t){var e=typeof t=="number"?Le[t]:t;return e=e.replace(Ck,"(\\d+)"),new RegExp("^"+e+"$")}function O3(t,e,r){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(e.match(Ck)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":s=p;break;case"s":l=p;break;case"m":s>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&a==-1?u:c+"T"+u}var L3=function(){var t={};t.version="1.2.0";function e(){for(var E=0,S=new Array(256),k=0;k!=256;++k)E=k,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,S[k]=E;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(E){var S=0,k=0,I=0,b=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)b[I]=E[I];for(I=0;I!=256;++I)for(k=E[I],S=256+I;S<4096;S+=256)k=b[S]=k>>>8^E[k&255];var N=[];for(I=1;I!=16;++I)N[I-1]=typeof Int32Array<"u"?b.subarray(I*256,I*256+256):b.slice(I*256,I*256+256);return N}var i=n(r),a=i[0],s=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],p=i[8],g=i[9],m=i[10],_=i[11],y=i[12],T=i[13],w=i[14];function R(E,S){for(var k=S^-1,I=0,b=E.length;I<b;)k=k>>>8^r[(k^E.charCodeAt(I++))&255];return~k}function j(E,S){for(var k=S^-1,I=E.length-15,b=0;b<I;)k=w[E[b++]^k&255]^T[E[b++]^k>>8&255]^y[E[b++]^k>>16&255]^_[E[b++]^k>>>24]^m[E[b++]]^g[E[b++]]^p[E[b++]]^d[E[b++]]^h[E[b++]]^u[E[b++]]^c[E[b++]]^l[E[b++]]^o[E[b++]]^s[E[b++]]^a[E[b++]]^r[E[b++]];for(I+=15;b<I;)k=k>>>8^r[(k^E[b++])&255];return~k}function D(E,S){for(var k=S^-1,I=0,b=E.length,N=0,F=0;I<b;)N=E.charCodeAt(I++),N<128?k=k>>>8^r[(k^N)&255]:N<2048?(k=k>>>8^r[(k^(192|N>>6&31))&255],k=k>>>8^r[(k^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,F=E.charCodeAt(I++)&1023,k=k>>>8^r[(k^(240|N>>8&7))&255],k=k>>>8^r[(k^(128|N>>2&63))&255],k=k>>>8^r[(k^(128|F>>6&15|(N&3)<<4))&255],k=k>>>8^r[(k^(128|F&63))&255]):(k=k>>>8^r[(k^(224|N>>12&15))&255],k=k>>>8^r[(k^(128|N>>6&63))&255],k=k>>>8^r[(k^(128|N&63))&255]);return~k}return t.table=r,t.bstr=R,t.buf=j,t.str=D,t}(),Pe=function(){var e={};e.version="1.2.1";function r(C,V){for(var M=C.split("/"),B=V.split("/"),U=0,z=0,J=Math.min(M.length,B.length);U<J;++U){if(z=M[U].length-B[U].length)return z;if(M[U]!=B[U])return M[U]<B[U]?-1:1}return M.length-B.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var V=C.lastIndexOf("/");return V===-1?C:C.slice(0,V+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var V=C.lastIndexOf("/");return V===-1?C:C.slice(V+1)}function a(C,V){typeof V=="string"&&(V=new Date(V));var M=V.getHours();M=M<<6|V.getMinutes(),M=M<<5|V.getSeconds()>>>1,C.write_shift(2,M);var B=V.getFullYear()-1980;B=B<<4|V.getMonth()+1,B=B<<5|V.getDate(),C.write_shift(2,B)}function s(C){var V=C.read_shift(2)&65535,M=C.read_shift(2)&65535,B=new Date,U=M&31;M>>>=5;var z=M&15;M>>>=4,B.setMilliseconds(0),B.setFullYear(M+1980),B.setMonth(z-1),B.setDate(U);var J=V&31;V>>>=5;var se=V&63;return V>>>=6,B.setHours(V),B.setMinutes(se),B.setSeconds(J<<1),B}function o(C){Cr(C,0);for(var V={},M=0;C.l<=C.length-4;){var B=C.read_shift(2),U=C.read_shift(2),z=C.l+U,J={};switch(B){case 21589:M=C.read_shift(1),M&1&&(J.mtime=C.read_shift(4)),U>5&&(M&2&&(J.atime=C.read_shift(4)),M&4&&(J.ctime=C.read_shift(4))),J.mtime&&(J.mt=new Date(J.mtime*1e3));break}C.l=z,V[B]=J}return V}var l;function c(){return l||(l={})}function u(C,V){if(C[0]==80&&C[1]==75)return Kl(C,V);if((C[0]|32)==109&&(C[1]|32)==105)return _f(C,V);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var M=3,B=512,U=0,z=0,J=0,se=0,Z=0,ee=[],te=C.slice(0,512);Cr(te,0);var ge=h(te);switch(M=ge[0],M){case 3:B=512;break;case 4:B=4096;break;case 0:if(ge[1]==0)return Kl(C,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}B!==512&&(te=C.slice(0,B),Cr(te,28));var ke=C.slice(0,B);d(te,M);var be=te.read_shift(4,"i");if(M===3&&be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+be);te.l+=4,J=te.read_shift(4,"i"),te.l+=4,te.chk("00100000","Mini Stream Cutoff Size: "),se=te.read_shift(4,"i"),U=te.read_shift(4,"i"),Z=te.read_shift(4,"i"),z=te.read_shift(4,"i");for(var _e=-1,Ie=0;Ie<109&&(_e=te.read_shift(4,"i"),!(_e<0));++Ie)ee[Ie]=_e;var ze=p(C,B);_(Z,z,ze,B,ee);var Tt=T(ze,J,ee,B);Tt[J].name="!Directory",U>0&&se!==F&&(Tt[se].name="!MiniFAT"),Tt[ee[0]].name="!FAT",Tt.fat_addrs=ee,Tt.ssz=B;var dt={},Ot=[],Ui=[],As=[];w(J,Tt,ze,Ot,U,dt,Ui,se),g(Ui,As,Ot),Ot.shift();var Ea={FileIndex:Ui,FullPaths:As};return V&&V.raw&&(Ea.raw={header:ke,sectors:ze}),Ea}function h(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(he,"Header Signature: "),C.l+=16;var V=C.read_shift(2,"u");return[C.read_shift(2,"u"),V]}function d(C,V){var M=9;switch(C.l+=2,M=C.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function p(C,V){for(var M=Math.ceil(C.length/V)-1,B=[],U=1;U<M;++U)B[U-1]=C.slice(U*V,(U+1)*V);return B[M-1]=C.slice(M*V),B}function g(C,V,M){for(var B=0,U=0,z=0,J=0,se=0,Z=M.length,ee=[],te=[];B<Z;++B)ee[B]=te[B]=B,V[B]=M[B];for(;se<te.length;++se)B=te[se],U=C[B].L,z=C[B].R,J=C[B].C,ee[B]===B&&(U!==-1&&ee[U]!==U&&(ee[B]=ee[U]),z!==-1&&ee[z]!==z&&(ee[B]=ee[z])),J!==-1&&(ee[J]=B),U!==-1&&B!=ee[B]&&(ee[U]=ee[B],te.lastIndexOf(U)<se&&te.push(U)),z!==-1&&B!=ee[B]&&(ee[z]=ee[B],te.lastIndexOf(z)<se&&te.push(z));for(B=1;B<Z;++B)ee[B]===B&&(z!==-1&&ee[z]!==z?ee[B]=ee[z]:U!==-1&&ee[U]!==U&&(ee[B]=ee[U]));for(B=1;B<Z;++B)if(C[B].type!==0){if(se=B,se!=ee[se])do se=ee[se],V[B]=V[se]+"/"+V[B];while(se!==0&&ee[se]!==-1&&se!=ee[se]);ee[B]=-1}for(V[0]+="/",B=1;B<Z;++B)C[B].type!==2&&(V[B]+="/")}function m(C,V,M){for(var B=C.start,U=C.size,z=[],J=B;M&&U>0&&J>=0;)z.push(V.slice(J*N,J*N+N)),U-=N,J=Ps(M,J*4);return z.length===0?oe(0):yr(z).slice(0,C.size)}function _(C,V,M,B,U){var z=F;if(C===F){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var J=M[C],se=(B>>>2)-1;if(!J)return;for(var Z=0;Z<se&&(z=Ps(J,Z*4))!==F;++Z)U.push(z);_(Ps(J,B-4),V-1,M,B,U)}}function y(C,V,M,B,U){var z=[],J=[];U||(U=[]);var se=B-1,Z=0,ee=0;for(Z=V;Z>=0;){U[Z]=!0,z[z.length]=Z,J.push(C[Z]);var te=M[Math.floor(Z*4/B)];if(ee=Z*4&se,B<4+ee)throw new Error("FAT boundary crossed: "+Z+" 4 "+B);if(!C[te])break;Z=Ps(C[te],ee)}return{nodes:z,data:Ay([J])}}function T(C,V,M,B){var U=C.length,z=[],J=[],se=[],Z=[],ee=B-1,te=0,ge=0,ke=0,be=0;for(te=0;te<U;++te)if(se=[],ke=te+V,ke>=U&&(ke-=U),!J[ke]){Z=[];var _e=[];for(ge=ke;ge>=0;){_e[ge]=!0,J[ge]=!0,se[se.length]=ge,Z.push(C[ge]);var Ie=M[Math.floor(ge*4/B)];if(be=ge*4&ee,B<4+be)throw new Error("FAT boundary crossed: "+ge+" 4 "+B);if(!C[Ie]||(ge=Ps(C[Ie],be),_e[ge]))break}z[ke]={nodes:se,data:Ay([Z])}}return z}function w(C,V,M,B,U,z,J,se){for(var Z=0,ee=B.length?2:0,te=V[C].data,ge=0,ke=0,be;ge<te.length;ge+=128){var _e=te.slice(ge,ge+128);Cr(_e,64),ke=_e.read_shift(2),be=Vv(_e,0,ke-ee),B.push(be);var Ie={name:be,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},ze=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);ze!==0&&(Ie.ct=R(_e,_e.l-8));var Tt=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Tt!==0&&(Ie.mt=R(_e,_e.l-8)),Ie.start=_e.read_shift(4,"i"),Ie.size=_e.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=F,Ie.name=""),Ie.type===5?(Z=Ie.start,U>0&&Z!==F&&(V[Z].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",V[Ie.start]===void 0&&(V[Ie.start]=y(M,Ie.start,V.fat_addrs,V.ssz)),V[Ie.start].name=Ie.name,Ie.content=V[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:Z!==F&&Ie.start!==F&&V[Z]&&(Ie.content=m(Ie,V[Z].data,(V[se]||{}).data))),Ie.content&&Cr(Ie.content,0),z[be]=Ie,J.push(Ie)}}function R(C,V){return new Date((Nn(C,V+4)/1e7*Math.pow(2,32)+Nn(C,V)/1e7-11644473600)*1e3)}function j(C,V){return c(),u(l.readFileSync(C),V)}function D(C,V){var M=V&&V.type;switch(M||Je&&Buffer.isBuffer(C)&&(M="buffer"),M||"base64"){case"file":return j(C,V);case"base64":return u(Rn(Mn(C)),V);case"binary":return u(Rn(C),V)}return u(C,V)}function E(C,V){var M=V||{},B=M.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=B+"/",C.FileIndex[0]={name:B,type:5}),M.CLSID&&(C.FileIndex[0].clsid=M.CLSID),S(C)}function S(C){var V="Sh33tJ5";if(!Pe.find(C,"/"+V)){var M=oe(4);M[0]=55,M[1]=M[3]=50,M[2]=54,C.FileIndex.push({name:V,type:2,content:M,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+V),k(C)}}function k(C,V){E(C);for(var M=!1,B=!1,U=C.FullPaths.length-1;U>=0;--U){var z=C.FileIndex[U];switch(z.type){case 0:B?M=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(z.R*z.L*z.C)&&(M=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!V)){var J=new Date(1987,1,19),se=0,Z=Object.create?Object.create(null):{},ee=[];for(U=0;U<C.FullPaths.length;++U)Z[C.FullPaths[U]]=!0,C.FileIndex[U].type!==0&&ee.push([C.FullPaths[U],C.FileIndex[U]]);for(U=0;U<ee.length;++U){var te=n(ee[U][0]);B=Z[te],B||(ee.push([te,{name:i(te).replace("/",""),type:1,clsid:Ae,ct:J,mt:J,content:null}]),Z[te]=!0)}for(ee.sort(function(be,_e){return r(be[0],_e[0])}),C.FullPaths=[],C.FileIndex=[],U=0;U<ee.length;++U)C.FullPaths[U]=ee[U][0],C.FileIndex[U]=ee[U][1];for(U=0;U<ee.length;++U){var ge=C.FileIndex[U],ke=C.FullPaths[U];if(ge.name=i(ke).replace("/",""),ge.L=ge.R=ge.C=-(ge.color=1),ge.size=ge.content?ge.content.length:0,ge.start=0,ge.clsid=ge.clsid||Ae,U===0)ge.C=ee.length>1?1:-1,ge.size=0,ge.type=5;else if(ke.slice(-1)=="/"){for(se=U+1;se<ee.length&&n(C.FullPaths[se])!=ke;++se);for(ge.C=se>=ee.length?-1:se,se=U+1;se<ee.length&&n(C.FullPaths[se])!=n(ke);++se);ge.R=se>=ee.length?-1:se,ge.type=1}else n(C.FullPaths[U+1]||"")==n(ke)&&(ge.R=U+1),ge.type=2}}}function I(C,V){var M=V||{};if(M.fileType=="mad")return Tr(C,M);switch(k(C),M.fileType){case"zip":return Xl(C,M)}var B=function(be){for(var _e=0,Ie=0,ze=0;ze<be.FileIndex.length;++ze){var Tt=be.FileIndex[ze];if(Tt.content){var dt=Tt.content.length;dt>0&&(dt<4096?_e+=dt+63>>6:Ie+=dt+511>>9)}}for(var Ot=be.FullPaths.length+3>>2,Ui=_e+7>>3,As=_e+127>>7,Ea=Ui+Ie+Ot+As,xi=Ea+127>>7,Io=xi<=109?0:Math.ceil((xi-109)/127);Ea+xi+Io+127>>7>xi;)Io=++xi<=109?0:Math.ceil((xi-109)/127);var An=[1,Io,xi,As,Ot,Ie,_e,0];return be.FileIndex[0].size=_e<<6,An[7]=(be.FileIndex[0].start=An[0]+An[1]+An[2]+An[3]+An[4]+An[5])+(An[6]+7>>3),An}(C),U=oe(B[7]<<9),z=0,J=0;{for(z=0;z<8;++z)U.write_shift(1,de[z]);for(z=0;z<8;++z)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),z=0;z<3;++z)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,B[2]),U.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:F),U.write_shift(4,B[3]),U.write_shift(-4,B[1]?B[0]-1:F),U.write_shift(4,B[1]),z=0;z<109;++z)U.write_shift(-4,z<B[2]?B[1]+z:-1)}if(B[1])for(J=0;J<B[1];++J){for(;z<236+J*127;++z)U.write_shift(-4,z<B[2]?B[1]+z:-1);U.write_shift(-4,J===B[1]-1?F:J+1)}var se=function(be){for(J+=be;z<J-1;++z)U.write_shift(-4,z+1);be&&(++z,U.write_shift(-4,F))};for(J=z=0,J+=B[1];z<J;++z)U.write_shift(-4,ve.DIFSECT);for(J+=B[2];z<J;++z)U.write_shift(-4,ve.FATSECT);se(B[3]),se(B[4]);for(var Z=0,ee=0,te=C.FileIndex[0];Z<C.FileIndex.length;++Z)te=C.FileIndex[Z],te.content&&(ee=te.content.length,!(ee<4096)&&(te.start=J,se(ee+511>>9)));for(se(B[6]+7>>3);U.l&511;)U.write_shift(-4,ve.ENDOFCHAIN);for(J=z=0,Z=0;Z<C.FileIndex.length;++Z)te=C.FileIndex[Z],te.content&&(ee=te.content.length,!(!ee||ee>=4096)&&(te.start=J,se(ee+63>>6)));for(;U.l&511;)U.write_shift(-4,ve.ENDOFCHAIN);for(z=0;z<B[4]<<2;++z){var ge=C.FullPaths[z];if(!ge||ge.length===0){for(Z=0;Z<17;++Z)U.write_shift(4,0);for(Z=0;Z<3;++Z)U.write_shift(4,-1);for(Z=0;Z<12;++Z)U.write_shift(4,0);continue}te=C.FileIndex[z],z===0&&(te.start=te.size?te.start-1:F);var ke=z===0&&M.root||te.name;if(ee=2*(ke.length+1),U.write_shift(64,ke,"utf16le"),U.write_shift(2,ee),U.write_shift(1,te.type),U.write_shift(1,te.color),U.write_shift(-4,te.L),U.write_shift(-4,te.R),U.write_shift(-4,te.C),te.clsid)U.write_shift(16,te.clsid,"hex");else for(Z=0;Z<4;++Z)U.write_shift(4,0);U.write_shift(4,te.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,te.start),U.write_shift(4,te.size),U.write_shift(4,0)}for(z=1;z<C.FileIndex.length;++z)if(te=C.FileIndex[z],te.size>=4096)if(U.l=te.start+1<<9,Je&&Buffer.isBuffer(te.content))te.content.copy(U,U.l,0,te.size),U.l+=te.size+511&-512;else{for(Z=0;Z<te.size;++Z)U.write_shift(1,te.content[Z]);for(;Z&511;++Z)U.write_shift(1,0)}for(z=1;z<C.FileIndex.length;++z)if(te=C.FileIndex[z],te.size>0&&te.size<4096)if(Je&&Buffer.isBuffer(te.content))te.content.copy(U,U.l,0,te.size),U.l+=te.size+63&-64;else{for(Z=0;Z<te.size;++Z)U.write_shift(1,te.content[Z]);for(;Z&63;++Z)U.write_shift(1,0)}if(Je)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function b(C,V){var M=C.FullPaths.map(function(Z){return Z.toUpperCase()}),B=M.map(function(Z){var ee=Z.split("/");return ee[ee.length-(Z.slice(-1)=="/"?2:1)]}),U=!1;V.charCodeAt(0)===47?(U=!0,V=M[0].slice(0,-1)+V):U=V.indexOf("/")!==-1;var z=V.toUpperCase(),J=U===!0?M.indexOf(z):B.indexOf(z);if(J!==-1)return C.FileIndex[J];var se=!z.match(_c);for(z=z.replace(ln,""),se&&(z=z.replace(_c,"!")),J=0;J<M.length;++J)if((se?M[J].replace(_c,"!"):M[J]).replace(ln,"")==z||(se?B[J].replace(_c,"!"):B[J]).replace(ln,"")==z)return C.FileIndex[J];return null}var N=64,F=-2,he="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",ve={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(C,V,M){c();var B=I(C,M);l.writeFileSync(V,B)}function P(C){for(var V=new Array(C.length),M=0;M<C.length;++M)V[M]=String.fromCharCode(C[M]);return V.join("")}function Q(C,V){var M=I(C,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,M),M;case"binary":return typeof M=="string"?M:P(M);case"base64":return xu(typeof M=="string"?M:P(M));case"buffer":if(Je)return Buffer.isBuffer(M)?M:ma(M);case"array":return typeof M=="string"?Rn(M):M}return M}var re;function O(C){try{var V=C.InflateRaw,M=new V;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)re=C;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function q(C,V){if(!re)return vi(C,V);var M=re.InflateRaw,B=new M,U=B._processChunk(C.slice(C.l),B._finishFlushFlag);return C.l+=B.bytesRead,U}function H(C){return re?re.deflateRawSync(C):je(C)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(C){var V=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(V>>16|V>>8|V)&255}for(var ue=typeof Uint8Array<"u",ce=ue?new Uint8Array(256):[],De=0;De<256;++De)ce[De]=ae(De);function W(C,V){var M=ce[C&255];return V<=8?M>>>8-V:(M=M<<8|ce[C>>8&255],V<=16?M>>>16-V:(M=M<<8|ce[C>>16&255],M>>>24-V))}function ct(C,V){var M=V&7,B=V>>>3;return(C[B]|(M<=6?0:C[B+1]<<8))>>>M&3}function Ke(C,V){var M=V&7,B=V>>>3;return(C[B]|(M<=5?0:C[B+1]<<8))>>>M&7}function nt(C,V){var M=V&7,B=V>>>3;return(C[B]|(M<=4?0:C[B+1]<<8))>>>M&15}function Ge(C,V){var M=V&7,B=V>>>3;return(C[B]|(M<=3?0:C[B+1]<<8))>>>M&31}function Te(C,V){var M=V&7,B=V>>>3;return(C[B]|(M<=1?0:C[B+1]<<8))>>>M&127}function wt(C,V,M){var B=V&7,U=V>>>3,z=(1<<M)-1,J=C[U]>>>B;return M<8-B||(J|=C[U+1]<<8-B,M<16-B)||(J|=C[U+2]<<16-B,M<24-B)||(J|=C[U+3]<<24-B),J&z}function nr(C,V,M){var B=V&7,U=V>>>3;return B<=5?C[U]|=(M&7)<<B:(C[U]|=M<<B&255,C[U+1]=(M&7)>>8-B),V+3}function ur(C,V,M){var B=V&7,U=V>>>3;return M=(M&1)<<B,C[U]|=M,V+1}function fn(C,V,M){var B=V&7,U=V>>>3;return M<<=B,C[U]|=M&255,M>>>=8,C[U+1]=M,V+8}function ji(C,V,M){var B=V&7,U=V>>>3;return M<<=B,C[U]|=M&255,M>>>=8,C[U+1]=M&255,C[U+2]=M>>>8,V+16}function hn(C,V){var M=C.length,B=2*M>V?2*M:V+5,U=0;if(M>=V)return C;if(Je){var z=oy(B);if(C.copy)C.copy(z);else for(;U<C.length;++U)z[U]=C[U];return z}else if(ue){var J=new Uint8Array(B);if(J.set)J.set(C);else for(;U<M;++U)J[U]=C[U];return J}return C.length=B,C}function ye(C){for(var V=new Array(C),M=0;M<C;++M)V[M]=0;return V}function Fe(C,V,M){var B=1,U=0,z=0,J=0,se=0,Z=C.length,ee=ue?new Uint16Array(32):ye(32);for(z=0;z<32;++z)ee[z]=0;for(z=Z;z<M;++z)C[z]=0;Z=C.length;var te=ue?new Uint16Array(Z):ye(Z);for(z=0;z<Z;++z)ee[U=C[z]]++,B<U&&(B=U),te[z]=0;for(ee[0]=0,z=1;z<=B;++z)ee[z+16]=se=se+ee[z-1]<<1;for(z=0;z<Z;++z)se=C[z],se!=0&&(te[z]=ee[se+16]++);var ge=0;for(z=0;z<Z;++z)if(ge=C[z],ge!=0)for(se=W(te[z],B)>>B-ge,J=(1<<B+4-ge)-1;J>=0;--J)V[se|J<<ge]=ge&15|z<<4;return B}var Ue=ue?new Uint16Array(512):ye(512),Ye=ue?new Uint16Array(32):ye(32);if(!ue){for(var it=0;it<512;++it)Ue[it]=0;for(it=0;it<32;++it)Ye[it]=0}(function(){for(var C=[],V=0;V<32;V++)C.push(5);Fe(C,Ye,32);var M=[];for(V=0;V<=143;V++)M.push(8);for(;V<=255;V++)M.push(9);for(;V<=279;V++)M.push(7);for(;V<=287;V++)M.push(8);Fe(M,Ue,288)})();var fr=function(){for(var V=ue?new Uint8Array(32768):[],M=0,B=0;M<ne.length-1;++M)for(;B<ne[M+1];++B)V[B]=M;for(;B<32768;++B)V[B]=29;var U=ue?new Uint8Array(259):[];for(M=0,B=0;M<K.length-1;++M)for(;B<K[M+1];++B)U[B]=M;function z(se,Z){for(var ee=0;ee<se.length;){var te=Math.min(65535,se.length-ee),ge=ee+te==se.length;for(Z.write_shift(1,+ge),Z.write_shift(2,te),Z.write_shift(2,~te&65535);te-- >0;)Z[Z.l++]=se[ee++]}return Z.l}function J(se,Z){for(var ee=0,te=0,ge=ue?new Uint16Array(32768):[];te<se.length;){var ke=Math.min(65535,se.length-te);if(ke<10){for(ee=nr(Z,ee,+(te+ke==se.length)),ee&7&&(ee+=8-(ee&7)),Z.l=ee/8|0,Z.write_shift(2,ke),Z.write_shift(2,~ke&65535);ke-- >0;)Z[Z.l++]=se[te++];ee=Z.l*8;continue}ee=nr(Z,ee,+(te+ke==se.length)+2);for(var be=0;ke-- >0;){var _e=se[te];be=(be<<5^_e)&32767;var Ie=-1,ze=0;if((Ie=ge[be])&&(Ie|=te&-32768,Ie>te&&(Ie-=32768),Ie<te))for(;se[Ie+ze]==se[te+ze]&&ze<250;)++ze;if(ze>2){_e=U[ze],_e<=22?ee=fn(Z,ee,ce[_e+1]>>1)-1:(fn(Z,ee,3),ee+=5,fn(Z,ee,ce[_e-23]>>5),ee+=3);var Tt=_e<8?0:_e-4>>2;Tt>0&&(ji(Z,ee,ze-K[_e]),ee+=Tt),_e=V[te-Ie],ee=fn(Z,ee,ce[_e]>>3),ee-=3;var dt=_e<4?0:_e-2>>1;dt>0&&(ji(Z,ee,te-Ie-ne[_e]),ee+=dt);for(var Ot=0;Ot<ze;++Ot)ge[be]=te&32767,be=(be<<5^se[te])&32767,++te;ke-=ze-1}else _e<=143?_e=_e+48:ee=ur(Z,ee,1),ee=fn(Z,ee,ce[_e]),ge[be]=te&32767,++te}ee=fn(Z,ee,0)-1}return Z.l=(ee+7)/8|0,Z.l}return function(Z,ee){return Z.length<8?z(Z,ee):J(Z,ee)}}();function je(C){var V=oe(50+Math.floor(C.length*1.1)),M=fr(C,V);return V.slice(0,M)}var Et=ue?new Uint16Array(32768):ye(32768),$t=ue?new Uint16Array(32768):ye(32768),At=ue?new Uint16Array(128):ye(128),tn=1,gi=1;function ys(C,V){var M=Ge(C,V)+257;V+=5;var B=Ge(C,V)+1;V+=5;var U=nt(C,V)+4;V+=4;for(var z=0,J=ue?new Uint8Array(19):ye(19),se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,ee=ue?new Uint8Array(8):ye(8),te=ue?new Uint8Array(8):ye(8),ge=J.length,ke=0;ke<U;++ke)J[G[ke]]=z=Ke(C,V),Z<z&&(Z=z),ee[z]++,V+=3;var be=0;for(ee[0]=0,ke=1;ke<=Z;++ke)te[ke]=be=be+ee[ke-1]<<1;for(ke=0;ke<ge;++ke)(be=J[ke])!=0&&(se[ke]=te[be]++);var _e=0;for(ke=0;ke<ge;++ke)if(_e=J[ke],_e!=0){be=ce[se[ke]]>>8-_e;for(var Ie=(1<<7-_e)-1;Ie>=0;--Ie)At[be|Ie<<_e]=_e&7|ke<<3}var ze=[];for(Z=1;ze.length<M+B;)switch(be=At[Te(C,V)],V+=be&7,be>>>=3){case 16:for(z=3+ct(C,V),V+=2,be=ze[ze.length-1];z-- >0;)ze.push(be);break;case 17:for(z=3+Ke(C,V),V+=3;z-- >0;)ze.push(0);break;case 18:for(z=11+Te(C,V),V+=7;z-- >0;)ze.push(0);break;default:ze.push(be),Z<be&&(Z=be);break}var Tt=ze.slice(0,M),dt=ze.slice(M);for(ke=M;ke<286;++ke)Tt[ke]=0;for(ke=B;ke<30;++ke)dt[ke]=0;return tn=Fe(Tt,Et,286),gi=Fe(dt,$t,30),V}function ws(C,V){if(C[0]==3&&!(C[1]&3))return[ss(V),2];for(var M=0,B=0,U=oy(V||1<<18),z=0,J=U.length>>>0,se=0,Z=0;!(B&1);){if(B=Ke(C,M),M+=3,B>>>1)B>>1==1?(se=9,Z=5):(M=ys(C,M),se=tn,Z=gi);else{M&7&&(M+=8-(M&7));var ee=C[M>>>3]|C[(M>>>3)+1]<<8;if(M+=32,ee>0)for(!V&&J<z+ee&&(U=hn(U,z+ee),J=U.length);ee-- >0;)U[z++]=C[M>>>3],M+=8;continue}for(;;){!V&&J<z+32767&&(U=hn(U,z+32767),J=U.length);var te=wt(C,M,se),ge=B>>>1==1?Ue[te]:Et[te];if(M+=ge&15,ge>>>=4,!(ge>>>8&255))U[z++]=ge;else{if(ge==256)break;ge-=257;var ke=ge<8?0:ge-4>>2;ke>5&&(ke=0);var be=z+K[ge];ke>0&&(be+=wt(C,M,ke),M+=ke),te=wt(C,M,Z),ge=B>>>1==1?Ye[te]:$t[te],M+=ge&15,ge>>>=4;var _e=ge<4?0:ge-2>>1,Ie=ne[ge];for(_e>0&&(Ie+=wt(C,M,_e),M+=_e),!V&&J<be&&(U=hn(U,be+100),J=U.length);z<be;)U[z]=U[z-Ie],++z}}}return V?[U,M+7>>>3]:[U.slice(0,z),M+7>>>3]}function vi(C,V){var M=C.slice(C.l||0),B=ws(M,V);return C.l+=B[1],B[0]}function Es(C,V){if(C)typeof console<"u"&&console.error(V);else throw new Error(V)}function Kl(C,V){var M=C;Cr(M,0);var B=[],U=[],z={FileIndex:B,FullPaths:U};E(z,{root:V.root});for(var J=M.length-4;(M[J]!=80||M[J+1]!=75||M[J+2]!=5||M[J+3]!=6)&&J>=0;)--J;M.l=J+4,M.l+=4;var se=M.read_shift(2);M.l+=6;var Z=M.read_shift(4);for(M.l=Z,J=0;J<se;++J){M.l+=20;var ee=M.read_shift(4),te=M.read_shift(4),ge=M.read_shift(2),ke=M.read_shift(2),be=M.read_shift(2);M.l+=8;var _e=M.read_shift(4),Ie=o(M.slice(M.l+ge,M.l+ge+ke));M.l+=ge+ke+be;var ze=M.l;M.l=_e+4,Ts(M,ee,te,z,Ie),M.l=ze}return z}function Ts(C,V,M,B,U){C.l+=2;var z=C.read_shift(2),J=C.read_shift(2),se=s(C);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var Z=C.read_shift(4),ee=C.read_shift(4),te=C.read_shift(4),ge=C.read_shift(2),ke=C.read_shift(2),be="",_e=0;_e<ge;++_e)be+=String.fromCharCode(C[C.l++]);if(ke){var Ie=o(C.slice(C.l,C.l+ke));(Ie[21589]||{}).mt&&(se=Ie[21589].mt),((U||{})[21589]||{}).mt&&(se=U[21589].mt)}C.l+=ke;var ze=C.slice(C.l,C.l+ee);switch(J){case 8:ze=q(C,te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+J)}var Tt=!1;z&8&&(Z=C.read_shift(4),Z==134695760&&(Z=C.read_shift(4),Tt=!0),ee=C.read_shift(4),te=C.read_shift(4)),ee!=V&&Es(Tt,"Bad compressed size: "+V+" != "+ee),te!=M&&Es(Tt,"Bad uncompressed size: "+M+" != "+te),Vi(B,be,ze,{unsafe:!0,mt:se})}function Xl(C,V){var M=V||{},B=[],U=[],z=oe(1),J=M.compression?8:0,se=0,Z=0,ee=0,te=0,ge=0,ke=C.FullPaths[0],be=ke,_e=C.FileIndex[0],Ie=[],ze=0;for(Z=1;Z<C.FullPaths.length;++Z)if(be=C.FullPaths[Z].slice(ke.length),_e=C.FileIndex[Z],!(!_e.size||!_e.content||be=="Sh33tJ5")){var Tt=te,dt=oe(be.length);for(ee=0;ee<be.length;++ee)dt.write_shift(1,be.charCodeAt(ee)&127);dt=dt.slice(0,dt.l),Ie[ge]=L3.buf(_e.content,0);var Ot=_e.content;J==8&&(Ot=H(Ot)),z=oe(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,se),z.write_shift(2,J),_e.mt?a(z,_e.mt):z.write_shift(4,0),z.write_shift(-4,Ie[ge]),z.write_shift(4,Ot.length),z.write_shift(4,_e.content.length),z.write_shift(2,dt.length),z.write_shift(2,0),te+=z.length,B.push(z),te+=dt.length,B.push(dt),te+=Ot.length,B.push(Ot),z=oe(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,se),z.write_shift(2,J),z.write_shift(4,0),z.write_shift(-4,Ie[ge]),z.write_shift(4,Ot.length),z.write_shift(4,_e.content.length),z.write_shift(2,dt.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Tt),ze+=z.l,U.push(z),ze+=dt.length,U.push(dt),++ge}return z=oe(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,ge),z.write_shift(2,ge),z.write_shift(4,ze),z.write_shift(4,te),z.write_shift(2,0),yr([yr(B),yr(U),z])}var wa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Bi(C,V){if(C.ctype)return C.ctype;var M=C.name||"",B=M.match(/\.([^\.]+)$/);return B&&wa[B[1]]||V&&(B=(M=V).match(/[\.\\]([^\.\\])+$/),B&&wa[B[1]])?wa[B[1]]:"application/octet-stream"}function vf(C){for(var V=xu(C),M=[],B=0;B<V.length;B+=76)M.push(V.slice(B,B+76));return M.join(`\r
`)+`\r
`}function Ao(C){var V=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var te=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(te.length==1?"0"+te:te)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],B=V.split(`\r
`),U=0;U<B.length;++U){var z=B[U];if(z.length==0){M.push("");continue}for(var J=0;J<z.length;){var se=76,Z=z.slice(J,J+se);Z.charAt(se-1)=="="?se--:Z.charAt(se-2)=="="?se-=2:Z.charAt(se-3)=="="&&(se-=3),Z=z.slice(J,J+se),J+=se,J<z.length&&(Z+="="),M.push(Z)}}return M.join(`\r
`)}function xf(C){for(var V=[],M=0;M<C.length;++M){for(var B=C[M];M<=C.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+C[++M];V.push(B)}for(var U=0;U<V.length;++U)V[U]=V[U].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Rn(V.join(`\r
`))}function ks(C,V,M){for(var B="",U="",z="",J,se=0;se<10;++se){var Z=V[se];if(!Z||Z.match(/^\s*$/))break;var ee=Z.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":B=ee[2].trim();break;case"content-type":z=ee[2].trim();break;case"content-transfer-encoding":U=ee[2].trim();break}}switch(++se,U.toLowerCase()){case"base64":J=Rn(Mn(V.slice(se).join("")));break;case"quoted-printable":J=xf(V.slice(se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var te=Vi(C,B.slice(M.length),J,{unsafe:!0});z&&(te.ctype=z)}function _f(C,V){if(P(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=V&&V.root||"",B=(Je&&Buffer.isBuffer(C)?C.toString("binary"):P(C)).split(`\r
`),U=0,z="";for(U=0;U<B.length;++U)if(z=B[U],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),M||(M=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),z.slice(0,M.length)!=M););var J=(B[1]||"").match(/boundary="(.*?)"/);if(!J)throw new Error("MAD cannot find boundary");var se="--"+(J[1]||""),Z=[],ee=[],te={FileIndex:Z,FullPaths:ee};E(te);var ge,ke=0;for(U=0;U<B.length;++U){var be=B[U];be!==se&&be!==se+"--"||(ke++&&ks(te,B.slice(ge,U),M),ge=U)}return te}function Tr(C,V){var M=V||{},B=M.boundary||"SheetJS";B="------="+B;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],z=C.FullPaths[0],J=z,se=C.FileIndex[0],Z=1;Z<C.FullPaths.length;++Z)if(J=C.FullPaths[Z].slice(z.length),se=C.FileIndex[Z],!(!se.size||!se.content||J=="Sh33tJ5")){J=J.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ze){return"_x"+ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ze){return"_u"+ze.charCodeAt(0).toString(16)+"_"});for(var ee=se.content,te=Je&&Buffer.isBuffer(ee)?ee.toString("binary"):P(ee),ge=0,ke=Math.min(1024,te.length),be=0,_e=0;_e<=ke;++_e)(be=te.charCodeAt(_e))>=32&&be<128&&++ge;var Ie=ge>=ke*4/5;U.push(B),U.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+J),U.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),U.push("Content-Type: "+Bi(se,J)),U.push(""),U.push(Ie?Ao(te):vf(te))}return U.push(B+`--\r
`),U.join(`\r
`)}function yf(C){var V={};return E(V,C),V}function Vi(C,V,M,B){var U=B&&B.unsafe;U||E(C);var z=!U&&Pe.find(C,V);if(!z){var J=C.FullPaths[0];V.slice(0,J.length)==J?J=V:(J.slice(-1)!="/"&&(J+="/"),J=(J+V).replace("//","/")),z={name:i(V),type:2},C.FileIndex.push(z),C.FullPaths.push(J),U||Pe.utils.cfb_gc(C)}return z.content=M,z.size=M?M.length:0,B&&(B.CLSID&&(z.clsid=B.CLSID),B.mt&&(z.mt=B.mt),B.ct&&(z.ct=B.ct)),z}function Ss(C,V){E(C);var M=Pe.find(C,V);if(M){for(var B=0;B<C.FileIndex.length;++B)if(C.FileIndex[B]==M)return C.FileIndex.splice(B,1),C.FullPaths.splice(B,1),!0}return!1}function Md(C,V,M){E(C);var B=Pe.find(C,V);if(B){for(var U=0;U<C.FileIndex.length;++U)if(C.FileIndex[U]==B)return C.FileIndex[U].name=i(M),C.FullPaths[U]=M,!0}return!1}function jd(C){k(C,!0)}return e.find=b,e.read=D,e.parse=u,e.write=Q,e.writeFile=le,e.utils={cfb_new:yf,cfb_add:Vi,cfb_del:Ss,cfb_mov:Md,cfb_gc:jd,ReadShift:Mc,CheckField:Qk,prep_blob:Cr,bconcat:yr,use_zlib:O,_deflateRaw:je,_inflateRaw:vi,consts:ve},e}();function M3(t){return typeof t=="string"?id(t):Array.isArray(t)?c3(t):t}function Gu(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=id(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ai(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([M3(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=t,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=gs(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function j3(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Yt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function my(t,e){for(var r=[],n=Yt(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function sd(t){for(var e=[],r=Yt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function od(t){for(var e=[],r=Yt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function B3(t){for(var e=[],r=Yt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var dh=new Date(1899,11,30,0,0,0);function gr(t,e){var r=t.getTime(),n=dh.getTime()+(t.getTimezoneOffset()-dh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Nk=new Date,V3=dh.getTime()+(Nk.getTimezoneOffset()-dh.getTimezoneOffset())*6e4,gy=Nk.getTimezoneOffset();function ld(t){var e=new Date;return e.setTime(t*24*60*60*1e3+V3),e.getTimezoneOffset()!==gy&&e.setTime(e.getTime()+(e.getTimezoneOffset()-gy)*6e4),e}function U3(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[a],10)}return e}var vy=new Date("2017-02-19T19:06:09.000Z"),Rk=isNaN(vy.getFullYear())?new Date("2/19/17"):vy,z3=Rk.getFullYear()==2017;function Pt(t,e){var r=new Date(t);if(z3)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Rk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Zs(t,e){if(Je&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ai(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ai(xk(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ai(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ai(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Dt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Dt(t[r]));return e}function Kt(t,e){for(var r="";r.length<e;)r+=t;return r}function fi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var W3=["january","february","march","april","may","june","july","august","september","october","november","december"];function kl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&W3.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var H3=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function Fk(t){return t?t.content&&t.type?Zs(t.content,!0):t.data?xc(t.data):t.asNodeBuffer&&Je?xc(t.asNodeBuffer().toString("binary")):t.asBinary?xc(t.asBinary()):t._data&&t._data.getContent?xc(Zs(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Pk(t){if(!t)return null;if(t.data)return ay(t.data);if(t.asNodeBuffer&&Je)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?ay(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function $3(t){return t&&t.name.slice(-4)===".bin"?Pk(t):Fk(t)}function Hn(t,e){for(var r=t.FullPaths||Yt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function Dv(t,e){var r=Hn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function sr(t,e,r){if(!r)return $3(Dv(t,e));if(!e)return null;try{return sr(t,e)}catch{return null}}function Fn(t,e,r){if(!r)return Fk(Dv(t,e));if(!e)return null;try{return Fn(t,e)}catch{return null}}function G3(t,e,r){return Pk(Dv(t,e))}function xy(t){for(var e=t.FullPaths||Yt(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Xe(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Je?n=ma(r):n=u3(r),Pe.utils.cfb_add(t,e,n)}Pe.utils.cfb_add(t,e,r)}else t.file(e,r)}function Ov(){return Pe.utils.cfb_new()}function Dk(t,e){switch(e.type){case"base64":return Pe.read(t,{type:"base64"});case"binary":return Pe.read(t,{type:"binary"});case"buffer":case"array":return Pe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function yc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var rr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,q3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_y=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,K3=/<[^>]*>/g,en=rr.match(_y)?_y:K3,X3=/<\w*:/,Y3=/<(\/?)\w+:/;function Be(t,e,r){for(var n={},i=0,a=0;i!==t.length&&!((a=t.charCodeAt(i))===32||a===10||a===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var s=t.match(q3),o=0,l="",c=0,u="",h="",d=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(u=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(d=(i=h.charCodeAt(a+1))==34||i==39?1:0,l=h.slice(a+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Li(t){return t.replace(Y3,"<$1")}var Ok={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lv=sd(Ok),ot=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(t,function(o,l){return Ok[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),Mv=/[&<>'"]/g,Q3=/[\u0000-\u0008\u000b-\u001f]/g;function gt(t){var e=t+"";return e.replace(Mv,function(r){return Lv[r]}).replace(Q3,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function yy(t){return gt(t).replace(/ /g,"_x0020_")}var Lk=/[\u0000-\u001f]/g;function jv(t){var e=t+"";return e.replace(Mv,function(r){return Lv[r]}).replace(/\n/g,"<br/>").replace(Lk,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function J3(t){var e=t+"";return e.replace(Mv,function(r){return Lv[r]}).replace(Lk,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var wy=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Z3(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Nt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yp(t){for(var e="",r=0,n=0,i=0,a=0,s=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,e+=String.fromCharCode(s);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Ey(t){var e=ss(2*t.length),r,n,i=1,a=0,s=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(e[a++]=s&255,e[a++]=s>>>8,s=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function Ty(t){return ma(t,"binary").toString("utf8")}var Qf="foo bar baz",_t=Je&&(Ty(Qf)==yp(Qf)&&Ty||Ey(Qf)==yp(Qf)&&Ey)||yp,Ai=Je?function(t){return ma(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},yu=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Mk=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),eF=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),tF=/<\/?(?:vt:)?variant>/g,rF=/<(?:vt:)([^>]*)>([\s\S]*)</;function ky(t,e){var r=Be(t),n=t.match(eF(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(tF,"").match(rF);s&&i.push({v:_t(s[2]),t:s[1]})}),i}var jk=/(^\s|\s$|\n)/;function Nr(t,e){return"<"+t+(e.match(jk)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function wu(t){return Yt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function we(t,e,r){return"<"+t+(r!=null?wu(r):"")+(e!=null?(e.match(jk)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Hm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function nF(t,e){switch(typeof t){case"string":var r=we("vt:lpwstr",gt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return we((t|0)==t?"vt:i4":"vt:r8",gt(String(t)));case"boolean":return we("vt:bool",t?"true":"false")}if(t instanceof Date)return we("vt:filetime",Hm(t));throw new Error("Unable to serialize "+t)}function Bv(t){if(Je&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return _t(gs(Rv(t)));throw new Error("Bad input format: expected Buffer or string")}var Eu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,dr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},po=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Cn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function iF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,a=5;a>=0;--a)i=i*256+t[e+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function aF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,s=n?-e:e;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(i&15)<<4|a&15,t[r+7]=i>>4|n}var Sy=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Ay=Je?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ma(e)})):Sy(t)}:Sy,Iy=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Xi(t,i)));return n.join("").replace(ln,"")},Vv=Je?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ln,""):Iy(t,e,r)}:Iy,by=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Bk=Je?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):by(t,e,r)}:by,Cy=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Oo(t,i)));return n.join("")},qu=Je?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Cy(e,r,n)}:Cy,Vk=function(t,e){var r=Nn(t,e);return r>0?qu(t,e+4,e+4+r-1):""},Uk=Vk,zk=function(t,e){var r=Nn(t,e);return r>0?qu(t,e+4,e+4+r-1):""},Wk=zk,Hk=function(t,e){var r=2*Nn(t,e);return r>0?qu(t,e+4,e+4+r-1):""},$k=Hk,Gk=function(e,r){var n=Nn(e,r);return n>0?Vv(e,r+4,r+4+n):""},qk=Gk,Kk=function(t,e){var r=Nn(t,e);return r>0?qu(t,e+4,e+4+r):""},Xk=Kk,Yk=function(t,e){return iF(t,e)},ph=Yk,Uv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Je&&(Uk=function(e,r){if(!Buffer.isBuffer(e))return Vk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Wk=function(e,r){if(!Buffer.isBuffer(e))return zk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},$k=function(e,r){if(!Buffer.isBuffer(e))return Hk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},qk=function(e,r){if(!Buffer.isBuffer(e))return Gk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Xk=function(e,r){if(!Buffer.isBuffer(e))return Kk(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ph=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Yk(e,r)},Uv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Oo=function(t,e){return t[e]},Xi=function(t,e){return t[e+1]*256+t[e]},sF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Nn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ps=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},oF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Mc(t,e){var r="",n,i,a=[],s,o,l,c;switch(e){case"dbcs":if(c=this.l,Je&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Xi(this,c)),c+=2;t*=2;break;case"utf8":r=qu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Vv(this,this.l,this.l+t);break;case"wstr":return Mc.call(this,t,"dbcs");case"lpstr-ansi":r=Uk(this,this.l),t=4+Nn(this,this.l);break;case"lpstr-cp":r=Wk(this,this.l),t=4+Nn(this,this.l);break;case"lpwstr":r=$k(this,this.l),t=4+2*Nn(this,this.l);break;case"lpp4":t=4+Nn(this,this.l),r=qk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Nn(this,this.l),r=Xk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(s=Oo(this,this.l+t++))!==0;)a.push(Yf(s));r=a.join("");break;case"_wstr":for(t=0,r="";(s=Xi(this,this.l+t))!==0;)a.push(Yf(s)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Oo(this,c),this.l=c+1,o=Mc.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Yf(Xi(this,c))),c+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Oo(this,c),this.l=c+1,o=Mc.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Yf(Oo(this,c))),c+=1}r=a.join("");break;default:switch(t){case 1:return n=Oo(this,this.l),this.l++,n;case 2:return n=(e==="i"?sF:Xi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Ps:oF)(this,this.l),this.l+=4,n):(i=Nn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=ph(this,this.l):i=ph([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Bk(this,this.l,t);break}}return this.l+=t,r}var lF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},cF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},uF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function fF(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)uF(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var s=e.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,lF(this,e,this.l);break;case 8:if(n=8,r==="f"){aF(this,e,this.l);break}case 16:break;case-4:n=4,cF(this,e,this.l);break}return this.l+=n,this}function Qk(t,e){var r=Bk(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Cr(t,e){t.l=e,t.read_shift=Mc,t.chk=Qk,t.write_shift=fF}function Jr(t,e){t.l+=e}function oe(t){var e=ss(t);return Cr(e,0),e}function ga(t,e,r){if(t){var n,i,a;Cr(t,t.l||0);for(var s=t.length,o=0,l=0;t.l<s;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=bu[o]||bu[65535];for(n=t.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=t.read_shift(1))&127)<<7*i;l=t.l+a;var u=c.f&&c.f(t,a,r);if(t.l=l,e(u,c,o))return}}}function wn(){var t=[],e=Je?256:2048,r=function(c){var u=oe(c);return Cr(u,0),u},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},s=function(){return i(),yr(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:s,_bufs:t}}function pe(t,e,r,n){var i=+e,a;if(!isNaN(i)){n||(n=bu[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=t.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Uv(r)&&t.push(r)}}function jc(t,e,r){var n=Dt(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ny(t,e,r){var n=Dt(t);return n.s=jc(n.s,e.s,r),n.e=jc(n.e,e.s,r),n}function Bc(t,e){if(t.cRel&&t.c<0)for(t=Dt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Dt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Me(t);return!t.cRel&&t.cRel!=null&&(r=pF(r)),!t.rRel&&t.rRel!=null&&(r=hF(r)),r}function wp(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Vt(t.s.c)+":"+(t.e.cRel?"":"$")+Vt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+er(t.s.r)+":"+(t.e.rRel?"":"$")+er(t.e.r):Bc(t.s,e.biff)+":"+Bc(t.e,e.biff)}function zv(t){return parseInt(dF(t),10)-1}function er(t){return""+(t+1)}function hF(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dF(t){return t.replace(/\$(\d+)$/,"$1")}function Wv(t){for(var e=mF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Vt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function pF(t){return t.replace(/^([A-Z])/,"$$$1")}function mF(t){return t.replace(/^\$([A-Z])/,"$1")}function gF(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ut(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Me(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function kn(t){var e=t.indexOf(":");return e==-1?{s:Ut(t),e:Ut(t)}:{s:Ut(t.slice(0,e)),e:Ut(t.slice(e+1))}}function qe(t,e){return typeof e>"u"||typeof e=="number"?qe(t.s,t.e):(typeof t!="string"&&(t=Me(t)),typeof e!="string"&&(e=Me(e)),t==e?t:t+":"+e)}function lt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=t.length;for(r=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Ry(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Zn(t.z,r?gr(e):e)}catch{}try{return t.w=Zn((t.XF||{}).numFmtId||(r?14:0),r?gr(e):e)}catch{return""+e}}function ca(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?va[t.v]||t.v:e==null?Ry(t,t.v):Ry(t,e))}function vs(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Jk(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,a=t||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Ut(n.origin):n.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=lt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var p={v:e[h][d]},g=s+h,m=o+d;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))p=e[h][d];else if(Array.isArray(p.v)&&(p.f=e[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Le[14],n.cellDates?(p.t="d",p.w=Zn(p.z,gr(p.v))):(p.t="n",p.v=gr(p.v),p.w=Zn(p.z,p.v))):p.t="s";if(i)a[g]||(a[g]=[]),a[g][m]&&a[g][m].z&&(p.z=a[g][m].z),a[g][m]=p;else{var _=Me({c:m,r:g});a[_]&&a[_].z&&(p.z=a[_].z),a[_]=p}}}return c.s.c<1e7&&(a["!ref"]=qe(c)),a}function Vl(t,e){return Jk(null,t,e)}function vF(t){return t.read_shift(4,"i")}function hi(t,e){return e||(e=oe(4)),e.write_shift(4,t),e}function Yr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function wr(t,e){var r=!1;return e==null&&(r=!0,e=oe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function xF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function _F(t,e){return e||(e=oe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Hv(t,e){var r=t.l,n=t.read_shift(1),i=Yr(t),a=[],s={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(xF(t));s.r=a}else s.r=[{ich:0,ifnt:0}];return t.l=r+e,s}function yF(t,e){var r=!1;return e==null&&(r=!0,e=oe(15+4*t.t.length)),e.write_shift(1,0),wr(t.t,e),r?e.slice(0,e.l):e}var wF=Hv;function EF(t,e){var r=!1;return e==null&&(r=!0,e=oe(23+4*t.t.length)),e.write_shift(1,1),wr(t.t,e),e.write_shift(4,1),_F({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function ei(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function mo(t,e){return e==null&&(e=oe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function go(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function vo(t,e){return e==null&&(e=oe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var TF=Yr,Zk=wr;function $v(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function mh(t,e){var r=!1;return e==null&&(r=!0,e=oe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var kF=Yr,$m=$v,Gv=mh;function qv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?ph([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ps(e,0)>>2;return r?i/100:i}function eS(t,e){e==null&&(e=oe(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function tS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function SF(t,e){return e||(e=oe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var xo=tS,Ul=SF;function Xr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function eo(t,e){return(e||oe(8)).write_shift(8,t,"f")}function AF(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=zs[i];c&&(e.rgb=ku(c));break;case 2:e.rgb=ku([s,o,l]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function gh(t,e){if(e||(e=oe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function IF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function bF(t,e){e||(e=oe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function rS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function CF(t){return rS(t,1)}function NF(t){return rS(t,2)}var Kv=2,dn=3,Jf=11,Fy=12,vh=19,Zf=64,RF=65,FF=71,PF=4108,DF=4126,vr=80,nS=81,OF=[vr,nS],Gm={1:{n:"CodePage",t:Kv},2:{n:"Category",t:vr},3:{n:"PresentationFormat",t:vr},4:{n:"ByteCount",t:dn},5:{n:"LineCount",t:dn},6:{n:"ParagraphCount",t:dn},7:{n:"SlideCount",t:dn},8:{n:"NoteCount",t:dn},9:{n:"HiddenCount",t:dn},10:{n:"MultimediaClipCount",t:dn},11:{n:"ScaleCrop",t:Jf},12:{n:"HeadingPairs",t:PF},13:{n:"TitlesOfParts",t:DF},14:{n:"Manager",t:vr},15:{n:"Company",t:vr},16:{n:"LinksUpToDate",t:Jf},17:{n:"CharacterCount",t:dn},19:{n:"SharedDoc",t:Jf},22:{n:"HyperlinksChanged",t:Jf},23:{n:"AppVersion",t:dn,p:"version"},24:{n:"DigSig",t:RF},26:{n:"ContentType",t:vr},27:{n:"ContentStatus",t:vr},28:{n:"Language",t:vr},29:{n:"Version",t:vr},255:{},2147483648:{n:"Locale",t:vh},2147483651:{n:"Behavior",t:vh},1919054434:{}},qm={1:{n:"CodePage",t:Kv},2:{n:"Title",t:vr},3:{n:"Subject",t:vr},4:{n:"Author",t:vr},5:{n:"Keywords",t:vr},6:{n:"Comments",t:vr},7:{n:"Template",t:vr},8:{n:"LastAuthor",t:vr},9:{n:"RevNumber",t:vr},10:{n:"EditTime",t:Zf},11:{n:"LastPrinted",t:Zf},12:{n:"CreatedDate",t:Zf},13:{n:"ModifiedDate",t:Zf},14:{n:"PageCount",t:dn},15:{n:"WordCount",t:dn},16:{n:"CharCount",t:dn},17:{n:"Thumbnail",t:FF},18:{n:"Application",t:vr},19:{n:"DocSecurity",t:dn},255:{},2147483648:{n:"Locale",t:vh},2147483651:{n:"Behavior",t:vh},1919054434:{}},Py={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},LF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function MF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var jF=MF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zs=Dt(jF),va={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},iS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Km={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},e0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Xv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function BF(t){var e=Xv();if(!t||!t.match)return e;var r={};if((t.match(en)||[]).forEach(function(n){var i=Be(n);switch(i[0].replace(X3,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Km[i.ContentType]]!==void 0&&e[Km[i.ContentType]].push(i.PartName);break}}),e.xmlns!==dr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function aS(t,e){var r=B3(Km),n=[],i;n[n.length]=rr,n[n.length]=we("Types",null,{xmlns:dr.CT,"xmlns:xsd":dr.xsd,"xmlns:xsi":dr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return we("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=we("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:e0[l][e.bookType]||e0[l].xlsx}))},s=function(l){(t[l]||[]).forEach(function(c){n[n.length]=we("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:e0[l][e.bookType]||e0[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=we("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ze={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tu(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Vc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(en)||[]).forEach(function(i){var a=Be(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:yc(a.Target,e);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}function sl(t){var e=[rr,we("Relationships",null,{xmlns:dr.RELS})];return Yt(t["!id"]).forEach(function(r){e[e.length]=we("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function mt(t,e,r,n,i,a){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Ze.HLINK,Ze.XPATH,Ze.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var VF="application/vnd.oasis.opendocument.spreadsheet";function UF(t,e){for(var r=Bv(t),n,i;n=Eu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Be(n[0],!1),i.path=="/"&&i.type!==VF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function zF(t){var e=[rr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Dy(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function WF(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function HF(t){var e=[rr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Dy(t[r][0],t[r][1])),e.push(WF("",t[r][0]));return e.push(Dy("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function sS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ch.version+"</meta:generator></office:meta></office:document-meta>"}var Yn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],$F=function(){for(var t=new Array(Yn.length),e=0;e<Yn.length;++e){var r=Yn[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function oS(t){var e={};t=_t(t);for(var r=0;r<Yn.length;++r){var n=Yn[r],i=t.match($F[r]);i!=null&&i.length>0&&(e[n[1]]=ot(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Pt(e[n[1]]))}return e}function Ep(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=gt(e),n[n.length]=r?we(t,e,r):Nr(t,e))}function lS(t,e){var r=e||{},n=[rr,we("cp:coreProperties",null,{"xmlns:cp":dr.CORE_PROPS,"xmlns:dc":dr.dc,"xmlns:dcterms":dr.dcterms,"xmlns:dcmitype":dr.dcmitype,"xmlns:xsi":dr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Ep("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Hm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Ep("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Hm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=Yn.length;++a){var s=Yn[a],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:t?t[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ep(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ws=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function uS(t,e,r,n){var i=[];if(typeof t=="string")i=ky(t,n);else for(var a=0;a<t.length;++a)i=i.concat(t[a].map(function(u){return{v:u}}));var s=typeof e=="string"?ky(e,n).map(function(u){return u.v}):e,o=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function GF(t,e,r){var n={};return e||(e={}),t=_t(t),Ws.forEach(function(i){var a=(t.match(yu(i[0]))||[])[1];switch(i[2]){case"string":a&&(e[i[1]]=ot(a));break;case"bool":e[i[1]]=a==="true";break;case"raw":var s=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&uS(n.HeadingPairs,n.TitlesOfParts,e,r),e}function fS(t){var e=[],r=we;return t||(t={}),t.Application="SheetJS",e[e.length]=rr,e[e.length]=we("Properties",null,{xmlns:dr.EXT_PROPS,"xmlns:vt":dr.vt}),Ws.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=gt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+gt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var qF=/<[^>]+>[^<]*/g;function KF(t,e){var r={},n="",i=t.match(qF);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=Be(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ot(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ot(u);break;case"bool":r[n]=Nt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Pt(u);break;case"cy":case"error":r[n]=ot(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(e.WTF)throw new Error(s)}}}return r}function hS(t){var e=[rr,we("Properties",null,{xmlns:dr.CUST_PROPS,"xmlns:vt":dr.vt})];if(!t)return e.join("");var r=1;return Yt(t).forEach(function(i){++r,e[e.length]=we("property",nF(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:gt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Xm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tp;function XF(t,e,r){Tp||(Tp=sd(Xm)),e=Tp[e]||e,t[e]=r}function YF(t,e){var r=[];return Yt(Xm).map(function(n){for(var i=0;i<Yn.length;++i)if(Yn[i][1]==n)return Yn[i];for(i=0;i<Ws.length;++i)if(Ws[i][1]==n)return Ws[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Nr(Xm[n[1]]||n[1],i))}}),we("DocumentProperties",r.join(""),{xmlns:Cn.o})}function QF(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Yt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var s=0;s<Yn.length;++s)if(a==Yn[s][1])return;for(s=0;s<Ws.length;++s)if(a==Ws[s][1])return;for(s=0;s<r.length;++s)if(a==r[s])return;var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(we(yy(a),o,{"dt:dt":l}))}}),e&&Yt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var s=e[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),i.push(we(yy(a),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Cn.o+'">'+i.join("")+"</"+n+">"}function Yv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function JF(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=oe(8);return s.write_shift(4,n),s.write_shift(4,i),s}function dS(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function pS(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function mS(t,e,r){return e===31?pS(t):dS(t,e,r)}function Ym(t,e,r){return mS(t,e,r===!1?0:4)}function ZF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return mS(t,e,0)}function eP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ln,""),t.l-i&2&&(t.l+=2)}return r}function tP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ln,"");return r}function rP(t){var e=t.l,r=xh(t,nS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=xh(t,dn);return[r,n]}function nP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(rP(t));return r}function Oy(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var a=t.read_shift(4),s=t.read_shift(4);n[a]=t.read_shift(s,e===1200?"utf16le":"utf8").replace(ln,"").replace(_c,"!"),e===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function gS(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function iP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function xh(t,e,r){var n=t.read_shift(2),i,a=r||{};if(t.l+=2,e!==Fy&&n!==e&&OF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Fy?n:e){case 2:return i=t.read_shift(2,"i"),a.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return dS(t,n,4).replace(ln,"");case 31:return pS(t);case 64:return Yv(t);case 65:return gS(t);case 71:return iP(t);case 80:return Ym(t,n,!a.raw).replace(ln,"");case 81:return ZF(t,n).replace(ln,"");case 4108:return nP(t);case 4126:case 4127:return n==4127?eP(t):tP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Ly(t,e){var r=oe(4),n=oe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=oe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=JF(e);break;case 31:case 80:for(n=oe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return yr([r,n])}function My(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),a=[],s=0,o=0,l=-1,c={};for(s=0;s!=i;++s){var u=t.read_shift(4),h=t.read_shift(4);a[s]=[u,h+r]}a.sort(function(T,w){return T[1]-w[1]});var d={};for(s=0;s!=i;++s){if(t.l!==a[s][1]){var p=!0;if(s>0&&e)switch(e[a[s-1][0]].t){case 2:t.l+2===a[s][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[s][1]&&(t.l=a[s][1],p=!1);break;case 4108:t.l<=a[s][1]&&(t.l=a[s][1],p=!1);break}if((!e||s==0)&&t.l<=a[s][1]&&(p=!1,t.l=a[s][1]),p)throw new Error("Read Error: Expected address "+a[s][1]+" at "+t.l+" :"+s)}if(e){var g=e[a[s][0]];if(d[g.n]=xh(t,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:oi(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(a[s][0]===1){if(o=d.CodePage=xh(t,Kv),oi(o),l!==-1){var m=t.l;t.l=a[l][1],c=Oy(t,o),t.l=m}}else if(a[s][0]===0){if(o===0){l=s,t.l=a[s+1][1];continue}c=Oy(t,o)}else{var _=c[a[s][0]],y;switch(t[t.l]){case 65:t.l+=4,y=gS(t);break;case 30:t.l+=4,y=Ym(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,y=Ym(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,y=t.read_shift(4,"i");break;case 19:t.l+=4,y=t.read_shift(4);break;case 5:t.l+=4,y=t.read_shift(8,"f");break;case 11:t.l+=4,y=Qt(t,4);break;case 64:t.l+=4,y=Pt(Yv(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[_]=y}}return t.l=r+n,d}var vS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function aP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function jy(t,e,r){var n=oe(8),i=[],a=[],s=8,o=0,l=oe(8),c=oe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),i.push(c),s+=8+l.length,!e){c=oe(8),c.write_shift(4,0),i.unshift(c);var u=[oe(4)];for(u[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=oe(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=yr(u),a.unshift(l),s+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(vS.indexOf(t[o][0])>-1||cS.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],p=0;if(e){p=+e[t[o][0]];var g=r[p];if(g.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=Ly(g.t,d)}else{var _=aP(d);_==-1&&(_=31,d=String(d)),l=Ly(_,d)}a.push(l),c=oe(8),c.write_shift(4,e?p:2+o),i.push(c),s+=8+l.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,y),y+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),yr([n].concat(i).concat(a))}function By(t,e,r){var n=t.content;if(!n)return{};Cr(n,0);var i,a,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Pe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),l=n.read_shift(4));var h=My(n,e),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=a,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=My(n,null)}catch{}for(p in g)d[p]=g[p];return d.FMTID=[a,s],d}function Vy(t,e,r,n,i,a){var s=oe(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Pe.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,e,"hex"),s.write_shift(4,i?68:48);var l=jy(t,r,n);if(o.push(l),i){var c=jy(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(c)}return yr(o)}function Aa(t,e){return t.read_shift(e),null}function sP(t,e){e||(e=oe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function oP(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Qt(t,e){return t.read_shift(e)===1}function an(t,e){return e||(e=oe(2)),e.write_shift(2,+!!t),e}function or(t){return t.read_shift(2,"u")}function $n(t,e){return e||(e=oe(2)),e.write_shift(2,t),e}function xS(t,e){return oP(t,e,or)}function lP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function _S(t,e,r){return r||(r=oe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Ku(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?t.read_shift(n,i):"";return s}function cP(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,l={};i&&(s=t.read_shift(2)),n&&(o=t.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*s),n&&(t.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function uP(t){var e=t.t||"",r=oe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=oe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return yr(i)}function to(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Xu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):to(t,n,r)}function _o(t,e,r){if(r.biff>5)return Xu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function yS(t,e,r){return r||(r=oe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function fP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function hP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ln,"");return n&&(t.l+=24),i}function dP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(a>>1,"utf16le").replace(ln,"");return r+s}function pP(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return hP(t);case"0303000000000000c000000000000046":return dP(t);default:throw new Error("Unsupported Moniker "+r)}}function t0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ln,""):"";return r}function Uy(t,e){e||(e=oe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function mP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var a,s,o,l,c="",u,h;i&16&&(a=t0(t,r-t.l)),i&128&&(s=t0(t,r-t.l)),(i&257)===257&&(o=t0(t,r-t.l)),(i&257)===1&&(l=pP(t,r-t.l)),i&8&&(c=t0(t,r-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(h=Yv(t)),t.l=r;var d=s||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return u&&(p.guid=u),h&&(p.time=h),a&&(p.Tooltip=a),p}function gP(t){var e=oe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)e.write_shift(4,s[r]);if(a==28)n=n.slice(1),Uy(n,e);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)e.write_shift(1,parseInt(s[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),a&8&&Uy(i>-1?n.slice(i+1):"",e)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)e.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function wS(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function ES(t,e){var r=wS(t);return r[3]=0,r}function Mi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ro(t,e,r,n){return n||(n=oe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function vP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function xP(t,e,r){return e===0?"":_o(t,e,r)}function _P(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),s=t.read_shift(n,"i");return[i,a,s]}function TS(t){var e=t.read_shift(2),r=qv(t);return[e,r]}function yP(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Ku(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,i}function cd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function kS(t,e){return e||(e=oe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function SS(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var wP=SS;function AS(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function EP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function TP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Vr(t){t.l+=2,t.l+=t.read_shift(2)}var kP={0:Vr,4:Vr,5:Vr,6:Vr,7:TP,8:Vr,9:Vr,10:Vr,11:Vr,12:Vr,13:EP,14:Vr,15:Vr,16:Vr,17:Vr,18:Vr,19:Vr,20:Vr,21:AS};function SP(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(kP[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function r0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Qv(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=oe(i);return a.write_shift(2,n),a.write_shift(2,e),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function AP(t,e){return e===0||t.read_shift(2),1200}function IP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=_o(t,0,r);return t.read_shift(e+n-t.l),i}function bP(t,e){var r=!e||e.biff==8,n=oe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function CP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function NP(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=Ku(t,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function RP(t,e){var r=!e||e.biff>=8?2:1,n=oe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function FP(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),a=[],s=0;s!=i&&t.l<r;++s)a.push(cP(t));return a.Count=n,a.Unique=i,a}function PP(t,e){var r=oe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=uP(t[i]);var a=yr([r].concat(n));return a.parts=[r.length].concat(n.map(function(s){return s.length})),a}function DP(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function OP(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function LP(t){var e=vP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function MP(t){return t.read_shift(2),t.read_shift(4)}function zy(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function jP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function BP(){var t=oe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function VP(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function UP(t){var e=oe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function zP(){}function WP(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Ku(t,0,r),n}function HP(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,a=oe(i);return a.write_shift(2,(t.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function $P(t){var e=Mi(t);return e.isst=t.read_shift(4),e}function GP(t,e,r,n){var i=oe(10);return ro(t,e,n,i),i.write_shift(4,r),i}function qP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Mi(t);r.biff==2&&t.l++;var a=Xu(t,n-t.l,r);return i.val=a,i}function KP(t,e,r,n,i){var a=!i||i.biff==8,s=oe(8+ +a+(1+a)*r.length);return ro(t,e,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function XP(t,e,r){var n=t.read_shift(2),i=_o(t,0,r);return[n,i]}function YP(t,e,r,n){var i=r&&r.biff==5;n||(n=oe(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var QP=_o;function Wy(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,a=t.read_shift(i),s=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:s,c:l}}}function JP(t,e){var r=e.biff==8||!e.biff?4:2,n=oe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function ZP(t){var e=t.read_shift(2),r=t.read_shift(2),n=TS(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function eD(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(TS(t));if(t.l!==r)throw new Error("MulRK read error");var s=t.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function tD(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var s=t.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function rD(t,e,r,n){var i={},a=t.read_shift(4),s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=LF[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function nD(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=rD(t,e,n.fStyle,r),n}function Hy(t,e,r,n){var i=r&&r.biff==5;n||(n=oe(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function iD(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function aD(t){var e=oe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function $y(t,e,r){var n=Mi(t);(r.biff==2||e==9)&&++t.l;var i=lP(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function sD(t,e,r,n,i,a){var s=oe(8);return ro(t,e,n,s),_S(r,a,s),s}function oD(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Mi(t),i=Xr(t);return n.val=i,n}function lD(t,e,r,n){var i=oe(14);return ro(t,e,n,i),eo(r,i),i}var Gy=xP;function cD(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=to(t,a),o=[];n>t.l;)o.push(Xu(t));return[a,i,s,o]}function qy(t,e,r){var n=t.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=yP(t,e-2,r)),a.body=i||t.read_shift(e-2),typeof i=="string"&&(a.Name=i),a}var uD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ky(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(1),s=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=to(t,s,r);i&32&&(c=uD[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||o===0||!(u>0)?[]:SL(t,u,r,o);return{chKey:a,Name:c,itab:l,rgce:h}}function IS(t,e,r){if(r.biff<8)return fD(t,e,r);for(var n=[],i=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(_P(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function fD(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Ku(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function hD(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),a=to(t,n,r),s=to(t,i,r);return[a,s]}function dD(t,e,r){var n=SS(t);t.l++;var i=t.read_shift(1);return e-=8,[AL(t,e,r),i,n]}function Xy(t,e,r){var n=wP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,TL(t,e,r)]}function pD(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function mD(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=_o(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,s,a]}}function gD(t,e,r){return mD(t,e,r)}function vD(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(cd(t));return r}function xD(t){var e=oe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)kS(t[r],e);return e}function _D(t,e,r){if(r&&r.biff<8)return wD(t,e,r);var n=AS(t),i=SP(t,e-22,n[1]);return{cmo:n,ft:i}}var yD={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function wD(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var s=[];return s.push((yD[n]||Jr)(t,e,r)),{cmo:[i,n,a],ft:s}}function ED(t,e,r){var n=t.l,i="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:s=fP(t,6,r);var o=t.read_shift(2);t.read_shift(2),or(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=to(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function TD(t,e){var r=cd(t);t.l+=16;var n=mP(t,e-24);return[r,n]}function kD(t){var e=oe(24),r=Ut(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return yr([e,gP(t[1])])}function SD(t,e){t.read_shift(2);var r=cd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ln,""),[r,n]}function AD(t){var e=t[1].Tooltip,r=oe(10+2*(e.length+1));r.write_shift(2,2048);var n=Ut(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function ID(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Py[r]||r,r=t.read_shift(2),e[1]=Py[r]||r,e}function bD(t){return t||(t=oe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function CD(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(ES(t));return r}function ND(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(ES(t));return r}function RD(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function bS(t,e,r){if(!r.cellStyles)return Jr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function FD(t,e){var r=oe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function PD(t,e){var r={};return e<32||(t.l+=16,r.header=Xr(t),r.footer=Xr(t),t.l+=2),r}function DD(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function OD(t){for(var e=oe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var LD=Mi,MD=xS,jD=Xu;function BD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function VD(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Mi(t);++t.l;var i=_o(t,e-7,r);return n.t="str",n.val=i,n}function UD(t){var e=Mi(t);++t.l;var r=Xr(t);return e.t="n",e.val=r,e}function zD(t,e,r){var n=oe(15);return Zu(n,t,e),n.write_shift(8,r,"f"),n}function WD(t){var e=Mi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function HD(t,e,r){var n=oe(9);return Zu(n,t,e),n.write_shift(2,r),n}function $D(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function GD(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function qD(t,e,r){var n=t.l+e,i=Mi(t),a=t.read_shift(2),s=to(t,a,r);return t.l=n,i.t="str",i.val=s,i}var KD=[2,3,48,49,131,139,140,245],Qm=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=sd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ss(1);switch(l.type){case"base64":u=Rn(Mn(o));break;case"binary":u=Rn(o);break;case"buffer":case"array":u=o;break}Cr(u,0);var h=u.read_shift(1),d=!!(h&136),p=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,_=521;h==2&&(m=u.read_shift(2)),u.l+=3,h!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(_=u.read_shift(2));var y=u.read_shift(2),T=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=t[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var w=[],R={},j=Math.min(u.length,h==2?521:_-10-(p?264:0)),D=g?32:11;u.l<j&&u[u.l]!=13;)switch(R={},R.name=Pa.utils.decode(T,u.slice(u.l,u.l+D)).replace(/[\u0000\r\n].*$/g,""),u.l+=D,R.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(R.offset=u.read_shift(4)),R.len=u.read_shift(1),h==2&&(R.offset=u.read_shift(2)),R.dec=u.read_shift(1),R.name.length&&w.push(R),h!=2&&(u.l+=g?13:14),R.type){case"B":(!p||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var E=0,S=0;for(c[0]=[],S=0;S!=w.length;++S)c[0][S]=w[S].name;for(;m-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,c[++E]=[],S=0,S=0;S!=w.length;++S){var k=u.slice(u.l,u.l+w[S].len);u.l+=w[S].len,Cr(k,0);var I=Pa.utils.decode(T,k);switch(w[S].type){case"C":I.trim().length&&(c[E][S]=I.replace(/\s+$/,""));break;case"D":I.length===8?c[E][S]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):c[E][S]=I;break;case"F":c[E][S]=parseFloat(I.trim());break;case"+":case"I":c[E][S]=g?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":c[E][S]=!0;break;case"N":case"F":c[E][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[E][S]="##MEMO##"+(g?parseInt(I.trim(),10):k.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(c[E][S]=+I||0);break;case"@":c[E][S]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[E][S]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[E][S]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][S]=-k.read_shift(-8,"f");break;case"B":if(p&&w[S].len==8){c[E][S]=k.read_shift(8,"f");break}case"G":case"P":k.l+=w[S].len;break;case"0":if(w[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[S].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Vl(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(o,l){try{return vs(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&oi(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=wn(),h=wh(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),g=o["!cols"]||[],m=0,_=0,y=0,T=1;for(m=0;m<d.length;++m){if(((g[m]||{}).DBF||{}).name){d[m]=g[m].DBF.name,++y;continue}if(d[m]!=null){if(++y,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(_=0;_<1024;++_)if(d.indexOf(d[m]+"_"+_)==-1){d[m]+="_"+_;break}}}}var w=lt(o["!ref"]),R=[],j=[],D=[];for(m=0;m<=w.e.c-w.s.c;++m){var E="",S="",k=0,I=[];for(_=0;_<p.length;++_)p[_][m]!=null&&I.push(p[_][m]);if(I.length==0||d[m]==null){R[m]="?";continue}for(_=0;_<I.length;++_){switch(typeof I[_]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=I[_]instanceof Date?"D":"C";break;default:S="C"}k=Math.max(k,String(I[_]).length),E=E&&E!=S?"C":S}k>250&&(k=250),S=((g[m]||{}).DBF||{}).type,S=="C"&&g[m].DBF.len>k&&(k=g[m].DBF.len),E=="B"&&S=="N"&&(E="N",D[m]=g[m].DBF.dec,k=g[m].DBF.len),j[m]=E=="C"||S=="N"?k:a[E]||0,T+=j[m],R[m]=E}var b=u.next(32);for(b.write_shift(4,318902576),b.write_shift(4,p.length),b.write_shift(2,296+32*y),b.write_shift(2,T),m=0;m<4;++m)b.write_shift(4,0);for(b.write_shift(4,0|(+e[vk]||3)<<8),m=0,_=0;m<d.length;++m)if(d[m]!=null){var N=u.next(32),F=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,F,"sbcs"),N.write_shift(1,R[m]=="?"?"C":R[m],"sbcs"),N.write_shift(4,_),N.write_shift(1,j[m]||a[R[m]]||0),N.write_shift(1,D[m]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),_+=j[m]||a[R[m]]||0}var he=u.next(264);for(he.write_shift(4,13),m=0;m<65;++m)he.write_shift(4,0);for(m=0;m<p.length;++m){var de=u.next(T);for(de.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(R[_]){case"L":de.write_shift(1,p[m][_]==null?63:p[m][_]?84:70);break;case"B":de.write_shift(8,p[m][_]||0,"f");break;case"N":var Ae="0";for(typeof p[m][_]=="number"&&(Ae=p[m][_].toFixed(D[_]||0)),y=0;y<j[_]-Ae.length;++y)de.write_shift(1,32);de.write_shift(1,Ae,"sbcs");break;case"D":p[m][_]?(de.write_shift(4,("0000"+p[m][_].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(p[m][_].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+p[m][_].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var ve=String(p[m][_]!=null?p[m][_]:"").slice(0,j[_]);for(de.write_shift(1,ve,"sbcs"),y=0;y<j[_]-ve.length;++y)de.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),CS=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Yt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var g=t[p];return typeof g=="number"?sy(g):g},n=function(d,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?d:sy(m)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return a(Mn(d),p);case"binary":return a(d,p);case"buffer":return a(Je&&Buffer.isBuffer(d)?d.toString("binary"):gs(d),p);case"array":return a(Zs(d),p)}throw new Error("Unrecognized type "+p.type)}function a(d,p){var g=d.split(/[\n\r]+/),m=-1,_=-1,y=0,T=0,w=[],R=[],j=null,D={},E=[],S=[],k=[],I=0,b;for(+p.codepage>=0&&oi(+p.codepage);y!==g.length;++y){I=0;var N=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=N.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),he=F[0],de;if(N.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&R.push(N.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,ve=!1,le=!1,P=!1,Q=-1,re=-1;for(T=1;T<F.length;++T)switch(F[T].charAt(0)){case"A":break;case"X":_=parseInt(F[T].slice(1))-1,ve=!0;break;case"Y":for(m=parseInt(F[T].slice(1))-1,ve||(_=0),b=w.length;b<=m;++b)w[b]=[];break;case"K":de=F[T].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(fi(de))?isNaN(kl(de).getDate())||(de=Pt(de)):(de=fi(de),j!==null&&jl(j)&&(de=ld(de))),Ae=!0;break;case"E":P=!0;var O=ol(F[T].slice(1),{r:m,c:_});w[m][_]=[w[m][_],O];break;case"S":le=!0,w[m][_]=[w[m][_],"S5S"];break;case"G":break;case"R":Q=parseInt(F[T].slice(1))-1;break;case"C":re=parseInt(F[T].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+N)}if(Ae&&(w[m][_]&&w[m][_].length==2?w[m][_][0]=de:w[m][_]=de,j=null),le){if(P)throw new Error("SYLK shared formula cannot have own formula");var q=Q>-1&&w[Q][re];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");w[m][_][1]=qS(q[1],{r:m-Q,c:_-re})}break;case"F":var H=0;for(T=1;T<F.length;++T)switch(F[T].charAt(0)){case"X":_=parseInt(F[T].slice(1))-1,++H;break;case"Y":for(m=parseInt(F[T].slice(1))-1,b=w.length;b<=m;++b)w[b]=[];break;case"M":I=parseInt(F[T].slice(1))/20;break;case"F":break;case"G":break;case"P":j=R[parseInt(F[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=F[T].slice(1).split(" "),b=parseInt(k[0],10);b<=parseInt(k[1],10);++b)I=parseInt(k[2],10),S[b-1]=I===0?{hidden:!0}:{wch:I},os(S[b-1]);break;case"C":_=parseInt(F[T].slice(1))-1,S[_]||(S[_]={});break;case"R":m=parseInt(F[T].slice(1))-1,E[m]||(E[m]={}),I>0?(E[m].hpt=I,E[m].hpx=Al(I)):I===0&&(E[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+N)}H<1&&(j=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+N)}}return E.length>0&&(D["!rows"]=E),S.length>0&&(D["!cols"]=S),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,D]}function s(d,p){var g=i(d,p),m=g[0],_=g[1],y=Vl(m,p);return Yt(_).forEach(function(T){y[T]=_[T]}),y}function o(d,p){return vs(s(d,p),p)}function l(d,p,g,m){var _="C;Y"+(g+1)+";X"+(m+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+nx(d.f,{r:g,c:m}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(d,p){p.forEach(function(g,m){var _="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Su(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Au(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function u(d,p){p.forEach(function(g,m){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*Iu(g.hpx)+";"),_.length>2&&d.push(_+"R"+(m+1))})}function h(d,p){var g=["ID;PWXL;N;E"],m=[],_=lt(d["!ref"]),y,T=Array.isArray(d),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&c(g,d["!cols"]),d["!rows"]&&u(g,d["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var R=_.s.r;R<=_.e.r;++R)for(var j=_.s.c;j<=_.e.c;++j){var D=Me({r:R,c:j});y=T?(d[R]||[])[j]:d[D],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,d,R,j))}return g.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),NS=function(){function t(a,s){switch(s.type){case"base64":return e(Mn(a),s);case"binary":return e(a,s);case"buffer":return e(Je&&Buffer.isBuffer(a)?a.toString("binary"):gs(a),s);case"array":return e(Zs(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),p=d[0],g=d[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(fi(g))?isNaN(kl(g).getDate())?h[l][c]=g:h[l][c]=Pt(g):h[l][c]=fi(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(a,s){return Vl(t(a,s),s)}function n(a,s){return vs(r(a,s),s)}var i=function(){var a=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},s=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=lt(l["!ref"]),h,d=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){s(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=Me({r:p,c:g});if(h=d?(l[p]||[])[g]:l[m],!h){s(c,1,0,"");continue}switch(h.t){case"n":var _=h.w;!_&&h.v!=null&&(_=h.v),_==null?h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,_,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Zn(h.z||Le[14],gr(Pt(h.v)))),s(c,0,h.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var y=`\r
`,T=c.join(y);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),RS=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),g=-1,m=-1,_=0,y=[];_!==p.length;++_){var T=p[_].trim().split(":");if(T[0]==="cell"){var w=Ut(T[1]);if(y.length<=w.r)for(g=y.length;g<=w.r;++g)y[g]||(y[g]=[]);switch(g=w.r,m=w.c,T[2]){case"t":y[g][m]=t(T[3]);break;case"v":y[g][m]=+T[3];break;case"vtf":var R=T[T.length-1];case"vtc":switch(T[3]){case"nl":y[g][m]=!!+T[4];break;default:y[g][m]=+T[4];break}T[2]=="vtf"&&(y[g][m]=[y[g][m],R])}}}return d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),y}function n(h,d){return Vl(r(h,d),d)}function i(h,d){return vs(n(h,d),d)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],g,m="",_=kn(h["!ref"]),y=Array.isArray(h),T=_.s.r;T<=_.e.r;++T)for(var w=_.s.c;w<=_.e.c;++w)if(m=Me({r:T,c:w}),g=y?(h[T]||[])[w]:h[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(e(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=e(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var R=gr(Pt(g.v));p[2]="vtc",p[3]="nd",p[4]=""+R,p[5]=g.w||Zn(g.z||Le[14],R);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[a,s,o,s,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Sl=function(){function t(u,h,d,p,g){g.raw?h[d][p]=u:u===""||(u==="TRUE"?h[d][p]=!0:u==="FALSE"?h[d][p]=!1:isNaN(fi(u))?isNaN(kl(u).getDate())?h[d][p]=u:h[d][p]=Pt(u):h[d][p]=fi(u))}function e(u,h){var d=h||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var _=10,y=0,T=0;T<=m;++T)y=g[T].indexOf(" "),y==-1?y=g[T].length:y++,_=Math.max(_,y);for(T=0;T<=m;++T){p[T]=[];var w=0;for(t(g[T].slice(0,_).trim(),p,T,w,d),w=1;w<=(g[T].length-_)/10+1;++w)t(g[T].slice(_+(w-1)*10,_+w*10).trim(),p,T,w,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?d=!d:!d&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p]);if(!g.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p])}return g.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[g.pop()[1]]||44}function a(u,h){var d=h||{},p="",g=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):d&&d.FS?p=d.FS:p=i(u.slice(0,1024));var _=0,y=0,T=0,w=0,R=0,j=p.charCodeAt(0),D=!1,E=0,S=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var k=d.dateNF!=null?D3(d.dateNF):null;function I(){var b=u.slice(w,R),N={};if(b.charAt(0)=='"'&&b.charAt(b.length-1)=='"'&&(b=b.slice(1,-1).replace(/""/g,'"')),b.length===0)N.t="z";else if(d.raw)N.t="s",N.v=b;else if(b.trim().length===0)N.t="s",N.v=b;else if(b.charCodeAt(0)==61)b.charCodeAt(1)==34&&b.charCodeAt(b.length-1)==34?(N.t="s",N.v=b.slice(2,-1).replace(/""/g,'"')):c5(b)?(N.t="n",N.f=b.slice(1)):(N.t="s",N.v=b);else if(b=="TRUE")N.t="b",N.v=!0;else if(b=="FALSE")N.t="b",N.v=!1;else if(!isNaN(T=fi(b)))N.t="n",d.cellText!==!1&&(N.w=b),N.v=T;else if(!isNaN(kl(b).getDate())||k&&b.match(k)){N.z=d.dateNF||Le[14];var F=0;k&&b.match(k)&&(b=O3(b,d.dateNF,b.match(k)||[]),F=1),d.cellDates?(N.t="d",N.v=Pt(b,F)):(N.t="n",N.v=gr(Pt(b,F))),d.cellText!==!1&&(N.w=Zn(N.z,N.v instanceof Date?gr(N.v):N.v)),d.cellNF||delete N.z}else N.t="s",N.v=b;if(N.t=="z"||(d.dense?(g[_]||(g[_]=[]),g[_][y]=N):g[Me({c:y,r:_})]=N),w=R+1,S=u.charCodeAt(w),m.e.c<y&&(m.e.c=y),m.e.r<_&&(m.e.r=_),E==j)++y;else if(y=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;R<u.length;++R)switch(E=u.charCodeAt(R)){case 34:S===34&&(D=!D);break;case j:case 10:case 13:if(!D&&I())break e;break}return R-w>0&&I(),g["!ref"]=qe(m),g}function s(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):Vl(e(u,h),h)}function o(u,h){var d="",p=h.type=="string"?[0,0,0,0]:fx(u,h);switch(h.type){case"base64":d=Mn(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof Pa<"u"?d=Pa.utils.decode(h.codepage,u):d=Je&&Buffer.isBuffer(u)?u.toString("binary"):gs(u);break;case"array":d=Zs(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=_t(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=_t(d):h.type=="binary"&&typeof Pa<"u"&&h.codepage&&(d=Pa.utils.decode(h.codepage,Pa.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?RS.to_sheet(h.type=="string"?d:_t(d),h):s(d,h)}function l(u,h){return vs(o(u,h),h)}function c(u){for(var h=[],d=lt(u["!ref"]),p,g=Array.isArray(u),m=d.s.r;m<=d.e.r;++m){for(var _=[],y=d.s.c;y<=d.e.c;++y){var T=Me({r:m,c:y});if(p=g?(u[m]||[])[y]:u[T],!p||p.v==null){_.push("          ");continue}for(var w=(p.w||(ca(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";_.push(w+(y===0?" ":""))}h.push(_.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function XD(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=CS.to_workbook(t,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Sl.to_workbook(t,e)}}var Hs=function(){function t(O,q,H){if(O){Cr(O,O.l||0);for(var G=H.Enum||Q;O.l<O.length;){var K=O.read_shift(2),ne=G[K]||G[65535],ae=O.read_shift(2),ue=O.l+ae,ce=ne.f&&ne.f(O,ae,H);if(O.l=ue,q(ce,ne,K))return}}}function e(O,q){switch(q.type){case"base64":return r(Rn(Mn(O)),q);case"binary":return r(Rn(O),q);case"buffer":case"array":return r(O,q)}throw"Unsupported type "+q.type}function r(O,q){if(!O)return O;var H=q||{},G=H.dense?[]:{},K="Sheet1",ne="",ae=0,ue={},ce=[],De=[],W={s:{r:0,c:0},e:{r:0,c:0}},ct=H.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)H.Enum=Q,t(O,function(Te,wt,nr){switch(nr){case 0:H.vers=Te,Te>=4096&&(H.qpro=!0);break;case 6:W=Te;break;case 204:Te&&(ne=Te);break;case 222:ne=Te;break;case 15:case 51:H.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:nr==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=H.dateNF||Le[14],H.cellDates&&(Te[1].t="d",Te[1].v=ld(Te[1].v))),H.qpro&&Te[3]>ae&&(G["!ref"]=qe(W),ue[K]=G,ce.push(K),G=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ae=Te[3],K=ne||"Sheet"+(ae+1),ne="");var ur=H.dense?(G[Te[0].r]||[])[Te[0].c]:G[Me(Te[0])];if(ur){ur.t=Te[1].t,ur.v=Te[1].v,Te[1].z!=null&&(ur.z=Te[1].z),Te[1].f!=null&&(ur.f=Te[1].f);break}H.dense?(G[Te[0].r]||(G[Te[0].r]=[]),G[Te[0].r][Te[0].c]=Te[1]):G[Me(Te[0])]=Te[1];break}},H);else if(O[2]==26||O[2]==14)H.Enum=re,O[2]==14&&(H.qpro=!0,O.l=0),t(O,function(Te,wt,nr){switch(nr){case 204:K=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>ae&&(G["!ref"]=qe(W),ue[K]=G,ce.push(K),G=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ae=Te[3],K="Sheet"+(ae+1)),ct>0&&Te[0].r>=ct)break;H.dense?(G[Te[0].r]||(G[Te[0].r]=[]),G[Te[0].r][Te[0].c]=Te[1]):G[Me(Te[0])]=Te[1],W.e.c<Te[0].c&&(W.e.c=Te[0].c),W.e.r<Te[0].r&&(W.e.r=Te[0].r);break;case 27:Te[14e3]&&(De[Te[14e3][0]]=Te[14e3][1]);break;case 1537:De[Te[0]]=Te[1],Te[0]==ae&&(K=Te[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(G["!ref"]=qe(W),ue[ne||K]=G,ce.push(ne||K),!De.length)return{SheetNames:ce,Sheets:ue};for(var Ke={},nt=[],Ge=0;Ge<De.length;++Ge)ue[ce[Ge]]?(nt.push(De[Ge]||ce[Ge]),Ke[De[Ge]]=ue[De[Ge]]||ue[ce[Ge]]):(nt.push(De[Ge]),Ke[De[Ge]]={"!ref":"A1"});return{SheetNames:nt,Sheets:Ke}}function n(O,q){var H=q||{};if(+H.codepage>=0&&oi(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var G=wn(),K=lt(O["!ref"]),ne=Array.isArray(O),ae=[];Ee(G,0,a(1030)),Ee(G,6,l(K));for(var ue=Math.min(K.e.r,8191),ce=K.s.r;ce<=ue;++ce)for(var De=er(ce),W=K.s.c;W<=K.e.c;++W){ce===K.s.r&&(ae[W]=Vt(W));var ct=ae[W]+De,Ke=ne?(O[ce]||[])[W]:O[ct];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Ee(G,13,p(ce,W,Ke.v)):Ee(G,14,m(ce,W,Ke.v));else{var nt=ca(Ke);Ee(G,15,h(ce,W,nt.slice(0,239)))}}return Ee(G,1),G.end()}function i(O,q){var H=q||{};if(+H.codepage>=0&&oi(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var G=wn();Ee(G,0,s(O));for(var K=0,ne=0;K<O.SheetNames.length;++K)(O.Sheets[O.SheetNames[K]]||{})["!ref"]&&Ee(G,27,P(O.SheetNames[K],ne++));var ae=0;for(K=0;K<O.SheetNames.length;++K){var ue=O.Sheets[O.SheetNames[K]];if(!(!ue||!ue["!ref"])){for(var ce=lt(ue["!ref"]),De=Array.isArray(ue),W=[],ct=Math.min(ce.e.r,8191),Ke=ce.s.r;Ke<=ct;++Ke)for(var nt=er(Ke),Ge=ce.s.c;Ge<=ce.e.c;++Ge){Ke===ce.s.r&&(W[Ge]=Vt(Ge));var Te=W[Ge]+nt,wt=De?(ue[Ke]||[])[Ge]:ue[Te];if(!(!wt||wt.t=="z"))if(wt.t=="n")Ee(G,23,I(Ke,Ge,ae,wt.v));else{var nr=ca(wt);Ee(G,22,E(Ke,Ge,ae,nr.slice(0,239)))}}++ae}}return Ee(G,1),G.end()}function a(O){var q=oe(2);return q.write_shift(2,O),q}function s(O){var q=oe(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var H=0,G=0,K=0,ne=0;ne<O.SheetNames.length;++ne){var ae=O.SheetNames[ne],ue=O.Sheets[ae];if(!(!ue||!ue["!ref"])){++K;var ce=kn(ue["!ref"]);H<ce.e.r&&(H=ce.e.r),G<ce.e.c&&(G=ce.e.c)}}return H>8191&&(H=8191),q.write_shift(2,H),q.write_shift(1,K),q.write_shift(1,G),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(O,q,H){var G={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&H.qpro?(G.s.c=O.read_shift(1),O.l++,G.s.r=O.read_shift(2),G.e.c=O.read_shift(1),O.l++,G.e.r=O.read_shift(2),G):(G.s.c=O.read_shift(2),G.s.r=O.read_shift(2),q==12&&H.qpro&&(O.l+=2),G.e.c=O.read_shift(2),G.e.r=O.read_shift(2),q==12&&H.qpro&&(O.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(O){var q=oe(8);return q.write_shift(2,O.s.c),q.write_shift(2,O.s.r),q.write_shift(2,O.e.c),q.write_shift(2,O.e.r),q}function c(O,q,H){var G=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(G[0].c=O.read_shift(1),G[3]=O.read_shift(1),G[0].r=O.read_shift(2),O.l+=2):(G[2]=O.read_shift(1),G[0].c=O.read_shift(2),G[0].r=O.read_shift(2)),G}function u(O,q,H){var G=O.l+q,K=c(O,q,H);if(K[1].t="s",H.vers==20768){O.l++;var ne=O.read_shift(1);return K[1].v=O.read_shift(ne,"utf8"),K}return H.qpro&&O.l++,K[1].v=O.read_shift(G-O.l,"cstr"),K}function h(O,q,H){var G=oe(7+H.length);G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,O),G.write_shift(1,39);for(var K=0;K<G.length;++K){var ne=H.charCodeAt(K);G.write_shift(1,ne>=128?95:ne)}return G.write_shift(1,0),G}function d(O,q,H){var G=c(O,q,H);return G[1].v=O.read_shift(2,"i"),G}function p(O,q,H){var G=oe(7);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,O),G.write_shift(2,H,"i"),G}function g(O,q,H){var G=c(O,q,H);return G[1].v=O.read_shift(8,"f"),G}function m(O,q,H){var G=oe(13);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,O),G.write_shift(8,H,"f"),G}function _(O,q,H){var G=O.l+q,K=c(O,q,H);if(K[1].v=O.read_shift(8,"f"),H.qpro)O.l=G;else{var ne=O.read_shift(2);R(O.slice(O.l,O.l+ne),K),O.l+=ne}return K}function y(O,q,H){var G=q&32768;return q&=-32769,q=(G?O:0)+(q>=8192?q-16384:q),(G?"":"$")+(H?Vt(q):er(q))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(O,q){Cr(O,0);for(var H=[],G=0,K="",ne="",ae="",ue="";O.l<O.length;){var ce=O[O.l++];switch(ce){case 0:H.push(O.read_shift(8,"f"));break;case 1:ne=y(q[0].c,O.read_shift(2),!0),K=y(q[0].r,O.read_shift(2),!1),H.push(ne+K);break;case 2:{var De=y(q[0].c,O.read_shift(2),!0),W=y(q[0].r,O.read_shift(2),!1);ne=y(q[0].c,O.read_shift(2),!0),K=y(q[0].r,O.read_shift(2),!1),H.push(De+W+":"+ne+K)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(O.read_shift(2));break;case 6:{for(var ct="";ce=O[O.l++];)ct+=String.fromCharCode(ce);H.push('"'+ct.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ue=H.pop(),ae=H.pop(),H.push(["AND","OR"][ce-20]+"("+ae+","+ue+")");break;default:if(ce<32&&w[ce])ue=H.pop(),ae=H.pop(),H.push(ae+w[ce]+ue);else if(T[ce]){if(G=T[ce][1],G==69&&(G=O[O.l++]),G>H.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+H.join("|")+"|");return}var Ke=H.slice(-G);H.length-=G,H.push(T[ce][0]+"("+Ke.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}H.length==1?q[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function j(O){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=O.read_shift(2),q[3]=O[O.l++],q[0].c=O[O.l++],q}function D(O,q){var H=j(O);return H[1].t="s",H[1].v=O.read_shift(q-4,"cstr"),H}function E(O,q,H,G){var K=oe(6+G.length);K.write_shift(2,O),K.write_shift(1,H),K.write_shift(1,q),K.write_shift(1,39);for(var ne=0;ne<G.length;++ne){var ae=G.charCodeAt(ne);K.write_shift(1,ae>=128?95:ae)}return K.write_shift(1,0),K}function S(O,q){var H=j(O);H[1].v=O.read_shift(2);var G=H[1].v>>1;if(H[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return H[1].v=G,H}function k(O,q){var H=j(O),G=O.read_shift(4),K=O.read_shift(4),ne=O.read_shift(2);if(ne==65535)return G===0&&K===3221225472?(H[1].t="e",H[1].v=15):G===0&&K===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var ae=ne&32768;return ne=(ne&32767)-16446,H[1].v=(1-ae*2)*(K*Math.pow(2,ne+32)+G*Math.pow(2,ne)),H}function I(O,q,H,G){var K=oe(14);if(K.write_shift(2,O),K.write_shift(1,H),K.write_shift(1,q),G==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ne=0,ae=0,ue=0,ce=0;return G<0&&(ne=1,G=-G),ae=Math.log2(G)|0,G/=Math.pow(2,ae-31),ce=G>>>0,ce&2147483648||(G/=2,++ae,ce=G>>>0),G-=ce,ce|=2147483648,ce>>>=0,G*=Math.pow(2,32),ue=G>>>0,K.write_shift(4,ue),K.write_shift(4,ce),ae+=16383+(ne?32768:0),K.write_shift(2,ae),K}function b(O,q){var H=k(O);return O.l+=q-14,H}function N(O,q){var H=j(O),G=O.read_shift(4);return H[1].v=G>>6,H}function F(O,q){var H=j(O),G=O.read_shift(8,"f");return H[1].v=G,H}function he(O,q){var H=F(O);return O.l+=q-10,H}function de(O,q){return O[O.l+q-1]==0?O.read_shift(q,"cstr"):""}function Ae(O,q){var H=O[O.l++];H>q-1&&(H=q-1);for(var G="";G.length<H;)G+=String.fromCharCode(O[O.l++]);return G}function ve(O,q,H){if(!(!H.qpro||q<21)){var G=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var K=O.read_shift(q-21,"cstr");return[G,K]}}function le(O,q){for(var H={},G=O.l+q;O.l<G;){var K=O.read_shift(2);if(K==14e3){for(H[K]=[0,""],H[K][0]=O.read_shift(2);O[O.l];)H[K][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return H}function P(O,q){var H=oe(5+O.length);H.write_shift(2,14e3),H.write_shift(2,q);for(var G=0;G<O.length;++G){var K=O.charCodeAt(G);H[H.l++]=K>127?95:K}return H[H.l++]=0,H}var Q={0:{n:"BOF",f:or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:b},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ve},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function YD(t){var e={},r=t.match(en),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=Be(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=bv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return e}var QD=function(){var t=yu("t"),e=yu("rPr");function r(a){var s=a.match(t);if(!s)return{t:"s",v:""};var o={t:"s",v:ot(s[1])},l=a.match(e);return l&&(o.s=YD(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),JD=function(){var e=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),ZD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eO=/<(?:\w+:)?r>/,tO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Jv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ot(_t(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=_t(t),r&&(n.h=jv(n.t))):t.match(eO)&&(n.r=_t(t),n.t=ot(_t((t.replace(tO,"").match(ZD)||[]).join("").replace(en,""))),r&&(n.h=JD(QD(n.r)))),n):{t:""}}var rO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nO=/<(?:\w+:)?(?:si|sstItem)>/g,iO=/<\/(?:\w+:)?(?:si|sstItem)>/;function aO(t,e){var r=[],n="";if(!t)return r;var i=t.match(rO);if(i){n=i[2].replace(nO,"").split(iO);for(var a=0;a!=n.length;++a){var s=Jv(n[a].trim(),e);s!=null&&(r[r.length]=s)}i=Be(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var sO=/^\s|\s$|[\t\n\r]/;function FS(t,e){if(!e.bookSST)return"";var r=[rr];r[r.length]=we("sst",null,{xmlns:po[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(sO)&&(a+=' xml:space="preserve"'),a+=">"+gt(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oO(t){return[t.read_shift(4),t.read_shift(4)]}function lO(t,e){var r=[],n=!1;return ga(t,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function cO(t,e){return e||(e=oe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var uO=yF;function fO(t){var e=wn();pe(e,159,cO(t));for(var r=0;r<t.length;++r)pe(e,19,uO(t[r]));return pe(e,160),e.end()}function PS(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function ra(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function hO(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ra(t,4),e.U=ra(t,4),e.W=ra(t,4),e}function dO(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),a=[];i-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function pO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(dO(t));return e}function mO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function gO(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ra(t,4),e.U=ra(t,4),e.W=ra(t,4),e}function vO(t){var e=gO(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function DS(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function OS(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function xO(t){var e=ra(t);switch(e.Minor){case 2:return[e.Minor,_O(t)];case 3:return[e.Minor,yO()];case 4:return[e.Minor,wO(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function _O(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=DS(t,r),i=OS(t,t.length-t.l);return{t:"Std",h:n,v:i}}function yO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function wO(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(en,function(a){var s=Be(a);switch(Li(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function EO(t,e){var r={},n=r.EncryptionVersionInfo=ra(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=DS(t,i),e-=i,r.EncryptionVerifier=OS(t,e),r}function TO(t){var e={},r=e.EncryptionVersionInfo=ra(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Zv(t){var e=0,r,n=PS(t),i=n.length+1,a,s,o,l,c;for(r=ss(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^s;return e^52811}var LS=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=e[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=PS(s),l=a(o),c=o.length,u=ss(16),h=0;h!=16;++h)u[h]=0;var d,p,g;for((c&1)===1&&(d=l>>8,u[c]=i(t[0],d),--c,d=l&255,p=o[o.length-1],u[c]=i(p,d));c>0;)--c,d=l>>8,u[c]=i(o[c],d),--c,d=l&255,u[c]=i(o[c],d);for(c=15,g=15-o.length;g>0;)d=l>>8,u[c]=i(t[g],d),--c,--g,d=l&255,u[c]=i(o[c],d),--c,--g;return u}}(),kO=function(t,e,r,n,i){i||(i=e),n||(n=LS(t));var a,s;for(a=0;a!=e.length;++a)s=e[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},SO=function(t){var e=0,r=LS(t);return function(n){var i=kO("",n,e,r);return e=i[1],i[0]}};function AO(t,e,r,n){var i={key:or(t),verificationBytes:or(t)};return r.password&&(i.verifier=Zv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=SO(r.password)),i}function IO(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=TO(t):n.Data=EO(t,e),n}function bO(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?IO(t,e-2,n):AO(t,r.biff>=8?e:e-2,r,n),n}var MS=function(){function t(i,a){switch(a.type){case"base64":return e(Mn(i),a);case"binary":return e(i,a);case"buffer":return e(Je&&Buffer.isBuffer(i)?i.toString("binary"):gs(i),a);case"array":return e(Zs(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){var s=a||{},o=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,g,m=-1;g=d.exec(u);){switch(g[0]){case"\\cell":var _=u.slice(p,d.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var y={v:_,t:"s"};Array.isArray(o)?o[h][m]=y:o[Me({r:h,c:m})]=y}break}p=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=qe(c),o}function r(i,a){return vs(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=lt(i["!ref"]),o,l=Array.isArray(i),c=s.s.r;c<=s.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var h=Me({r:c,c:u});o=l?(i[c]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ca(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function CO(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ku(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function NO(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),a=Math.min(e,r,n),s=i-a;if(s===0)return[0,0,e];var o=0,l=0,c=i+a;switch(l=s/(c>1?2-c:c),i){case e:o=((r-n)/s+6)%6;break;case r:o=(n-e)/s+2;break;case n:o=(e-r)/s+4;break}return[o/6,l,c/2]}function RO(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,s[0]+=i,s[1]+=l;break;case 1:l=i*(2-o),s[0]+=l,s[1]+=i;break;case 2:l=i*(o-2),s[1]+=i,s[2]+=l;break;case 3:l=i*(4-o),s[1]+=l,s[2]+=i;break;case 4:l=i*(o-4),s[2]+=i,s[0]+=l;break;case 5:l=i*(6-o),s[2]+=l,s[0]+=i;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function _h(t,e){if(e===0)return t;var r=NO(CO(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ku(RO(r))}var jS=6,FO=15,PO=1,qr=jS;function Su(t){return Math.floor((t+Math.round(128/qr)/256)*qr)}function Au(t){return Math.floor((t-5)/qr*100+.5)/100}function yh(t){return Math.round((t*qr+5)/qr*256)/256}function kp(t){return yh(Au(Su(t)))}function ex(t){var e=Math.abs(t-kp(t)),r=qr;if(e>.005)for(qr=PO;qr<FO;++qr)Math.abs(t-kp(t))<=e&&(e=Math.abs(t-kp(t)),r=qr);qr=r}function os(t){t.width?(t.wpx=Su(t.width),t.wch=Au(t.wpx),t.MDW=qr):t.wpx?(t.wch=Au(t.wpx),t.width=yh(t.wch),t.MDW=qr):typeof t.wch=="number"&&(t.width=yh(t.wch),t.wpx=Su(t.width),t.MDW=qr),t.customWidth&&delete t.customWidth}var DO=96,BS=DO;function Iu(t){return t*96/BS}function Al(t){return t*BS/96}var OO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function LO(t,e,r,n){e.Borders=[];var i={},a=!1;(t[0].match(en)||[]).forEach(function(s){var o=Be(s);switch(Li(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Nt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Nt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function MO(t,e,r,n){e.Fills=[];var i={},a=!1;(t[0].match(en)||[]).forEach(function(s){var o=Be(s);switch(Li(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function jO(t,e,r,n){e.Fonts=[];var i={},a=!1;(t[0].match(en)||[]).forEach(function(s){var o=Be(s);switch(Li(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=_t(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Nt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Nt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Nt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Nt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Nt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Nt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Nt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=bv[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Nt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=zs[i.color.index];i.color.index==81&&(l=zs[1]),l||(l=zs[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=_h(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function BO(t,e,r){e.NumberFmt=[];for(var n=Yt(Le),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Le[n[i]];var a=t[0].match(en);if(a)for(i=0;i<a.length;++i){var s=Be(a[i]);switch(Li(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ot(_t(s.formatCode)),l=parseInt(s.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}ta(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function VO(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=we("numFmt",null,{numFmtId:n,formatCode:gt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=we("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var n0=["numFmtId","fillId","fontId","borderId","xfId"],i0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function UO(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(en)||[]).forEach(function(a){var s=Be(a),o=0;switch(Li(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<n0.length;++o)n[n0[o]]&&(n[n0[o]]=parseInt(n[n0[o]],10));for(o=0;o<i0.length;++o)n[i0[o]]&&(n[i0[o]]=Nt(n[i0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Nt(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function zO(t){var e=[];return e[e.length]=we("cellXfs",null),t.forEach(function(r){e[e.length]=we("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=we("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var WO=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&BO(h,u,c),(h=o.match(i))&&jO(h,u,l,c),(h=o.match(n))&&MO(h,u,l,c),(h=o.match(a))&&LO(h,u,l,c),(h=o.match(r))&&UO(h,u,c),u}}();function VS(t,e){var r=[rr,we("styleSheet",null,{xmlns:po[0],"xmlns:vt":dr.vt})],n;return t.SSF&&(n=VO(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=zO(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function HO(t,e){var r=t.read_shift(2),n=Yr(t);return[r,n]}function $O(t,e,r){r||(r=oe(6+4*e.length)),r.write_shift(2,t),wr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function GO(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=IF(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(n.underline=s);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=AF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Yr(t),n}function qO(t,e){e||(e=oe(25+4*32)),e.write_shift(2,t.sz*20),bF(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),gh(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),wr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var KO=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Sp,XO=Jr;function Yy(t,e){e||(e=oe(4*3+8*7+16*1)),Sp||(Sp=sd(KO));var r=Sp[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(gh({auto:1},e),gh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function YO(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function US(t,e,r){r||(r=oe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function fc(t,e){return e||(e=oe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var QO=Jr;function JO(t,e){return e||(e=oe(51)),e.write_shift(1,0),fc(null,e),fc(null,e),fc(null,e),fc(null,e),fc(null,e),e.length>e.l?e.slice(0,e.l):e}function ZO(t,e){return e||(e=oe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),mh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function e6(t,e,r){var n=oe(2052);return n.write_shift(4,t),mh(e,n),mh(r,n),n.length>n.l?n.slice(0,n.l):n}function t6(t,e,r){var n={};n.NumberFmt=[];for(var i in Le)n.NumberFmt[i]=Le[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return ga(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ta(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=_h(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function r6(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(pe(t,615,hi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&pe(t,44,$O(i,e[i]))}),pe(t,616))}}function n6(t){var e=1;pe(t,611,hi(e)),pe(t,43,qO({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),pe(t,612)}function i6(t){var e=2;pe(t,603,hi(e)),pe(t,45,Yy({patternType:"none"})),pe(t,45,Yy({patternType:"gray125"})),pe(t,604)}function a6(t){var e=1;pe(t,613,hi(e)),pe(t,46,JO()),pe(t,614)}function s6(t){var e=1;pe(t,626,hi(e)),pe(t,47,US({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),pe(t,627)}function o6(t,e){pe(t,617,hi(e.length)),e.forEach(function(r){pe(t,47,US(r,0))}),pe(t,618)}function l6(t){var e=1;pe(t,619,hi(e)),pe(t,48,ZO({xfId:0,builtinId:0,name:"Normal"})),pe(t,620)}function c6(t){var e=0;pe(t,505,hi(e)),pe(t,506)}function u6(t){var e=0;pe(t,508,e6(e,"TableStyleMedium9","PivotStyleMedium4")),pe(t,509)}function f6(t,e){var r=wn();return pe(r,278),r6(r,t.SSF),n6(r),i6(r),a6(r),s6(r),o6(r,e.cellXfs),l6(r),c6(r),u6(r),pe(r,279),r.end()}var h6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function d6(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(en)||[]).forEach(function(i){var a=Be(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[h6.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function p6(){}function m6(){}var g6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,v6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,x6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function _6(t,e,r){e.themeElements={};var n;[["clrScheme",g6,d6],["fontScheme",v6,p6],["fmtScheme",x6,m6]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var y6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function zS(t,e){(!t||t.length===0)&&(t=tx());var r,n={};if(!(r=t.match(y6)))throw new Error("themeElements not found in theme");return _6(r[0],n,e),n.raw=t,n}function tx(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[rr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function w6(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var s;try{s=Dk(a,{type:"array"})}catch{return}var o=Fn(s,"theme/theme/theme1.xml",!0);if(o)return zS(o,r)}}function E6(t){return t.read_shift(4)}function T6(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=k6(t,4);break;case 2:e.xclrValue=wS(t);break;case 3:e.xclrValue=E6(t);break;case 4:t.l+=4;break}return t.l+=8,e}function k6(t,e){return Jr(t,e)}function S6(t,e){return Jr(t,e)}function A6(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=T6(t);break;case 6:n[1]=S6(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function I6(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),a=[];i-- >0;)a.push(A6(t,r-t.l));return{ixfe:n,ext:a}}function b6(t,e){e.forEach(function(r){switch(r[0]){}})}function C6(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Yr(t)}}function N6(t){var e=oe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),wr(t.name,e),e.slice(0,e.l)}function R6(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function F6(t){var e=oe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function P6(t,e){var r=oe(8+2*e.length);return r.write_shift(4,t),wr(e,r),r.slice(0,r.l)}function D6(t){return t.l+=4,t.read_shift(4)!=0}function O6(t,e){var r=oe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function L6(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return ga(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!c.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function M6(){var t=wn();return pe(t,332),pe(t,334,hi(1)),pe(t,335,N6({name:"XLDAPR",version:12e4,flags:3496657072})),pe(t,336),pe(t,339,P6(1,"XLDAPR")),pe(t,52),pe(t,35,hi(514)),pe(t,4096,hi(0)),pe(t,4097,$n(1)),pe(t,36),pe(t,53),pe(t,340),pe(t,337,O6(1)),pe(t,51,F6([[1,0]])),pe(t,338),pe(t,333),t.end()}function j6(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,a=2,s;return t.replace(en,function(o){var l=Be(o);switch(Li(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function WS(){var t=[rr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function B6(t){var e=[];if(!t)return e;var r=1;return(t.match(en)||[]).forEach(function(n){var i=Be(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function V6(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Me(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function U6(t,e,r){var n=[];return ga(t,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function z6(t,e,r,n){if(!t)return t;var i=n||{},a=!1;ga(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function W6(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Qo=1024;function HS(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[we("xml",null,{"xmlns:v":Cn.v,"xmlns:o":Cn.o,"xmlns:x":Cn.x,"xmlns:mv":Cn.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Qo<t*1e3;)Qo+=1e3;return e.forEach(function(a){var s=Ut(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=we("v:fill",l,o),u={on:"t",obscured:"t"};++Qo,i=i.concat(["<v:shape"+wu({id:"_x0000_s"+Qo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,we("v:shadow",null,u),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Nr("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Nr("x:AutoFill","False"),Nr("x:Row",String(s.r)),Nr("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Qy(t,e,r,n){var i=Array.isArray(t),a;e.forEach(function(s){var o=Ut(s.ref);if(i?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[s.ref],!a){a={t:"z"},i?t[o.r][o.c]=a:t[s.ref]=a;var l=lt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=qe(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}a.c.push(u)})}function H6(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Be(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Ut(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Jv(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function $S(t){var e=[rr,we("comments",null,{xmlns:po[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var a=gt(i.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(gt(l.a))),a.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)e.push(Nr("t",gt(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;e.push(Nr("t",gt(s)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function $6(t,e){var r=[],n=!1,i={},a=0;return t.replace(en,function(o,l){var c=Be(o);switch(Li(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":i.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function G6(t,e,r){var n=[rr,we("ThreadedComments",null,{xmlns:dr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&e.indexOf(s.a)==-1&&e.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(s.a)).slice(-12)+"}"),n.push(we("threadedComment",Nr("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function q6(t,e){var r=[],n=!1;return t.replace(en,function(a){var s=Be(a);switch(Li(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function K6(t){var e=[rr,we("personList",null,{xmlns:dr.TCMNT,"xmlns:x":po[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(we("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function X6(t){var e={};e.iauthor=t.read_shift(4);var r=xo(t);return e.rfx=r.s,e.ref=Me(r.s),t.l+=16,e}function Y6(t,e){return e==null&&(e=oe(36)),e.write_shift(4,t[1].iauthor),Ul(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Q6=Yr;function J6(t){return wr(t.slice(0,54))}function Z6(t,e){var r=[],n=[],i={},a=!1;return ga(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function e5(t){var e=wn(),r=[];return pe(e,628),pe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),pe(e,632,J6(i.a)))})}),pe(e,631),pe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Ut(n[0]),e:Ut(n[0])};pe(e,635,Y6([a,i])),i.t&&i.t.length>0&&pe(e,637,EF(i)),pe(e,636),delete i.iauthor})}),pe(e,634),pe(e,629),e.end()}var t5="application/vnd.ms-office.vbaProject";function r5(t){var e=Pe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pe.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Pe.write(e)}function n5(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Pe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var GS=["xlsb","xlsm","xlam","biff8","xla"];function i5(){return{"!type":"dialog"}}function a5(){return{"!type":"dialog"}}function s5(){return{"!type":"macro"}}function o5(){return{"!type":"macro"}}var ol=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,i+(o?"":"$")+Vt(u)+(l?"":"$")+er(c)}return function(i,a){return e=a,i.replace(t,r)}}(),rx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nx=function(){return function(e,r){return e.replace(rx,function(n,i,a,s,o,l){var c=Wv(s)-(a?0:r.c),u=zv(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",d=c==0?"":a?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function qS(t,e){return t.replace(rx,function(r,n,i,a,s,o){return n+(i=="$"?i+a:Vt(Wv(a)+e.c))+(s=="$"?s+o:er(zv(o)+e.r))})}function l5(t,e,r){var n=kn(e),i=n.s,a=Ut(r),s={r:a.r-i.r,c:a.c-i.c};return qS(t,s)}function c5(t){return t.length!=1}function Jy(t){return t.replace(/_xlfn\./g,"")}function ir(t){t.l+=1}function ls(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function KS(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return XS(t);r.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),s=ls(t),o=ls(t);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function XS(t){var e=ls(t),r=ls(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function u5(t,e,r){if(r.biff<8)return XS(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),a=ls(t),s=ls(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function YS(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return f5(t);var n=t.read_shift(r&&r.biff==12?4:2),i=ls(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function f5(t){var e=ls(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function h5(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function d5(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return p5(t);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function p5(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function m5(t,e,r){var n=(t[t.l++]&96)>>5,i=KS(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function g5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var s=KS(t,a,r);return[n,i,s]}function v5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function x5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function _5(t,e,r){var n=(t[t.l++]&96)>>5,i=u5(t,e-1,r);return[n,i]}function y5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Zy(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function w5(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function E5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function T5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function k5(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function S5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function QS(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function A5(t){return t.read_shift(2),QS(t)}function I5(t){return t.read_shift(2),QS(t)}function b5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=YS(t,0,r);return[n,i]}function C5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=d5(t,0,r);return[n,i]}function N5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=YS(t,0,r);return[n,i,a]}function R5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[DL[i],eA[i],n]}function F5(t,e,r){var n=t[t.l++],i=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:P5(t);return[i,(a[0]===0?eA:PL)[a[1]]]}function P5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function D5(t,e,r){t.l+=r&&r.biff==2?3:4}function O5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function L5(t){return t.l++,va[t.read_shift(1)]}function M5(t){return t.l++,t.read_shift(2)}function j5(t){return t.l++,t.read_shift(1)!==0}function B5(t){return t.l++,Xr(t)}function V5(t,e,r){return t.l++,Ku(t,e-1,r)}function U5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Qt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=va[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Xr(t);break;case 2:r[1]=_o(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function z5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?xo:cd)(t));return i}function W5(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=U5(t,r.biff);return s}function H5(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function $5(t,e,r){if(r.biff==5)return G5(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function G5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function q5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function K5(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function X5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function Y5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var Q5=Jr,J5=Jr,Z5=Jr;function Yu(t,e,r){return t.l+=2,[h5(t)]}function ix(t){return t.l+=6,[]}var eL=Yu,tL=ix,rL=ix,nL=Yu;function JS(t){return t.l+=2,[or(t),t.read_shift(2)&1]}var iL=Yu,aL=JS,sL=ix,oL=Yu,lL=Yu,cL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uL(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),s=cL[r>>2&31];return{ixti:e,coltype:r&3,rt:s,idx:n,c:i,C:a}}function fL(t){return t.l+=2,[t.read_shift(4)]}function hL(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function dL(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function mL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function gL(t){return t.l+=4,[0,0]}var ew={1:{n:"PtgExp",f:O5},2:{n:"PtgTbl",f:Z5},3:{n:"PtgAdd",f:ir},4:{n:"PtgSub",f:ir},5:{n:"PtgMul",f:ir},6:{n:"PtgDiv",f:ir},7:{n:"PtgPower",f:ir},8:{n:"PtgConcat",f:ir},9:{n:"PtgLt",f:ir},10:{n:"PtgLe",f:ir},11:{n:"PtgEq",f:ir},12:{n:"PtgGe",f:ir},13:{n:"PtgGt",f:ir},14:{n:"PtgNe",f:ir},15:{n:"PtgIsect",f:ir},16:{n:"PtgUnion",f:ir},17:{n:"PtgRange",f:ir},18:{n:"PtgUplus",f:ir},19:{n:"PtgUminus",f:ir},20:{n:"PtgPercent",f:ir},21:{n:"PtgParen",f:ir},22:{n:"PtgMissArg",f:ir},23:{n:"PtgStr",f:V5},26:{n:"PtgSheet",f:hL},27:{n:"PtgEndSheet",f:dL},28:{n:"PtgErr",f:L5},29:{n:"PtgBool",f:j5},30:{n:"PtgInt",f:M5},31:{n:"PtgNum",f:B5},32:{n:"PtgArray",f:y5},33:{n:"PtgFunc",f:R5},34:{n:"PtgFuncVar",f:F5},35:{n:"PtgName",f:H5},36:{n:"PtgRef",f:b5},37:{n:"PtgArea",f:m5},38:{n:"PtgMemArea",f:q5},39:{n:"PtgMemErr",f:Q5},40:{n:"PtgMemNoMem",f:J5},41:{n:"PtgMemFunc",f:K5},42:{n:"PtgRefErr",f:X5},43:{n:"PtgAreaErr",f:v5},44:{n:"PtgRefN",f:C5},45:{n:"PtgAreaN",f:_5},46:{n:"PtgMemAreaN",f:pL},47:{n:"PtgMemNoMemN",f:mL},57:{n:"PtgNameX",f:$5},58:{n:"PtgRef3d",f:N5},59:{n:"PtgArea3d",f:g5},60:{n:"PtgRefErr3d",f:Y5},61:{n:"PtgAreaErr3d",f:x5},255:{}},vL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xL={1:{n:"PtgElfLel",f:JS},2:{n:"PtgElfRw",f:oL},3:{n:"PtgElfCol",f:eL},6:{n:"PtgElfRwV",f:lL},7:{n:"PtgElfColV",f:nL},10:{n:"PtgElfRadical",f:iL},11:{n:"PtgElfRadicalS",f:sL},13:{n:"PtgElfColS",f:tL},15:{n:"PtgElfColSV",f:rL},16:{n:"PtgElfRadicalLel",f:aL},25:{n:"PtgList",f:uL},29:{n:"PtgSxName",f:fL},255:{}},_L={0:{n:"PtgAttrNoop",f:gL},1:{n:"PtgAttrSemi",f:S5},2:{n:"PtgAttrIf",f:T5},4:{n:"PtgAttrChoose",f:w5},8:{n:"PtgAttrGoto",f:E5},16:{n:"PtgAttrSum",f:D5},32:{n:"PtgAttrBaxcel",f:Zy},33:{n:"PtgAttrBaxcel",f:Zy},64:{n:"PtgAttrSpace",f:A5},65:{n:"PtgAttrSpaceSemi",f:I5},128:{n:"PtgAttrIfError",f:k5},255:{}};function Qu(t,e,r,n){if(n.biff<8)return Jr(t,e);for(var i=t.l+e,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=W5(t,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=z5(t,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=t.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return e=i-t.l,e!==0&&a.push(Jr(t,e)),a}function Ju(t,e,r){for(var n=t.l+e,i,a,s=[];n!=t.l;)e=n-t.l,a=t[t.l],i=ew[a]||ew[vL[a]],(a===24||a===25)&&(i=(a===24?xL:_L)[t[t.l+1]]),!i||!i.f?Jr(t,e):s.push([i.n,i.f(t,e,r)]);return s}function yL(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var wL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function EL(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ZS(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function tw(t,e,r){var n=ZS(t,e,r);return n=="#REF"?n:EL(n,r)}function $r(t,e,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,h=0,d=0,p,g="";if(!t[0]||!t[0][0])return"";for(var m=-1,_="",y=0,T=t[0].length;y<T;++y){var w=t[0][y];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:_=Kt(" ",t[0][m][1][1]);break;case 1:_=Kt("\r",t[0][m][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+_,m=-1}o.push(c+wL[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=jc(w[1][1],s,i),o.push(Bc(u,a));break;case"PtgRefN":u=r?jc(w[1][1],r,i):w[1][1],o.push(Bc(u,a));break;case"PtgRef3d":h=w[1][1],u=jc(w[1][2],s,i),g=tw(n,h,i),o.push(g+"!"+Bc(u,a));break;case"PtgFunc":case"PtgFuncVar":var R=w[1][0],j=w[1][1];R||(R=0),R&=127;var D=R==0?[]:o.slice(-R);o.length-=R,j==="User"&&(j=D.shift()),o.push(j+"("+D.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=Ny(w[1][1],r?{s:r}:s,i),o.push(wp(p,i));break;case"PtgArea":p=Ny(w[1][1],s,i),o.push(wp(p,i));break;case"PtgArea3d":h=w[1][1],p=w[1][2],g=tw(n,h,i),o.push(g+"!"+wp(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],S=E?E.Name:"SH33TJSNAME"+String(d);S&&S.slice(0,6)=="_xlfn."&&!i.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var k=w[1][1];d=w[1][2];var I;if(i.biff<=5)k<0&&(k=-k),n[k]&&(I=n[k][d]);else{var b="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][d]&&n[k][d].itab>0&&(b=n.SheetNames[n[k][d].itab-1]+"!"):b=n.SheetNames[d-1]+"!"),n[k]&&n[k][d])b+=n[k][d].Name;else if(n[0]&&n[0][d])b+=n[0][d].Name;else{var N=(ZS(n,k,i)||"").split(";;");N[d-1]?b=N[d-1]:b+="SH33TJSERRX"}o.push(b);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var F="(",he=")";if(m>=0){switch(_="",t[0][m][1][0]){case 2:F=Kt(" ",t[0][m][1][1])+F;break;case 3:F=Kt("\r",t[0][m][1][1])+F;break;case 4:he=Kt(" ",t[0][m][1][1])+he;break;case 5:he=Kt("\r",t[0][m][1][1])+he;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(F+o.pop()+he);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var de={c:r.c,r:r.r};if(n.sharedf[Me(u)]){var Ae=n.sharedf[Me(u)];o.push($r(Ae,s,de,n,i))}else{var ve=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push($r(c[1],s,de,n,i)),ve=!0;break}ve||o.push(w[1])}break;case"PtgArray":o.push("{"+yL(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&le.indexOf(t[0][y][0])==-1){w=t[0][m];var P=!0;switch(w[1][0]){case 4:P=!1;case 0:_=Kt(" ",w[1][1]);break;case 5:P=!1;case 1:_=Kt("\r",w[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((P?_:"")+o.pop()+(P?"":_)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function TL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,s=t.read_shift(i);if(s==65535)return[[],Jr(t,e-2)];var o=Ju(t,s,r);return e!==s+i&&(a=Qu(t,e-s-i,o,r)),t.l=n,[o,a]}function kL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,s=t.read_shift(i);if(s==65535)return[[],Jr(t,e-2)];var o=Ju(t,s,r);return e!==s+i&&(a=Qu(t,e-s-i,o,r)),t.l=n,[o,a]}function SL(t,e,r,n){var i=t.l+e,a=Ju(t,n,r),s;return i!==t.l&&(s=Qu(t,i-t.l,a,r)),[a,s]}function AL(t,e,r){var n=t.l+e,i,a=t.read_shift(2),s=Ju(t,a,r);return a==65535?[[],Jr(t,e-2)]:(e!==a+2&&(i=Qu(t,n-a-2,s,r)),[s,i])}function IL(t){var e;if(Xi(t,t.l+6)!==65535)return[Xr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function bL(t){if(t==null){var e=oe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return eo(t);return eo(0)}function Ap(t,e,r){var n=t.l+e,i=Mi(t);r.biff==2&&++t.l;var a=IL(t),s=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=kL(t,n-t.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function CL(t,e,r,n,i){var a=ro(e,r,i),s=bL(t.v),o=oe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=oe(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var h=yr([a,s,o,c]);return h}function ud(t,e,r){var n=t.read_shift(4),i=Ju(t,n,r),a=t.read_shift(4),s=a>0?Qu(t,a,i,r):null;return[i,s]}var NL=ud,fd=ud,RL=ud,FL=ud,PL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},eA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},DL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function rw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function OL(t){var e="of:="+t.replace(rx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Ip(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function LL(t){return t.replace(/\./,"!")}var Uc={},ll={},zc=typeof Map<"u";function ax(t,e,r){var n=0,i=t.length;if(r){if(zc?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=zc?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(zc?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function hd(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(qr=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Au(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=yh(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function $s(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function xs(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,a=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ta(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=a;++i)if(t[i].numFmtId===n)return i;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function tA(t,e,r,n,i,a){try{n.cellNF&&(t.z=Le[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Pt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Le[e]==null&&ta(P3[e]||"General",e),t.t==="e")t.w=t.w||va[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_u(t.v);else if(t.t==="d"){var s=gr(t.v);(s|0)===s?t.w=s.toString(10):t.w=_u(s)}else{if(t.v===void 0)return"";t.w=Js(t.v,ll)}else t.t==="d"?t.w=Zn(e,gr(t.v),ll):t.w=Zn(e,t.v,ll)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=_h(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=_h(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function ML(t,e,r){if(t&&t["!ref"]){var n=lt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function jL(t,e){var r=lt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=qe(r))}var BL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,VL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,UL=/<(?:\w:)?hyperlink [^>]*>/mg,zL=/"(\w*:\w*)"/,WL=/<(?:\w:)?col\b[^>]*[\/]?>/g,HL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,$L=/<(?:\w:)?pageMargins[^>]*\/>/g,rA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function KL(t,e,r,n,i,a,s){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(VL);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var d=c.match(rA);d?sx(d[0],o,i,r):(d=c.match(GL))&&YL(d[0],d[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(zL);g&&jL(o,g[1])}var m=c.match(qL);m&&m[1]&&c8(m[1],i);var _=[];if(e.cellStyles){var y=c.match(WL);y&&i8(_,y)}h&&h8(h[1],o,e,l,a,s);var T=u.match(HL);T&&(o["!autofilter"]=s8(T[0]));var w=[],R=u.match(BL);if(R)for(p=0;p!=R.length;++p)w[p]=lt(R[p].slice(R[p].indexOf('"')+1));var j=u.match(UL);j&&t8(o,j,n);var D=u.match($L);if(D&&(o["!margins"]=r8(Be(D[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=qe(l)),e.sheetRows>0&&o["!ref"]){var E=lt(o["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=qe(E))}return _.length>0&&(o["!cols"]=_),w.length>0&&(o["!merges"]=w),o}function XL(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+qe(t[r])+'"/>';return e+"</mergeCells>"}function sx(t,e,r,n){var i=Be(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=ot(_t(i.codeName)))}function YL(t,e,r,n,i){sx(t.slice(0,t.indexOf(">")),r,n,i)}function QL(t,e,r,n,i){var a=!1,s={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,s.codeName=Ai(gt(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+we("outlinePr",null,c)}!a&&!o||(i[i.length]=we("sheetPr",o,s))}var JL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ZL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function e8(t){var e={sheet:1};return JL.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),ZL.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Zv(t.password).toString(16).toUpperCase()),we("sheetProtection",null,e)}function t8(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var a=Be(_t(e[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+ot(a.location))):(a.Target="#"+ot(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=lt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Me({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=a)}}}function r8(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function n8(t){return $s(t),we("pageMargins",null,t)}function i8(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Be(e[n],!0);i.hidden&&(i.hidden=Nt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ex(i.width)),os(i);a<=s;)t[a++]=Dt(i)}}function a8(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=we("col",null,hd(i,n)));return r[r.length]="</cols>",r.join("")}function s8(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function o8(t,e,r,n){var i=typeof t.ref=="string"?t.ref:qe(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=kn(i);s.s.r==s.e.r&&(s.e.r=kn(e["!ref"]).e.r,i=qe(s));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),we("autoFilter",null,{ref:i})}var l8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function c8(t,e){e.Views||(e.Views=[{}]),(t.match(l8)||[]).forEach(function(r,n){var i=Be(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Nt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function u8(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,i),{})}function f8(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",a=t.t,s=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=va[t.v];break;case"d":n&&n.cellDates?i=Pt(t.v,-1).toISOString():(t=Dt(t),t.t="n",i=""+(t.v=gr(Pt(t.v)))),typeof t.z>"u"&&(t.z=Le[14]);break;default:i=t.v;break}var o=Nr("v",gt(i)),l={r:e},c=xs(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Nr("v",""+ax(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=a&&(t.t=a,t.v=s),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=we("f",gt(t.f),u)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),we("c",o,l)}var h8=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=yu("v"),s=yu("f");return function(l,c,u,h,d,p){for(var g=0,m="",_=[],y=[],T=0,w=0,R=0,j="",D,E,S=0,k=0,I,b,N=0,F=0,he=Array.isArray(p.CellXf),de,Ae=[],ve=[],le=Array.isArray(c),P=[],Q={},re=!1,O=!!u.sheetStubs,q=l.split(e),H=0,G=q.length;H!=G;++H){m=q[H].trim();var K=m.length;if(K!==0){var ne=0;e:for(g=0;g<K;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(E=Be(m.slice(ne,g),!0),S=E.r!=null?parseInt(E.r,10):S+1,k=-1,u.sheetRows&&u.sheetRows<S)continue;Q={},re=!1,E.ht&&(re=!0,Q.hpt=parseFloat(E.ht),Q.hpx=Al(Q.hpt)),E.hidden=="1"&&(re=!0,Q.hidden=!0),E.outlineLevel!=null&&(re=!0,Q.level=+E.outlineLevel),re&&(P[S-1]=Q)}break;case"<":ne=g;break}if(ne>=g)break;if(E=Be(m.slice(ne,g),!0),S=E.r!=null?parseInt(E.r,10):S+1,k=-1,!(u.sheetRows&&u.sheetRows<S)){h.s.r>S-1&&(h.s.r=S-1),h.e.r<S-1&&(h.e.r=S-1),u&&u.cellStyles&&(Q={},re=!1,E.ht&&(re=!0,Q.hpt=parseFloat(E.ht),Q.hpx=Al(Q.hpt)),E.hidden=="1"&&(re=!0,Q.hidden=!0),E.outlineLevel!=null&&(re=!0,Q.level=+E.outlineLevel),re&&(P[S-1]=Q)),_=m.slice(g).split(t);for(var ae=0;ae!=_.length&&_[ae].trim().charAt(0)=="<";++ae);for(_=_.slice(ae),g=0;g!=_.length;++g)if(m=_[g].trim(),m.length!==0){if(y=m.match(r),T=g,w=0,R=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(T=0,j=y[1],w=0;w!=j.length&&!((R=j.charCodeAt(w)-64)<1||R>26);++w)T=26*T+R;--T,k=T}else++k;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,E=Be(m.slice(0,w),!0),E.r||(E.r=Me({r:S-1,c:k})),j=m.slice(w),D={t:""},(y=j.match(a))!=null&&y[1]!==""&&(D.v=ot(y[1])),u.cellFormula){if((y=j.match(s))!=null&&y[1]!==""){if(D.f=ot(_t(y[1])).replace(/\r\n/g,`
`),u.xlfn||(D.f=Jy(D.f)),y[0].indexOf('t="array"')>-1)D.F=(j.match(i)||[])[1],D.F.indexOf(":")>-1&&Ae.push([lt(D.F),D.F]);else if(y[0].indexOf('t="shared"')>-1){b=Be(y[0]);var ue=ot(_t(y[1]));u.xlfn||(ue=Jy(ue)),ve[parseInt(b.si,10)]=[b,ue,E.r]}}else(y=j.match(/<f[^>]*\/>/))&&(b=Be(y[0]),ve[b.si]&&(D.f=l5(ve[b.si][1],ve[b.si][2],E.r)));var ce=Ut(E.r);for(w=0;w<Ae.length;++w)ce.r>=Ae[w][0].s.r&&ce.r<=Ae[w][0].e.r&&ce.c>=Ae[w][0].s.c&&ce.c<=Ae[w][0].e.c&&(D.F=Ae[w][1])}if(E.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(O)D.t="z";else continue;else D.t=E.t||"n";switch(h.s.c>k&&(h.s.c=k),h.e.c<k&&(h.e.c=k),D.t){case"n":if(D.v==""||D.v==null){if(!O)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!O)continue;D.t="z"}else I=Uc[parseInt(D.v,10)],D.v=I.t,D.r=I.r,u.cellHTML&&(D.h=I.h);break;case"str":D.t="s",D.v=D.v!=null?_t(D.v):"",u.cellHTML&&(D.h=jv(D.v));break;case"inlineStr":y=j.match(n),D.t="s",y!=null&&(I=Jv(y[1]))?(D.v=I.t,u.cellHTML&&(D.h=I.h)):D.v="";break;case"b":D.v=Nt(D.v);break;case"d":u.cellDates?D.v=Pt(D.v,1):(D.v=gr(Pt(D.v,1)),D.t="n");break;case"e":(!u||u.cellText!==!1)&&(D.w=D.v),D.v=iS[D.v];break}if(N=F=0,de=null,he&&E.s!==void 0&&(de=p.CellXf[E.s],de!=null&&(de.numFmtId!=null&&(N=de.numFmtId),u.cellStyles&&de.fillId!=null&&(F=de.fillId))),tA(D,N,F,u,d,p),u.cellDates&&he&&D.t=="n"&&jl(Le[N])&&(D.t="d",D.v=ld(D.v)),E.cm&&u.xlmeta){var De=(u.xlmeta.Cell||[])[+E.cm-1];De&&De.type=="XLDAPR"&&(D.D=!0)}if(le){var W=Ut(E.r);c[W.r]||(c[W.r]=[]),c[W.r][W.c]=D}else c[E.r]=D}}}}P.length>0&&(c["!rows"]=P)}}();function d8(t,e,r,n){var i=[],a=[],s=lt(t["!ref"]),o="",l,c="",u=[],h=0,d=0,p=t["!rows"],g=Array.isArray(t),m={r:c},_,y=-1;for(d=s.s.c;d<=s.e.c;++d)u[d]=Vt(d);for(h=s.s.r;h<=s.e.r;++h){for(a=[],c=er(h),d=s.s.c;d<=s.e.c;++d){l=u[d]+c;var T=g?(t[h]||[])[d]:t[l];T!==void 0&&(o=f8(T,l,t,e))!=null&&a.push(o)}(a.length>0||p&&p[h])&&(m={r:c},p&&p[h]&&(_=p[h],_.hidden&&(m.hidden=1),y=-1,_.hpx?y=Iu(_.hpx):_.hpt&&(y=_.hpt),y>-1&&(m.ht=y,m.customHeight=1),_.level&&(m.outlineLevel=_.level)),i[i.length]=we("row",a.join(""),m))}if(p)for(;h<p.length;++h)p&&p[h]&&(m={r:h+1},_=p[h],_.hidden&&(m.hidden=1),y=-1,_.hpx?y=Iu(_.hpx):_.hpt&&(y=_.hpt),y>-1&&(m.ht=y,m.customHeight=1),_.level&&(m.outlineLevel=_.level),i[i.length]=we("row","",m));return i.join("")}function nA(t,e,r,n){var i=[rr,we("worksheet",null,{xmlns:po[0],"xmlns:r":dr.r})],a=r.SheetNames[t],s=0,o="",l=r.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",u=lt(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=qe(u)}n||(n={}),l["!comments"]=[];var h=[];QL(l,r,t,e,i),i[i.length]=we("dimension",null,{ref:c}),i[i.length]=u8(l,e,t,r),e.sheetFormat&&(i[i.length]=we("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=a8(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=d8(l,e),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=e8(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=o8(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=XL(l["!merges"]));var d=-1,p,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=mt(n,-1,gt(m[1].Target).replace(/#.*$/,""),Ze.HLINK),p["r:id"]="rId"+g),(d=m[1].Target.indexOf("#"))>-1&&(p.location=gt(m[1].Target.slice(d+1))),m[1].Tooltip&&(p.tooltip=gt(m[1].Tooltip)),i[i.length]=we("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=n8(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Nr("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=mt(n,-1,"../drawings/drawing"+(t+1)+".xml",Ze.DRAW),i[i.length]=we("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=mt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ze.VML),i[i.length]=we("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function p8(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function m8(t,e,r){var n=oe(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;i.hpx?a=Iu(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,d=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Me(c)];g&&(h<0&&(h=p),d=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function g8(t,e,r,n){var i=m8(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&pe(t,0,i)}var v8=xo,x8=Ul;function _8(){}function y8(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=TF(t),r}function w8(t,e,r){r==null&&(r=oe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return gh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Zk(t,r),r.slice(0,r.l)}function E8(t){var e=ei(t);return[e]}function T8(t,e,r){return r==null&&(r=oe(8)),mo(e,r)}function k8(t){var e=go(t);return[e]}function S8(t,e,r){return r==null&&(r=oe(4)),vo(e,r)}function A8(t){var e=ei(t),r=t.read_shift(1);return[e,r,"b"]}function I8(t,e,r){return r==null&&(r=oe(9)),mo(e,r),r.write_shift(1,t.v?1:0),r}function b8(t){var e=go(t),r=t.read_shift(1);return[e,r,"b"]}function C8(t,e,r){return r==null&&(r=oe(5)),vo(e,r),r.write_shift(1,t.v?1:0),r}function N8(t){var e=ei(t),r=t.read_shift(1);return[e,r,"e"]}function R8(t,e,r){return r==null&&(r=oe(9)),mo(e,r),r.write_shift(1,t.v),r}function F8(t){var e=go(t),r=t.read_shift(1);return[e,r,"e"]}function P8(t,e,r){return r==null&&(r=oe(8)),vo(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function D8(t){var e=ei(t),r=t.read_shift(4);return[e,r,"s"]}function O8(t,e,r){return r==null&&(r=oe(12)),mo(e,r),r.write_shift(4,e.v),r}function L8(t){var e=go(t),r=t.read_shift(4);return[e,r,"s"]}function M8(t,e,r){return r==null&&(r=oe(8)),vo(e,r),r.write_shift(4,e.v),r}function j8(t){var e=ei(t),r=Xr(t);return[e,r,"n"]}function B8(t,e,r){return r==null&&(r=oe(16)),mo(e,r),eo(t.v,r),r}function iA(t){var e=go(t),r=Xr(t);return[e,r,"n"]}function V8(t,e,r){return r==null&&(r=oe(12)),vo(e,r),eo(t.v,r),r}function U8(t){var e=ei(t),r=qv(t);return[e,r,"n"]}function z8(t,e,r){return r==null&&(r=oe(12)),mo(e,r),eS(t.v,r),r}function W8(t){var e=go(t),r=qv(t);return[e,r,"n"]}function H8(t,e,r){return r==null&&(r=oe(8)),vo(e,r),eS(t.v,r),r}function $8(t){var e=ei(t),r=Hv(t);return[e,r,"is"]}function G8(t){var e=ei(t),r=Yr(t);return[e,r,"str"]}function q8(t,e,r){return r==null&&(r=oe(12+4*t.v.length)),mo(e,r),wr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function K8(t){var e=go(t),r=Yr(t);return[e,r,"str"]}function X8(t,e,r){return r==null&&(r=oe(8+4*t.v.length)),vo(e,r),wr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Y8(t,e,r){var n=t.l+e,i=ei(t);i.r=r["!row"];var a=t.read_shift(1),s=[i,a,"b"];if(r.cellFormula){t.l+=2;var o=fd(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}function Q8(t,e,r){var n=t.l+e,i=ei(t);i.r=r["!row"];var a=t.read_shift(1),s=[i,a,"e"];if(r.cellFormula){t.l+=2;var o=fd(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}function J8(t,e,r){var n=t.l+e,i=ei(t);i.r=r["!row"];var a=Xr(t),s=[i,a,"n"];if(r.cellFormula){t.l+=2;var o=fd(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}function Z8(t,e,r){var n=t.l+e,i=ei(t);i.r=r["!row"];var a=Yr(t),s=[i,a,"str"];if(r.cellFormula){t.l+=2;var o=fd(t,n-t.l,r);s[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return s}var eM=xo,tM=Ul;function rM(t,e){return e==null&&(e=oe(4)),e.write_shift(4,t),e}function nM(t,e){var r=t.l+e,n=xo(t),i=$v(t),a=Yr(t),s=Yr(t),o=Yr(t);t.l=r;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function iM(t,e){var r=oe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Ul({s:Ut(t[0]),e:Ut(t[0])},r),Gv("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return wr(i||"",r),wr(t[1].Tooltip||"",r),wr("",r),r.slice(0,r.l)}function aM(){}function sM(t,e,r){var n=t.l+e,i=tS(t),a=t.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=NL(t,n-t.l,r);s[1]=o}else t.l=n;return s}function oM(t,e,r){var n=t.l+e,i=xo(t),a=[i];if(r.cellFormula){var s=FL(t,n-t.l,r);a[1]=s,t.l=n}else t.l=n;return a}function lM(t,e,r){r==null&&(r=oe(18));var n=hd(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var aA=["left","right","top","bottom","header","footer"];function cM(t){var e={};return aA.forEach(function(r){e[r]=Xr(t)}),e}function uM(t,e){return e==null&&(e=oe(6*8)),$s(t),aA.forEach(function(r){eo(t[r],e)}),e}function fM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function hM(t,e,r){r==null&&(r=oe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function dM(t){var e=oe(24);return e.write_shift(4,4),e.write_shift(4,1),Ul(t,e),e}function pM(t,e){return e==null&&(e=oe(16*4+2)),e.write_shift(2,t.password?Zv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function mM(){}function gM(){}function vM(t,e,r,n,i,a,s){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,g,m,_,y,T,w,R,j,D=[];o.biff=12,o["!row"]=0;var E=0,S=!1,k=[],I={},b=o.supbooks||i.supbooks||[[]];if(b.sharedf=I,b.arrayf=k,b.SheetNames=i.SheetNames||i.Sheets.map(function(le){return le.name}),!o.supbooks&&(o.supbooks=b,i.Names))for(var N=0;N<i.Names.length;++N)b[0][N+1]=i.Names[N];var F=[],he=[],de=!1;bu[16]={n:"BrtShortReal",f:iA};var Ae;if(ga(t,function(P,Q,re){if(!d)switch(re){case 148:c=P;break;case 0:p=P,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),R=er(_=p.r),o["!row"]=p.r,(P.hidden||P.hpt||P.level!=null)&&(P.hpt&&(P.hpx=Al(P.hpt)),he[P.r]=P);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:P[2]},P[2]){case"n":g.v=P[1];break;case"s":w=Uc[P[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!P[1];break;case"e":g.v=P[1],o.cellText!==!1&&(g.w=va[g.v]);break;case"str":g.t="s",g.v=P[1];break;case"is":g.t="s",g.v=P[1].t;break}if((m=s.CellXf[P[0].iStyleRef])&&tA(g,m.numFmtId,null,o,a,s),y=P[0].c==-1?y+1:P[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=g):l[Vt(y)+R]=g,o.cellFormula){for(S=!1,E=0;E<k.length;++E){var O=k[E];p.r>=O[0].s.r&&p.r<=O[0].e.r&&y>=O[0].s.c&&y<=O[0].e.c&&(g.F=qe(O[0]),S=!0)}!S&&P.length>3&&(g.f=P[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>y&&(u.s.c=y),u.e.r<p.r&&(u.e.r=p.r),u.e.c<y&&(u.e.c=y),o.cellDates&&m&&g.t=="n"&&jl(Le[m.numFmtId])){var q=js(g.v);q&&(g.t="d",g.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},y=P[0].c==-1?y+1:P[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=g):l[Vt(y)+R]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>y&&(u.s.c=y),u.e.r<p.r&&(u.e.r=p.r),u.e.c<y&&(u.e.c=y),Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 176:D.push(P);break;case 49:Ae=((o.xlmeta||{}).Cell||[])[P-1];break;case 494:var H=n["!id"][P.relId];for(H?(P.Target=H.Target,P.loc&&(P.Target+="#"+P.loc),P.Rel=H):P.relId==""&&(P.Target="#"+P.loc),_=P.rfx.s.r;_<=P.rfx.e.r;++_)for(y=P.rfx.s.c;y<=P.rfx.e.c;++y)o.dense?(l[_]||(l[_]=[]),l[_][y]||(l[_][y]={t:"z",v:void 0}),l[_][y].l=P):(T=Me({c:y,r:_}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=P);break;case 426:if(!o.cellFormula)break;k.push(P),j=o.dense?l[_][y]:l[Vt(y)+R],j.f=$r(P[1],u,{r:p.r,c:y},b,o),j.F=qe(P[0]);break;case 427:if(!o.cellFormula)break;I[Me(P[0].s)]=P[1],j=o.dense?l[_][y]:l[Vt(y)+R],j.f=$r(P[1],u,{r:p.r,c:y},b,o);break;case 60:if(!o.cellStyles)break;for(;P.e>=P.s;)F[P.e--]={width:P.w/256,hidden:!!(P.flags&1),level:P.level},de||(de=!0,ex(P.w/256)),os(F[P.e+1]);break;case 161:l["!autofilter"]={ref:qe(P)};break;case 476:l["!margins"]=P;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),P.name&&(i.Sheets[r].CodeName=P.name),(P.above||P.left)&&(l["!outline"]={above:P.above,left:P.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),P.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Q.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=qe(c||u)),o.sheetRows&&l["!ref"]){var ve=lt(l["!ref"]);o.sheetRows<=+ve.e.r&&(ve.e.r=o.sheetRows-1,ve.e.r>u.e.r&&(ve.e.r=u.e.r),ve.e.r<ve.s.r&&(ve.s.r=ve.e.r),ve.e.c>u.e.c&&(ve.e.c=u.e.c),ve.e.c<ve.s.c&&(ve.s.c=ve.e.c),l["!fullref"]=l["!ref"],l["!ref"]=qe(ve))}return D.length>0&&(l["!merges"]=D),F.length>0&&(l["!cols"]=F),he.length>0&&(l["!rows"]=he),l}function xM(t,e,r,n,i,a,s){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Dt(e),e.z=e.z||Le[14],e.v=gr(Pt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=xs(i.cellXfs,e,i),e.l&&a["!links"].push([Me(l),e.l]),e.c&&a["!comments"].push([Me(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=ax(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,s?pe(t,18,M8(e,l)):pe(t,7,O8(e,l))):(l.t="str",s?pe(t,17,X8(e,l)):pe(t,6,q8(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?s?pe(t,13,H8(e,l)):pe(t,2,z8(e,l)):s?pe(t,16,V8(e,l)):pe(t,5,B8(e,l)),!0;case"b":return l.t="b",s?pe(t,15,C8(e,l)):pe(t,4,I8(e,l)),!0;case"e":return l.t="e",s?pe(t,14,P8(e,l)):pe(t,3,R8(e,l)),!0}return s?pe(t,12,S8(e,l)):pe(t,1,T8(e,l)),!0}function _M(t,e,r,n){var i=lt(e["!ref"]||"A1"),a,s="",o=[];pe(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=er(u),g8(t,e,i,u);var h=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=Vt(d)),a=o[d]+s;var p=l?(e[u]||[])[d]:e[a];if(!p){h=!1;continue}h=xM(t,p,u,d,n,e,h)}}pe(t,146)}function yM(t,e){!e||!e["!merges"]||(pe(t,177,rM(e["!merges"].length)),e["!merges"].forEach(function(r){pe(t,176,tM(r))}),pe(t,178))}function wM(t,e){!e||!e["!cols"]||(pe(t,390),e["!cols"].forEach(function(r,n){r&&pe(t,60,lM(n,r))}),pe(t,391))}function EM(t,e){!e||!e["!ref"]||(pe(t,648),pe(t,649,dM(lt(e["!ref"]))),pe(t,650))}function TM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=mt(r,-1,n[1].Target.replace(/#.*$/,""),Ze.HLINK);pe(t,494,iM(n,i))}}),delete e["!links"]}function kM(t,e,r,n){if(e["!comments"].length>0){var i=mt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ze.VML);pe(t,551,Gv("rId"+i)),e["!legacy"]=i}}function SM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],a=typeof i.ref=="string"?i.ref:qe(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=kn(a);o.s.r==o.e.r&&(o.e.r=kn(e["!ref"]).e.r,a=qe(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),pe(t,161,Ul(lt(a))),pe(t,162)}}function AM(t,e,r){pe(t,133),pe(t,137,hM(e,r)),pe(t,138),pe(t,134)}function IM(t,e){e["!protect"]&&pe(t,535,pM(e["!protect"]))}function bM(t,e,r,n){var i=wn(),a=r.SheetNames[t],s=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=lt(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],pe(i,129),(r.vbaraw||s["!outline"])&&pe(i,147,w8(o,s["!outline"])),pe(i,148,x8(l)),AM(i,s,r.Workbook),wM(i,s),_M(i,s,t,e),IM(i,s),SM(i,s,r,t),yM(i,s),TM(i,s,n),s["!margins"]&&pe(i,476,uM(s["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&EM(i,s),kM(i,s,t,n),pe(i,130),i.end()}function CM(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(e[+s[1]]=r?+s[2]:s[2])});var i=ot((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,i,n]}function NM(t,e,r,n,i,a){var s=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=CM(h);u.s.r=u.s.c=0,u.e.c=o,c=Vt(o),d[0].forEach(function(p,g){s[c+er(g)]={t:"n",v:p,z:d[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=qe(u)),s}function RM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=t.match(rA);return o&&sx(o[0],a,i,r),(s=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function FM(t,e){t.l+=10;var r=Yr(t);return{name:r}}function PM(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ga(t,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var ox=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],DM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],OM=[],LM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function nw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var a=e[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Nt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function iw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Nt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function sA(t){iw(t.WBProps,ox),iw(t.CalcPr,LM),nw(t.WBView,DM),nw(t.Sheets,OM),ll.date1904=Nt(t.WBProps.date1904)}function MM(t){return!t.Workbook||!t.Workbook.WBProps?"false":Nt(t.Workbook.WBProps.date1904)?"true":"false"}var jM="][*?/\\".split("");function oA(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return jM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function BM(t,e,r){t.forEach(function(n,i){oA(n);for(var a=0;a<i;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=e&&e[i]&&e[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function VM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];BM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)ML(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var UM=/<\w+:workbook/;function zM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(t.replace(en,function(l,c){var u=Be(l);switch(Li(u[0])){case"<?xml":break;case"<workbook":l.match(UM)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ox.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Nt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=_t(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ot(_t(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=_t(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Nt(u.hidden||"0")&&(a.Hidden=!0),s=c+l.length;break;case"</definedName>":a.Ref=ot(_t(t.slice(s,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),po.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return sA(r),r}function lA(t){var e=[rr];e[e.length]=we("workbook",null,{xmlns:po[0],"xmlns:r":dr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(ox.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=we("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var s={name:gt(t.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}e[e.length]=we("sheet",null,s)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=we("definedName",gt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function WM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=$m(t),r.name=Yr(t),r}function HM(t,e){return e||(e=oe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Gv(t.strRelID,e),wr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function $M(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Yr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function GM(t,e){e||(e=oe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Zk(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function qM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function KM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),a=kF(t),s=RL(t,0,r),o=$v(t);t.l=n;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function XM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],bu[16]={n:"BrtFRTArchID$",f:qM},ga(t,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=$r(l.Ptg,null,null,s,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),sA(r),r.Names=a,r.supbooks=s,r}function YM(t,e){pe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};pe(t,156,HM(i))}pe(t,144)}function QM(t,e){e||(e=oe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return wr("SheetJS",e),wr(ch.version,e),wr(ch.version,e),wr("7262",e),e.length>e.l?e.slice(0,e.l):e}function JM(t,e){e||(e=oe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function ZM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(pe(t,135),pe(t,158,JM(i)),pe(t,136))}}function e9(t,e){var r=wn();return pe(r,131),pe(r,128,QM()),pe(r,153,GM(t.Workbook&&t.Workbook.WBProps||null)),ZM(r,t),YM(r,t),pe(r,132),r.end()}function t9(t,e,r){return e.slice(-4)===".bin"?XM(t,r):zM(t,r)}function r9(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?vM(t,n,r,i,a,s,o):KL(t,n,r,i,a,s,o)}function n9(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?PM(t,n,r,i,a):RM(t,n,r,i,a)}function i9(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?s5():o5()}function a9(t,e,r,n,i,a,s,o){return e.slice(-4)===".bin"?i5():a5()}function s9(t,e,r,n){return e.slice(-4)===".bin"?t6(t,r,n):WO(t,r,n)}function o9(t,e,r){return zS(t,r)}function l9(t,e,r){return e.slice(-4)===".bin"?lO(t,r):aO(t,r)}function c9(t,e,r){return e.slice(-4)===".bin"?Z6(t,r):H6(t,r)}function u9(t,e,r){return e.slice(-4)===".bin"?U6(t):B6(t)}function f9(t,e,r,n){return r.slice(-4)===".bin"?z6(t,e,r,n):void 0}function h9(t,e,r){return e.slice(-4)===".bin"?L6(t,e,r):j6(t,e,r)}function d9(t,e,r){return(e.slice(-4)===".bin"?e9:lA)(t)}function p9(t,e,r,n,i){return(e.slice(-4)===".bin"?bM:nA)(t,r,n,i)}function m9(t,e,r){return(e.slice(-4)===".bin"?f6:VS)(t,r)}function g9(t,e,r){return(e.slice(-4)===".bin"?fO:FS)(t,r)}function v9(t,e,r){return(e.slice(-4)===".bin"?e5:$S)(t)}function x9(t){return(t.slice(-4)===".bin"?M6:WS)()}var cA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,uA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ni(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(cA),a,s,o,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(uA),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function _9(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(cA),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(uA),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var Wc;function y9(t,e){var r=Wc[t]||ot(t);return r==="General"?Js(e):Zn(r,e)}function w9(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Nt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Pt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ot(e)]=i}function E9(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||va[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_u(t.v):t.w=Js(t.v):t.w=y9(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=Wc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&jl(n)){var i=js(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function T9(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=OO[n.Pattern]||n.Pattern)}t[e.ID]=e}function k9(t,e,r,n,i,a,s,o,l,c){var u="General",h=n.StyleID,d={};c=c||{};var p=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);a[h]!==void 0&&(a[h].nf&&(u=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Nt(t);break;case"String":n.t="s",n.r=wy(ot(t)),n.v=t.indexOf("<")>-1?ot(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Pt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ot(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=iS[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=wy(e||t));break}if(E9(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=ot(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ol(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ol("RC:RC",i):n.ArrayRange&&(n.F=ol(n.ArrayRange,i),l.push([lt(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function S9(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function bp(t,e){var r=e||{};Bl();var n=xc(Bv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=_t(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Dt(r);return s.type="string",Sl.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(wt){i.indexOf("<"+wt)>=0&&(a=!0)}),a)return u7(n,r);Wc={"General Number":"General","General Date":Le[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Le[15],"Short Date":Le[14],"Long Time":Le[19],"Medium Time":Le[18],"Short Time":Le[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Le[2],Standard:Le[4],Percent:Le[10],Scientific:Le[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],d=r.dense?[]:{},p="",g={},m={},_=ni('<Data ss:Type="String">'),y=0,T=0,w=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},D={},E="",S=0,k=[],I={},b={},N=0,F=[],he=[],de={},Ae=[],ve,le=!1,P=[],Q=[],re={},O=0,q=0,H={Sheets:[],WBProps:{date1904:!1}},G={};Eu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=Eu.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?k9(n.slice(y,o.index),E,_,l[l.length-1][0]=="comment"?de:g,{c:T,r:w},j,Ae[T],m,P,r):(E="",_=ni(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(he.length>0&&(g.c=he),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][T]=g):d[Vt(T)+er(w)]=g),g.HRef&&(g.l={Target:ot(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(O=T+(parseInt(g.MergeAcross,10)|0),q=w+(parseInt(g.MergeDown,10)|0),k.push({s:{c:T,r:w},e:{c:O,r:q}})),!r.sheetStubs)g.MergeAcross?T=O+1:++T;else if(g.MergeAcross||g.MergeDown){for(var ne=T;ne<=O;++ne)for(var ae=w;ae<=q;++ae)(ne>T||ae>w)&&(r.dense?(d[ae]||(d[ae]=[]),d[ae][ne]={t:"z"}):d[Vt(ne)+er(ae)]={t:"z"});T=O+1}else++T;else g=_9(o[0]),g.Index&&(T=+g.Index-1),T<R.s.c&&(R.s.c=T),T>R.e.c&&(R.e.c=T),o[0].slice(-2)==="/>"&&++T,he=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<R.s.r&&(R.s.r=w),w>R.e.r&&(R.e.r=w),o[0].slice(-2)==="/>"&&(m=ni(o[0]),m.Index&&(w=+m.Index-1)),T=0,++w):(m=ni(o[0]),m.Index&&(w=+m.Index-1),re={},(m.AutoFitHeight=="0"||m.Height)&&(re.hpx=parseInt(m.Height,10),re.hpt=Iu(re.hpx),Q[w]=re),m.Hidden=="1"&&(re.hidden=!0,Q[w]=re));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(d["!ref"]=qe(R),r.sheetRows&&r.sheetRows<=R.e.r&&(d["!fullref"]=d["!ref"],R.e.r=r.sheetRows-1,d["!ref"]=qe(R))),k.length&&(d["!merges"]=k),Ae.length>0&&(d["!cols"]=Ae),Q.length>0&&(d["!rows"]=Q),u[p]=d}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=T=0,l.push([o[3],!1]),c=ni(o[0]),p=ot(c.Name),d=r.dense?[]:{},k=[],P=[],Q=[],G={name:p,Hidden:0},H.Sheets.push(G);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Ae=[],le=!1}break;case"style":o[1]==="/"?T9(j,D,r):D=ni(o[0]);break;case"numberformat":D.nf=ot(ni(o[0]).Format||"General"),Wc[D.nf]&&(D.nf=Wc[D.nf]);for(var ue=0;ue!=392&&Le[ue]!=D.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(Le[ue]==null){ta(D.nf,ue);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ve=ni(o[0]),ve.Hidden&&(ve.hidden=!0,delete ve.Hidden),ve.Width&&(ve.wpx=parseInt(ve.Width,10)),!le&&ve.wpx>10){le=!0,qr=jS;for(var ce=0;ce<Ae.length;++ce)Ae[ce]&&os(Ae[ce])}le&&os(ve),Ae[ve.Index-1||Ae.length]=ve;for(var De=0;De<+ve.Span;++De)Ae[Ae.length]=Dt(ve);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var W=Be(o[0]),ct={Name:W.Name,Ref:ol(W.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(ct.Sheet=H.Sheets.length-1),H.Names.push(ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=ni(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?XF(I,K,n.slice(N,o.index)):N=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));S9(de),he.push(de)}else l.push([o[3],!1]),c=ni(o[0]),de={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ke=ni(o[0]);d["!autofilter"]={ref:ol(Ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return cw(n,r);var nt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:nt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:nt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:nt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:nt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(N,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else N=o.index+o[0].length;break;case"header":d["!margins"]||$s(d["!margins"]={},"xlml"),isNaN(+Be(o[0]).Margin)||(d["!margins"].header=+Be(o[0]).Margin);break;case"footer":d["!margins"]||$s(d["!margins"]={},"xlml"),isNaN(+Be(o[0]).Margin)||(d["!margins"].footer=+Be(o[0]).Margin);break;case"pagemargins":var Ge=Be(o[0]);d["!margins"]||$s(d["!margins"]={},"xlml"),isNaN(+Ge.Top)||(d["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(d["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(d["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(d["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:nt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:nt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:nt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:nt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:nt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:nt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:nt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:nt=!1}break;case"smarttags":break;default:nt=!1;break}if(nt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?w9(b,K,F,n.slice(N,o.index)):(F=o,N=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Te={};return!r.bookSheets&&!r.bookProps&&(Te.Sheets=u),Te.SheetNames=h,Te.Workbook=H,Te.SSF=Dt(Le),Te.Props=I,Te.Custprops=b,Te}function Jm(t,e){switch(cx(e=e||{}),e.type||"base64"){case"base64":return bp(Mn(t),e);case"binary":case"buffer":case"file":return bp(t,e);case"array":return bp(gs(t),e)}}function A9(t,e){var r=[];return t.Props&&r.push(YF(t.Props,e)),t.Custprops&&r.push(QF(t.Props,t.Custprops)),r.join("")}function I9(){return""}function b9(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var a=[];a.push(we("NumberFormat",null,{"ss:Format":gt(Le[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};r.push(we("Style",a.join(""),s))}),we("Styles",r.join(""))}function fA(t){return we("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+nx(t.Ref,{r:0,c:0})})}function C9(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(fA(i)))}return we("Names",r.join(""))}function N9(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(fA(o)))}return a.join("")}function R9(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(we("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(we("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(we("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(we("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Nr("ProtectContents","True")),t["!protect"].objects&&i.push(Nr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Nr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Nr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Nr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){t["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":we("WorksheetOptions",i.join(""),{xmlns:Cn.x})}function F9(t){return t.map(function(e){var r=Z3(e.t||""),n=we("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",n,{"ss:Author":e.a})}).join("")}function P9(t,e,r,n,i,a,s){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+gt(nx(t.f,s))),t.F&&t.F.slice(0,e.length)==e){var l=Ut(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=gt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=gt(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(t.v);break;case"b":h="Boolean",d=t.v?"1":"0";break;case"e":h="Error",d=va[t.v];break;case"d":h="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Le[14]);break;case"s":h="String",d=J3(t.v||"");break}var p=xs(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=s.c+1;var g=t.v!=null?d:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(m+=F9(t.c)),we("Cell",m,o)}function D9(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Al(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function O9(t,e,r,n){if(!t["!ref"])return"";var i=lt(t["!ref"]),a=t["!merges"]||[],s=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,y){os(_);var T=!!_.width,w=hd(y,_),R={"ss:Index":y+1};T&&(R["ss:Width"]=Su(w.width)),_.hidden&&(R["ss:Hidden"]="1"),o.push(we("Column",null,R))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[D9(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>h)&&!(a[s].s.r>c)&&!(a[s].e.c<h)&&!(a[s].e.r<c)){(a[s].s.c!=h||a[s].s.r!=c)&&(d=!0);break}if(!d){var p={r:c,c:h},g=Me(p),m=l?(t[c]||[])[h]:t[g];u.push(P9(m,g,t,e,r,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function L9(t,e,r){var n=[],i=r.SheetNames[t],a=r.Sheets[i],s=a?N9(a,e,t,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?O9(a,e,t,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(R9(a,e,t,r)),n.join("")}function M9(t,e){e||(e={}),t.SSF||(t.SSF=Dt(Le)),t.SSF&&(Bl(),ad(t.SSF),e.revssf=od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],xs(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(A9(t,e)),r.push(I9()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(we("Worksheet",L9(n,e,t),{"ss:Name":gt(t.SheetNames[n])}));return r[2]=b9(t,e),r[3]=C9(t),rr+we("Workbook",r.join(""),{xmlns:Cn.ss,"xmlns:o":Cn.o,"xmlns:x":Cn.x,"xmlns:ss":Cn.ss,"xmlns:dt":Cn.dt,"xmlns:html":Cn.html})}function j9(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=CF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=NF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var B9=[60,1084,2066,2165,2175];function V9(t,e,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var l=Xi(r,r.l),c=Zm[l],u=0;c!=null&&B9.indexOf(l)>-1;)a=Xi(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),s.push(o),r.l+=4+a,c=Zm[l=Xi(r,r.l)];var h=yr(s);Cr(h,0);var d=0;h.lens=[];for(var p=0;p<s.length;++p)h.lens.push(d),d+=s[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function wi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Le[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||va[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_u(t.v):t.w=Js(t.v):t.w=Zn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&jl(Le[n]||String(n))){var i=js(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function a0(t,e,r){return{v:t,ixfe:e,t:r}}function U9(t,e){var r={opts:{}},n={},i=e.dense?[]:{},a={},s={},o=null,l=[],c="",u={},h,d="",p,g,m,_,y={},T=[],w,R,j=[],D=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},k=function(je){return je<8?zs[je]:je<64&&D[je-8]||zs[je]},I=function(je,Et,$t){var At=Et.XF.data;if(!(!At||!At.patternType||!$t||!$t.cellStyles)){Et.s={},Et.s.patternType=At.patternType;var tn;(tn=ku(k(At.icvFore)))&&(Et.s.fgColor={rgb:tn}),(tn=ku(k(At.icvBack)))&&(Et.s.bgColor={rgb:tn})}},b=function(je,Et,$t){if(!(re>1)&&!($t.sheetRows&&je.r>=$t.sheetRows)){if($t.cellStyles&&Et.XF&&Et.XF.data&&I(je,Et,$t),delete Et.ixfe,delete Et.XF,h=je,d=Me(je),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),je.r<s.s.r&&(s.s.r=je.r),je.c<s.s.c&&(s.s.c=je.c),je.r+1>s.e.r&&(s.e.r=je.r+1),je.c+1>s.e.c&&(s.e.c=je.c+1),$t.cellFormula&&Et.f){for(var At=0;At<T.length;++At)if(!(T[At][0].s.c>je.c||T[At][0].s.r>je.r)&&!(T[At][0].e.c<je.c||T[At][0].e.r<je.r)){Et.F=qe(T[At][0]),(T[At][0].s.c!=je.c||T[At][0].s.r!=je.r)&&delete Et.f,Et.f&&(Et.f=""+$r(T[At][1],s,je,P,N));break}}$t.dense?(i[je.r]||(i[je.r]=[]),i[je.r][je.c]=Et):i[d]=Et}},N={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var F,he=[],de=[],Ae=[],ve=[],le=!1,P=[];P.SheetNames=N.snames,P.sharedf=N.sharedf,P.arrayf=N.arrayf,P.names=[],P.XTI=[];var Q=0,re=0,O=0,q=[],H=[],G;N.codepage=1200,oi(1200);for(var K=!1;t.l<t.length-1;){var ne=t.l,ae=t.read_shift(2);if(ae===0&&Q===10)break;var ue=t.l===t.length?0:t.read_shift(2),ce=Zm[ae];if(ce&&ce.f){if(e.bookSheets&&Q===133&&ae!==133)break;if(Q=ae,ce.r===2||ce.r==12){var De=t.read_shift(2);if(ue-=2,!N.enc&&De!==ae&&((De&255)<<8|De>>8)!==ae)throw new Error("rt mismatch: "+De+"!="+ae);ce.r==12&&(t.l+=10,ue-=10)}var W={};if(ae===10?W=ce.f(t,ue,N):W=V9(ae,ce,t,ue,N),re==0&&[9,521,1033,2057].indexOf(Q)===-1)continue;switch(ae){case 34:r.opts.Date1904=E.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=W,!e.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=W;break;case 66:var ct=Number(W);switch(ct){case 21010:ct=1200;break;case 32768:ct=1e4;break;case 32769:ct=1252;break}oi(N.codepage=ct),K=!0;break;case 317:N.rrtabid=W;break;case 25:N.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:N.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(i["!type"]="dialog"),W.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),W.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:j.push(W);break;case 430:P.push([W]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(W);break;case 24:case 536:G={Name:W.Name,Ref:$r(W.rgce,s,null,P,N)},W.itab>0&&(G.Sheet=W.itab-1),P.names.push(G),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(H[W.itab-1]={ref:qe(W.rgce[0][0][1][2])});break;case 22:N.ExternCount=W;break;case 23:P.length==0&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(W),P.XTI=P.XTI.concat(W);break;case 2196:if(N.biff<8)break;G!=null&&(G.Comment=W[1]);break;case 18:i["!protect"]=W;break;case 19:W!==0&&N.WTF&&console.error("Password verifier: "+W);break;case 133:a[W.pos]=W,N.snames.push(W.name);break;case 10:{if(--re)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=qe(s),e.sheetRows&&e.sheetRows<=s.e.r){var Ke=s.e.r;s.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=qe(s),s.e.r=Ke}s.e.r++,s.e.c++}he.length>0&&(i["!merges"]=he),de.length>0&&(i["!objects"]=de),Ae.length>0&&(i["!cols"]=Ae),ve.length>0&&(i["!rows"]=ve),E.Sheets.push(S)}c===""?u=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),N.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(N.biff=5,K=!0,oi(N.codepage=28591)),N.biff==8&&W.BIFFVer==0&&W.dt==16&&(N.biff=2),re++)break;if(i=e.dense?[]:{},N.biff<8&&!K&&(K=!0,oi(N.codepage=e.codepage||1252)),N.biff<5||W.BIFFVer==0&&W.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var nt={pos:t.l-ue,name:c};a[nt.pos]=nt,N.snames.push(c)}else c=(a[ne]||{name:""}).name;W.dt==32&&(i["!type"]="chart"),W.dt==64&&(i["!type"]="macro"),he=[],de=[],N.arrayf=T=[],Ae=[],ve=[],le=!1,S={Hidden:(a[ne]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[W.r]||[])[W.c]:i[Me({c:W.c,r:W.r})])&&++W.c,w={ixfe:W.ixfe,XF:j[W.ixfe]||{},v:W.val,t:"n"},O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:W.c,r:W.r},w,e);break;case 5:case 517:w={ixfe:W.ixfe,XF:j[W.ixfe],v:W.val,t:W.t},O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:W.c,r:W.r},w,e);break;case 638:w={ixfe:W.ixfe,XF:j[W.ixfe],v:W.rknum,t:"n"},O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:W.c,r:W.r},w,e);break;case 189:for(var Ge=W.c;Ge<=W.C;++Ge){var Te=W.rkrec[Ge-W.c][0];w={ixfe:Te,XF:j[Te],v:W.rkrec[Ge-W.c][1],t:"n"},O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:Ge,r:W.r},w,e)}break;case 6:case 518:case 1030:{if(W.val=="String"){o=W;break}if(w=a0(W.val,W.cell.ixfe,W.tt),w.XF=j[w.ixfe],e.cellFormula){var wt=W.formula;if(wt&&wt[0]&&wt[0][0]&&wt[0][0][0]=="PtgExp"){var nr=wt[0][0][1][0],ur=wt[0][0][1][1],fn=Me({r:nr,c:ur});y[fn]?w.f=""+$r(W.formula,s,W.cell,P,N):w.F=((e.dense?(i[nr]||[])[ur]:i[fn])||{}).F}else w.f=""+$r(W.formula,s,W.cell,P,N)}O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b(W.cell,w,e),o=W}break;case 7:case 519:if(o)o.val=W,w=a0(W,o.cell.ixfe,"s"),w.XF=j[w.ixfe],e.cellFormula&&(w.f=""+$r(o.formula,s,o.cell,P,N)),O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b(o.cell,w,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(W);var ji=Me(W[0].s);if(p=e.dense?(i[W[0].s.r]||[])[W[0].s.c]:i[ji],e.cellFormula&&p){if(!o||!ji||!p)break;p.f=""+$r(W[1],s,W[0],P,N),p.F=qe(W[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;y[Me(o.cell)]=W[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Me(o.cell)],(p||{}).f=""+$r(W[0],s,h,P,N)}}break;case 253:w=a0(l[W.isst].t,W.ixfe,"s"),l[W.isst].h&&(w.h=l[W.isst].h),w.XF=j[w.ixfe],O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:W.c,r:W.r},w,e);break;case 513:e.sheetStubs&&(w={ixfe:W.ixfe,XF:j[W.ixfe],t:"z"},O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:W.c,r:W.r},w,e));break;case 190:if(e.sheetStubs)for(var hn=W.c;hn<=W.C;++hn){var ye=W.ixfe[hn-W.c];w={ixfe:ye,XF:j[ye],t:"z"},O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:hn,r:W.r},w,e)}break;case 214:case 516:case 4:w=a0(W.val,W.ixfe,"s"),w.XF=j[w.ixfe],O>0&&(w.z=q[w.ixfe>>8&63]),wi(w,e,r.opts.Date1904),b({c:W.c,r:W.r},w,e);break;case 0:case 512:re===1&&(s=W);break;case 252:l=W;break;case 1054:if(N.biff==4){q[O++]=W[1];for(var Fe=0;Fe<O+163&&Le[Fe]!=W[1];++Fe);Fe>=163&&ta(W[1],O+163)}else ta(W[1],W[0]);break;case 30:{q[O++]=W;for(var Ue=0;Ue<O+163&&Le[Ue]!=W;++Ue);Ue>=163&&ta(W,O+163)}break;case 229:he=he.concat(W);break;case 93:de[W.cmo[0]]=N.lastobj=W;break;case 438:N.lastobj.TxO=W;break;case 127:N.lastobj.ImData=W;break;case 440:for(_=W[0].s.r;_<=W[0].e.r;++_)for(m=W[0].s.c;m<=W[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Me({c:m,r:_})],p&&(p.l=W[1]);break;case 2048:for(_=W[0].s.r;_<=W[0].e.r;++_)for(m=W[0].s.c;m<=W[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Me({c:m,r:_})],p&&p.l&&(p.l.Tooltip=W[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;p=e.dense?(i[W[0].r]||[])[W[0].c]:i[Me(W[0])];var Ye=de[W[2]];p||(e.dense?(i[W[0].r]||(i[W[0].r]=[]),p=i[W[0].r][W[0].c]={t:"z"}):p=i[Me(W[0])]={t:"z"},s.e.r=Math.max(s.e.r,W[0].r),s.s.r=Math.min(s.s.r,W[0].r),s.e.c=Math.max(s.e.c,W[0].c),s.s.c=Math.min(s.s.c,W[0].c)),p.c||(p.c=[]),g={a:W[1],t:Ye.TxO.t},p.c.push(g)}break;case 2173:b6(j[W.ixfe],W.ext);break;case 125:{if(!N.cellStyles)break;for(;W.e>=W.s;)Ae[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},le||(le=!0,ex(W.w/256)),os(Ae[W.e+1])}break;case 520:{var it={};W.level!=null&&(ve[W.r]=it,it.level=W.level),W.hidden&&(ve[W.r]=it,it.hidden=!0),W.hpt&&(ve[W.r]=it,it.hpt=W.hpt,it.hpx=Al(W.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||$s(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=W;break;case 161:i["!margins"]||$s(i["!margins"]={}),i["!margins"].header=W.header,i["!margins"].footer=W.footer;break;case 574:W.RTL&&(E.Views[0].RTL=!0);break;case 146:D=W;break;case 2198:F=W;break;case 140:R=W;break;case 442:c?S.CodeName=W||S.name:E.WBProps.CodeName=W||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),t.l+=ue}return r.SheetNames=Yt(a).sort(function(fr,je){return Number(fr)-Number(je)}).map(function(fr){return a[fr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&H.forEach(function(fr,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=fr}),r.Strings=l,r.SSF=Dt(Le),N.enc&&(r.Encryption=N.enc),F&&(r.Themes=F),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),P.names.length>0&&(E.Names=P.names),r.Workbook=E,r}var Hc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function z9(t,e,r){var n=Pe.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=By(n,Gm,Hc.DSI);for(var a in i)e[a]=i[a]}catch(c){if(r.WTF)throw c}var s=Pe.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var o=By(s,qm,Hc.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(uS(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function W9(t,e){var r=[],n=[],i=[],a=0,s,o=my(Gm,"n"),l=my(qm,"n");if(t.Props)for(s=Yt(t.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],t.Props[s[a]]]);if(t.Custprops)for(s=Yt(t.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],t.Custprops[s[a]]]);var c=[];for(a=0;a<i.length;++a)vS.indexOf(i[a][0])>-1||cS.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);n.length&&Pe.utils.cfb_add(e,"/SummaryInformation",Vy(n,Hc.SI,l,qm)),(r.length||c.length)&&Pe.utils.cfb_add(e,"/DocumentSummaryInformation",Vy(r,Hc.DSI,o,Gm,c.length?c:null,Hc.UDI))}function hA(t,e){e||(e={}),cx(e),Nv(),e.codepage&&Cv(e.codepage);var r,n;if(t.FullPaths){if(Pe.find(t,"/encryption"))throw new Error("File is password-protected");r=Pe.find(t,"!CompObj"),n=Pe.find(t,"/Workbook")||Pe.find(t,"/Book")}else{switch(e.type){case"base64":t=Rn(Mn(t));break;case"binary":t=Rn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Cr(t,0),n={content:t}}var i,a;if(r&&j9(r),e.bookProps&&!e.bookSheets)i={};else{var s=Je?"buffer":"array";if(n&&n.content)i=U9(n.content,e);else if((a=Pe.find(t,"PerfectOffice_MAIN"))&&a.content)i=Hs.to_workbook(a.content,(e.type=s,e));else if((a=Pe.find(t,"NativeContent_MAIN"))&&a.content)i=Hs.to_workbook(a.content,(e.type=s,e));else throw(a=Pe.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Pe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=r5(t))}var o={};return t.FullPaths&&z9(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function H9(t,e){var r=e||{},n=Pe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Pe.utils.cfb_add(n,i,dA(t,r)),r.biff==8&&(t.Props||t.Custprops)&&W9(t,n),r.biff==8&&t.vbaraw&&n5(n,Pe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var bu={0:{f:p8},1:{f:E8},2:{f:U8},3:{f:N8},4:{f:A8},5:{f:j8},6:{f:G8},7:{f:D8},8:{f:Z8},9:{f:J8},10:{f:Y8},11:{f:Q8},12:{f:k8},13:{f:W8},14:{f:F8},15:{f:b8},16:{f:iA},17:{f:K8},18:{f:L8},19:{f:Hv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:KM},40:{},42:{},43:{f:GO},44:{f:HO},45:{f:XO},46:{f:QO},47:{f:YO},48:{},49:{f:vF},50:{},51:{f:R6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bS},62:{f:$8},63:{f:V6},64:{f:mM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:fM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:y8},148:{f:v8,p:16},151:{f:aM},152:{},153:{f:$M},154:{},155:{},156:{f:WM},157:{},158:{},159:{T:1,f:oO},160:{T:-1},161:{T:1,f:xo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:C6},336:{T:-1},337:{f:D6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$m},357:{},358:{},359:{},360:{T:1},361:{},362:{f:IS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:sM},427:{f:oM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:_8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:nM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$m},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Q6},633:{T:1},634:{T:-1},635:{T:1,f:X6},636:{T:-1},637:{f:wF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Zm={6:{f:Ap},10:{f:Aa},12:{f:or},13:{f:or},14:{f:Qt},15:{f:Qt},16:{f:Xr},17:{f:Qt},18:{f:Qt},19:{f:or},20:{f:Gy},21:{f:Gy},23:{f:IS},24:{f:Ky},25:{f:Qt},26:{},27:{},28:{f:gD},29:{},34:{f:Qt},35:{f:qy},38:{f:Xr},39:{f:Xr},40:{f:Xr},41:{f:Xr},42:{f:Qt},43:{f:Qt},47:{f:bO},49:{f:WP},51:{f:or},60:{},61:{f:jP},64:{f:Qt},65:{f:zP},66:{f:or},77:{},80:{},81:{},82:{},85:{f:or},89:{},90:{},91:{},92:{f:IP},93:{f:_D},94:{},95:{f:Qt},96:{},97:{},99:{f:Qt},125:{f:bS},128:{f:iD},129:{f:CP},130:{f:or},131:{f:Qt},132:{f:Qt},133:{f:NP},134:{},140:{f:ID},141:{f:or},144:{},146:{f:ND},151:{},152:{},153:{},154:{},155:{},156:{f:or},157:{},158:{},160:{f:MD},161:{f:PD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:eD},190:{f:tD},193:{f:Aa},197:{},198:{},199:{},200:{},201:{},202:{f:Qt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:or},220:{},221:{f:Qt},222:{},224:{f:nD},225:{f:AP},226:{f:Aa},227:{},229:{f:vD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:FP},253:{f:$P},255:{f:DP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:xS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Qt},353:{f:Aa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:cD},431:{f:Qt},432:{},433:{},434:{},437:{},438:{f:ED},439:{f:Qt},440:{f:TD},441:{},442:{f:Xu},443:{},444:{f:or},445:{},446:{},448:{f:Aa},449:{f:MP,r:2},450:{f:Aa},512:{f:Wy},513:{f:LD},515:{f:oD},516:{f:qP},517:{f:$y},519:{f:jD},520:{f:OP},523:{},545:{f:Xy},549:{f:zy},566:{},574:{f:VP},638:{f:ZP},659:{},1048:{},1054:{f:XP},1084:{},1212:{f:dD},2048:{f:SD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:r0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Aa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:RD,r:12},2173:{f:I6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Qt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:hD,r:12},2197:{},2198:{f:w6,r:12},2199:{},2200:{},2201:{},2202:{f:pD,r:12},2203:{f:Aa},2204:{},2205:{},2206:{},2207:{},2211:{f:LP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:DD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:CD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Wy},1:{},2:{f:WD},3:{f:UD},4:{f:VD},5:{f:$y},7:{f:$D},8:{},9:{f:r0},11:{},22:{f:or},30:{f:QP},31:{},32:{},33:{f:Xy},36:{},37:{f:zy},50:{f:GD},62:{},52:{},67:{},68:{f:or},69:{},86:{},126:{},127:{f:BD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qD},223:{},234:{},354:{},421:{},518:{f:Ap},521:{f:r0},536:{f:Ky},547:{f:qy},561:{},579:{},1030:{f:Ap},1033:{f:r0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ee(t,e,r,n){var i=e;if(!isNaN(i)){var a=n||(r||[]).length||0,s=t.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&Uv(r)&&t.push(r)}}function $9(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ee(t,e,r,i);var a=e;if(!isNaN(a)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=t.next(4);for(u.write_shift(2,a),u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Zu(t,e,r){return t||(t=oe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function G9(t,e,r,n){var i=oe(9);return Zu(i,t,e),_S(r,n||"b",i),i}function q9(t,e,r){var n=oe(8+2*r.length);return Zu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function K9(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?gr(Pt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ee(t,2,HD(r,n,i)):Ee(t,3,zD(r,n,i));return;case"b":case"e":Ee(t,5,G9(r,n,e.v,e.t));return;case"s":case"str":Ee(t,4,q9(r,n,(e.v||"").slice(0,255)));return}Ee(t,1,Zu(null,r,n))}function X9(t,e,r,n){var i=Array.isArray(e),a=lt(e["!ref"]||"A1"),s,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=qe(a)}for(var c=a.s.r;c<=a.e.r;++c){o=er(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(l[u]=Vt(u)),s=l[u]+o;var h=i?(e[c]||[])[u]:e[s];h&&K9(t,h,c,u)}}}function Y9(t,e){for(var r=e||{},n=wn(),i=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ee(n,r.biff==4?1033:r.biff==3?521:9,Qv(t,16,r)),X9(n,t.Sheets[t.SheetNames[i]],i,r),Ee(n,10),n.end()}function Q9(t,e,r){Ee(t,49,HP({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function J9(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ee(t,1054,YP(i,e[i],r))})}function Z9(t,e){var r=oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ee(t,2151,r),r=oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),kS(lt(e["!ref"]||"A1"),r),r.write_shift(4,4),Ee(t,2152,r)}function e7(t,e){for(var r=0;r<16;++r)Ee(t,224,Hy({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ee(t,224,Hy(n,0,e))})}function t7(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ee(t,440,kD(n)),n[1].Tooltip&&Ee(t,2048,AD(n))}delete e["!links"]}function r7(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ee(t,125,FD(hd(i,n),i))})}}function n7(t,e,r,n,i){var a=16+xs(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ee(t,513,ro(r,n,a));return}if(e.bf)Ee(t,6,CL(e,r,n,i,a));else switch(e.t){case"d":case"n":var s=e.t=="d"?gr(Pt(e.v)):e.v;Ee(t,515,lD(r,n,s,a));break;case"b":case"e":Ee(t,517,sD(r,n,e.v,a,i,e.t));break;case"s":case"str":if(i.bookSST){var o=ax(i.Strings,e.v,i.revStrings);Ee(t,253,GP(r,n,o,a))}else Ee(t,516,KP(r,n,(e.v||"").slice(0,255),a,i));break;default:Ee(t,513,ro(r,n,a))}}function i7(t,e,r){var n=wn(),i=r.SheetNames[t],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[t]||{},l=Array.isArray(a),c=e.biff==8,u,h="",d=[],p=lt(a["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}Ee(n,2057,Qv(r,16,e)),Ee(n,13,$n(1)),Ee(n,12,$n(100)),Ee(n,15,an(!0)),Ee(n,17,an(!1)),Ee(n,16,eo(.001)),Ee(n,95,an(!0)),Ee(n,42,an(!1)),Ee(n,43,an(!1)),Ee(n,130,$n(1)),Ee(n,128,aD()),Ee(n,131,an(!1)),Ee(n,132,an(!1)),c&&r7(n,a["!cols"]),Ee(n,512,JP(p,e)),c&&(a["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){h=er(m);for(var _=p.s.c;_<=p.e.c;++_){m===p.s.r&&(d[_]=Vt(_)),u=d[_]+h;var y=l?(a[m]||[])[_]:a[u];y&&(n7(n,y,m,_,e),c&&y.l&&a["!links"].push([u,y.l]))}}var T=o.CodeName||o.name||i;return c&&Ee(n,574,UP((s.Views||[])[0])),c&&(a["!merges"]||[]).length&&Ee(n,229,xD(a["!merges"])),c&&t7(n,a),Ee(n,442,yS(T)),c&&Z9(n,a),Ee(n,10),n.end()}function a7(t,e,r){var n=wn(),i=(t||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ee(n,2057,Qv(t,5,r)),r.bookType=="xla"&&Ee(n,135),Ee(n,225,o?$n(1200):null),Ee(n,193,sP(2)),l&&Ee(n,191),l&&Ee(n,192),Ee(n,226),Ee(n,92,bP("SheetJS",r)),Ee(n,66,$n(o?1200:1252)),o&&Ee(n,353,$n(0)),o&&Ee(n,448),Ee(n,317,OD(t.SheetNames.length)),o&&t.vbaraw&&Ee(n,211),o&&t.vbaraw){var c=s.CodeName||"ThisWorkbook";Ee(n,442,yS(c))}Ee(n,156,$n(17)),Ee(n,25,an(!1)),Ee(n,18,an(!1)),Ee(n,19,$n(0)),o&&Ee(n,431,an(!1)),o&&Ee(n,444,$n(0)),Ee(n,61,BP()),Ee(n,64,an(!1)),Ee(n,141,$n(0)),Ee(n,34,an(MM(t)=="true")),Ee(n,14,an(!0)),o&&Ee(n,439,an(!1)),Ee(n,218,$n(0)),Q9(n,t,r),J9(n,t.SSF,r),e7(n,r),o&&Ee(n,352,an(!1));var u=n.end(),h=wn();o&&Ee(h,140,bD()),o&&r.Strings&&$9(h,252,PP(r.Strings)),Ee(h,10);var d=h.end(),p=wn(),g=0,m=0;for(m=0;m<t.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var _=u.length+g+d.length;for(m=0;m<t.SheetNames.length;++m){var y=a[m]||{};Ee(p,133,RP({pos:_,hs:y.Hidden||0,dt:0,name:t.SheetNames[m]},r)),_+=e[m].length}var T=p.end();if(g!=T.length)throw new Error("BS8 "+g+" != "+T.length);var w=[];return u.length&&w.push(u),T.length&&w.push(T),d.length&&w.push(d),yr(w)}function s7(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Dt(Le)),t&&t.SSF&&(Bl(),ad(t.SSF),r.revssf=od(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ux(r),r.cellXfs=[],xs(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=i7(i,r,t);return n.unshift(a7(t,n,r)),yr(n)}function dA(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=kn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return s7(t,e);case 4:case 3:case 2:return Y9(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function aw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),s=i.index,o=a&&a.index||t.length,l=H3(t.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<l.length;++s){var m=l[s].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(_!="<td"&&_!="<th")){var y=m.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var T=y[o].trim();if(T.match(/<t[dh]/i)){for(var w=T,R=0;w.charAt(0)=="<"&&(R=w.indexOf(">"))>-1;)w=w.slice(R+1);for(var j=0;j<g.length;++j){var D=g[j];D.s.c==u&&D.s.r<c&&c<=D.e.r&&(u=D.e.c+1,j=-1)}var E=Be(T.slice(0,T.indexOf(">")));d=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||d>1)&&g.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var S=E.t||E["data-t"]||"";if(!w.length){u+=d;continue}if(w=Mk(w),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!w.length){u+=d;continue}var k={t:"s",v:w};r.raw||!w.trim().length||S=="s"||(w==="TRUE"?k={t:"b",v:!0}:w==="FALSE"?k={t:"b",v:!1}:isNaN(fi(w))?isNaN(kl(w).getDate())||(k={t:"d",v:Pt(w)},r.cellDates||(k={t:"n",v:gr(k.v)}),k.z=r.dateNF||Le[14]):k={t:"n",v:fi(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=k):n[Me({r:c,c:u})]=k,u+=d}}}}return n["!ref"]=qe(p),g.length&&(n["!merges"]=g),n}function o7(t,e,r,n){for(var i=t["!merges"]||[],a=[],s=e.s.c;s<=e.e.c;++s){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>s)&&!(i[c].e.r<r||i[c].e.c<s)){if(i[c].s.r<r||i[c].s.c<s){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Me({r,c:s}),h=n.dense?(t[r]||[])[s]:t[u],d=h&&h.v!=null&&(h.h||jv(h.w||(ca(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+u,a.push(we("td",d,p))}}var g="<tr>";return g+a.join("")+"</tr>"}var l7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',c7="</body></html>";function u7(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return vs(aw(r[0],e),e);var n=dx();return r.forEach(function(i,a){px(n,aw(i,e),"Sheet"+(a+1))}),n}function f7(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pA(t,e){var r=e||{},n=r.header!=null?r.header:l7,i=r.footer!=null?r.footer:c7,a=[n],s=kn(t["!ref"]);r.dense=Array.isArray(t),a.push(f7(t,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(o7(t,s,o,r));return a.push("</table>"+i),a.join("")}function mA(t,e,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Ut(n.origin):n.origin;i=s.r,a=s.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var u=kn(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],d=0,p=t["!rows"]||(t["!rows"]=[]),g=0,m=0,_=0,y=0,T=0,w=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&m<l;++g){var R=o[g];if(sw(R)){if(n.display)continue;p[m]={hidden:!0}}var j=R.children;for(_=y=0;_<j.length;++_){var D=j[_];if(!(n.display&&sw(D))){var E=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):Mk(D.innerHTML),S=D.getAttribute("data-z")||D.getAttribute("z");for(d=0;d<h.length;++d){var k=h[d];k.s.c==y+a&&k.s.r<m+i&&m+i<=k.e.r&&(y=k.e.c+1-a,d=-1)}w=+D.getAttribute("colspan")||1,((T=+D.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:m+i,c:y+a},e:{r:m+i+(T||1)-1,c:y+a+(w||1)-1}});var I={t:"s",v:E},b=D.getAttribute("data-t")||D.getAttribute("t")||"";E!=null&&(E.length==0?I.t=b||"z":n.raw||E.trim().length==0||b=="s"||(E==="TRUE"?I={t:"b",v:!0}:E==="FALSE"?I={t:"b",v:!1}:isNaN(fi(E))?isNaN(kl(E).getDate())||(I={t:"d",v:Pt(E)},n.cellDates||(I={t:"n",v:gr(I.v)}),I.z=n.dateNF||Le[14]):I={t:"n",v:fi(E)})),I.z===void 0&&S!=null&&(I.z=S);var N="",F=D.getElementsByTagName("A");if(F&&F.length)for(var he=0;he<F.length&&!(F[he].hasAttribute("href")&&(N=F[he].getAttribute("href"),N.charAt(0)!="#"));++he);N&&N.charAt(0)!="#"&&(I.l={Target:N}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][y+a]=I):t[Me({c:y+a,r:m+i})]=I,c.e.c<y+a&&(c.e.c=y+a),y+=w}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),t["!ref"]=qe(c),m>=l&&(t["!fullref"]=qe((c.e.r=o.length-g+m-1+i,c))),t}function gA(t,e){var r=e||{},n=r.dense?[]:{};return mA(n,t,e)}function h7(t,e){return vs(gA(t,e),e)}function sw(t){var e="",r=d7(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function d7(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function p7(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ot(e.replace(/<[^>]*>/g,""));return[r]}var ow={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vA(t,e){var r=e||{},n=Bv(t),i=[],a,s,o={name:""},l="",c=0,u,h,d={},p=[],g=r.dense?[]:{},m,_,y={value:""},T="",w=0,R=[],j=-1,D=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,k={},I=[],b={},N=0,F=0,he=[],de=1,Ae=1,ve=[],le={Names:[]},P={},Q=["",""],re=[],O={},q="",H=0,G=!1,K=!1,ne=0;for(Eu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Eu.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?g["!ref"]=qe(E):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=r.sheetRows-1,g["!ref"]=qe(E)),I.length&&(g["!merges"]=I),he.length&&(g["!rows"]=he),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),d[u.name]=g,K=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=Be(m[0],!1),j=D=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,g=r.dense?[]:{},I=[],he=[],K=!0);break;case"table-row-group":m[1]==="/"?--S:++S;break;case"table-row":case"":if(m[1]==="/"){j+=de,de=1;break}if(h=Be(m[0],!1),h.?j=h.-1:j==-1&&(j=0),de=+h["number-rows-repeated"]||1,de<10)for(ne=0;ne<de;++ne)S>0&&(he[j+ne]={level:S});D=-1;break;case"covered-table-cell":m[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(g[j]||(g[j]=[]),g[j][D]={t:"z"}):g[Me({r:j,c:D})]={t:"z"}),T="",R=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++D,y=Be(m[0],!1),Ae=parseInt(y["number-columns-repeated"]||"1",10),_={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(_.f=rw(ot(y.formula))),(y.||y["value-type"])=="string"&&(_.t="s",_.v=ot(y["string-value"]||""),r.dense?(g[j]||(g[j]=[]),g[j][D]=_):g[Me({r:j,c:D})]=_),D+=Ae-1;else if(m[1]!=="/"){++D,T="",w=0,R=[],Ae=1;var ae=de?j+de-1:j;if(D>E.e.c&&(E.e.c=D),D<E.s.c&&(E.s.c=D),j<E.s.r&&(E.s.r=j),ae>E.e.r&&(E.e.r=ae),y=Be(m[0],!1),re=[],O={},_={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=ot(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(N=parseInt(y["number-matrix-rows-spanned"],10)||0,F=parseInt(y["number-matrix-columns-spanned"],10)||0,b={s:{r:j,c:D},e:{r:j+N-1,c:D+F-1}},_.F=qe(b),ve.push([b,_.F])),y.formula)_.f=rw(y.formula);else for(ne=0;ne<ve.length;++ne)j>=ve[ne][0].s.r&&j<=ve[ne][0].e.r&&D>=ve[ne][0].s.c&&D<=ve[ne][0].e.c&&(_.F=ve[ne][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(N=parseInt(y["number-rows-spanned"],10)||0,F=parseInt(y["number-columns-spanned"],10)||0,b={s:{r:j,c:D},e:{r:j+N-1,c:D+F-1}},I.push(b)),y["number-columns-repeated"]&&(Ae=parseInt(y["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Nt(y["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(y.value);break;case"percentage":_.t="n",_.v=parseFloat(y.value);break;case"currency":_.t="n",_.v=parseFloat(y.value);break;case"date":_.t="d",_.v=Pt(y["date-value"]),r.cellDates||(_.t="n",_.v=gr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=U3(y["time-value"])/86400,r.cellDates&&(_.t="d",_.v=ld(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(y.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",y["string-value"]!=null&&(T=ot(y["string-value"]),R=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(G=!1,_.t==="s"&&(_.v=T||"",R.length&&(_.R=R),G=w==0),P.Target&&(_.l=P),re.length>0&&(_.c=re,re=[]),T&&r.cellText!==!1&&(_.w=T),G&&(_.t="z",delete _.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var ue=0;ue<de;++ue){if(Ae=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[j+ue]||(g[j+ue]=[]),g[j+ue][D]=ue==0?_:Dt(_);--Ae>0;)g[j+ue][D+Ae]=Dt(_);else for(g[Me({r:j+ue,c:D})]=_;--Ae>0;)g[Me({r:j+ue,c:D+Ae})]=Dt(_);E.e.c<=D&&(E.e.c=D)}Ae=parseInt(y["number-columns-repeated"]||"1",10),D+=Ae-1,Ae=0,_={},T="",R=[]}P={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a;O.t=T,R.length&&(O.R=R),O.a=q,re.push(O)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);q="",H=0,T="",w=0,R=[];break;case"creator":m[1]==="/"?q=n.slice(H,m.index):H=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);T="",w=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(k[o.name]=l,(a=i.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Be(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Be(m[0],!1),l+=ow[m[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Be(m[0],!1),l+=ow[m[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":s=Be(m[0],!1),Q=Ip(s["cell-range-address"]);var ce={Name:s.name,Ref:Q[0]+"!"+Q[1]};K&&(ce.Sheet=p.length),le.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var De=p7(n.slice(w,m.index));T=(T.length>0?T+`
`:"")+De[0]}else Be(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{Q=Ip(Be(m[0])["target-range-address"]),d[Q[0]]["!autofilter"]={ref:Q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(P=Be(m[0],!1),!P.href)break;P.Target=ot(P.href),delete P.href,P.Target.charAt(0)=="#"&&P.Target.indexOf(".")>-1?(Q=Ip(P.Target.slice(1)),P.Target="#"+Q[0]+"!"+Q[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var W={Sheets:d,SheetNames:p,Workbook:le};return r.bookSheets&&delete W.Sheets,W}function lw(t,e){e=e||{},Hn(t,"META-INF/manifest.xml")&&UF(sr(t,"META-INF/manifest.xml"),e);var r=Fn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=vA(_t(r),e);return Hn(t,"meta.xml")&&(n.Props=oS(sr(t,"meta.xml"))),n}function cw(t,e){return vA(t,e)}var m7=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+wu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return rr+e}}(),uw=function(){var t=function(a){return gt(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,s,o){var l=[];l.push('      <table:table table:name="'+gt(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=kn(a["!ref"]||"A1"),d=a["!merges"]||[],p=0,g=Array.isArray(a);if(a["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",_=a["!rows"]||[];for(c=0;c<h.s.r;++c)m=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<h.s.c;++u)l.push(e);for(;u<=h.e.c;++u){var y=!1,T={},w="";for(p=0;p!=d.length;++p)if(!(d[p].s.c>u)&&!(d[p].s.r>c)&&!(d[p].e.c<u)&&!(d[p].e.r<c)){(d[p].s.c!=u||d[p].s.r!=c)&&(y=!0),T["table:number-columns-spanned"]=d[p].e.c-d[p].s.c+1,T["table:number-rows-spanned"]=d[p].e.r-d[p].s.r+1;break}if(y){l.push(r);continue}var R=Me({r:c,c:u}),j=g?(a[c]||[])[u]:a[R];if(j&&j.f&&(T["table:formula"]=gt(OL(j.f)),j.F&&j.F.slice(0,R.length)==R)){var D=kn(j.F);T["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,T["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!j){l.push(e);continue}switch(j.t){case"b":w=j.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=j.v?"true":"false";break;case"n":w=j.w||String(j.v||0),T["office:value-type"]="float",T["office:value"]=j.v||0;break;case"s":case"str":w=j.v==null?"":j.v,T["office:value-type"]="string";break;case"d":w=j.w||Pt(j.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=Pt(j.v).toISOString(),T["table:style-name"]="ce1";break;default:l.push(e);continue}var E=t(w);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+LL(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),E=we("text:a",E,{"xlink:href":S.replace(/&/g,"&amp;")})}l.push("          "+we("table:table-cell",we("text:p",E,{}),T)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;os(h),h.ods=o;var d=c["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var l=[rr],c=wu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=wu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(sS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function xA(t,e){if(e.bookType=="fods")return uw(t,e);var r=Ov(),n="",i=[],a=[];return n="mimetype",Xe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Xe(r,n,uw(t,e)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Xe(r,n,m7(t,e)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Xe(r,n,rr+sS()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Xe(r,n,HF(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Xe(r,n,zF(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function no(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function eg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):_t(gs(t))}function g7(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Rn(Ai(t))}function v7(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function cs(t){var e=t.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function fw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function x7(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function _7(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)t[e+a]=i&255;t[e+15]|=r>=0?0:128}function Cu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function pt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Xt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ft(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Cu(t,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:s=4,o=t.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=t.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Cu(t,r),o=t.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:a};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Sr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(pt(n*8+i.type)),i.type==2&&e.push(pt(i.data.length)),e.push(i.data))})}),cs(e)}function lx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function zn(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Cu(t,n),a=ft(t.slice(n[0],n[0]+i));n[0]+=i;var s={id:Xt(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=ft(o.data),c=Xt(l[3][0].data);s.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=a[3])!=null&&e[0]&&(s.merge=Xt(a[3][0].data)>>>0>0),r.push(s)}return r}function Po(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:pt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:pt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:pt(s.data.length)}],n[2].push({data:Sr(s.meta),type:2})});var a=Sr(n);e.push(pt(a.length)),e.push(a),i.forEach(function(s){return e.push(s)})}),cs(e)}function y7(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Cu(e,r),i=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var s=e[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=e[r[0]],o>1&&(s|=e[r[0]+1]<<8),o>2&&(s|=e[r[0]+2]<<16),o>3&&(s|=e[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(e.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(a==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[cs(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=cs(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Wn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(y7(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return cs(e)}function Do(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var a=pt(n),s=a.length;e.push(a),n<=60?(s++,e.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return cs(e)}function w7(t,e,r,n){var i=no(t),a=i.getUint32(4,!0),s=(n>1?12:8)+fw(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=fw(a&(n>1?12288:4096))*4,a&16&&(l=i.getUint32(s,!0),s+=4),a&32&&(c=i.getFloat64(s,!0),s+=8),a&64&&(u.setTime(u.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function E7(t,e,r){var n=no(t),i=n.getUint32(8,!0),a=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=x7(t,a),a+=16),i&2&&(c=n.getFloat64(a,!0),a+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(s>-1)h={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function Cp(t,e){var r=new Uint8Array(32),n=no(r),i=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,_7(r,i,t.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),a|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,i)}function Np(t,e){var r=new Uint8Array(32),n=no(r),i=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),a|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,i)}function T7(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return w7(t,e,r,t[0]);case 5:return E7(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function zr(t){var e=ft(t);return Cu(e[1][0].data)}function hw(t,e){var r=ft(e.data),n=Xt(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=ft(s.data),l=Xt(o[1][0].data)>>>0;switch(n){case 1:a[l]=eg(o[3][0].data);break;case 8:{var c=t[zr(o[9][0].data)][0],u=ft(c.data),h=t[zr(u[1][0].data)][0],d=Xt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=ft(h.data);a[l]=p[3].map(function(g){return eg(g.data)}).join("")}break}}),a}function k7(t,e){var r,n,i,a,s,o,l,c,u,h,d,p,g,m,_=ft(t),y=Xt(_[1][0].data)>>>0,T=Xt(_[2][0].data)>>>0,w=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Xt(_[8][0].data)>0||!1,R,j;if((a=(i=_[7])==null?void 0:i[0])!=null&&a.data&&e!=0)R=(o=(s=_[7])==null?void 0:s[0])==null?void 0:o.data,j=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=_[4])==null?void 0:u[0])!=null&&h.data&&e!=1)R=(p=(d=_[4])==null?void 0:d[0])==null?void 0:p.data,j=(m=(g=_[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var D=w?4:1,E=no(R),S=[],k=0;k<R.length/2;++k){var I=E.getUint16(k*2,!0);I<65535&&S.push([k,I])}if(S.length!=T)throw"Expected ".concat(T," cells, found ").concat(S.length);var b=[];for(k=0;k<S.length-1;++k)b[S[k][0]]=j.subarray(S[k][1]*D,S[k+1][1]*D);return S.length>=1&&(b[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*D)),{R:y,cells:b}}function S7(t,e){var r,n=ft(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Xt(n[7][0].data)>>>0>0?1:0:-1,a=lx(n[5],function(s){return k7(s,i)});return{nrows:Xt(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function A7(t,e,r){var n,i=ft(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Xt(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Xt(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=qe(a);var s=ft(i[4][0].data),o=hw(t,t[zr(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?hw(t,t[zr(s[17][0].data)][0]):[],c=ft(s[3][0].data),u=0;c[1].forEach(function(h){var d=ft(h.data),p=t[zr(d[2][0].data)][0],g=Xt(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=S7(t,p);m.data.forEach(function(_,y){_.forEach(function(T,w){var R=Me({r:u+y,c:w}),j=T7(T,o,l);j&&(r[R]=j)})}),u+=m.nrows})}function I7(t,e){var r=ft(e.data),n={"!ref":"A1"},i=t[zr(r[2][0].data)],a=Xt(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return A7(t,i[0],n),n}function b7(t,e){var r,n=ft(e.data),i={name:(r=n[1])!=null&&r[0]?eg(n[1][0].data):"",sheets:[]},a=lx(n[2],zr);return a.forEach(function(s){t[s].forEach(function(o){var l=Xt(o.meta[1][0].data);l==6e3&&i.sheets.push(I7(t,o))})}),i}function C7(t,e){var r=dx(),n=ft(e.data),i=lx(n[1],zr);if(i.forEach(function(a){t[a].forEach(function(s){var o=Xt(s.meta[1][0].data);if(o==2){var l=b7(t,s);l.sheets.forEach(function(c,u){px(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Rp(t){var e,r,n,i,a={},s=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Wn(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=zn(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){a[h.id]=h.messages,s.push(h.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Xt(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(l){a[l].forEach(function(c){var u=Xt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return C7(a,o)}function N7(t,e,r){var n,i,a,s;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=t[8])==null?void 0:a[0])==null?void 0:s.data)&&Xt(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=no(t[7][0].data),u=0,h=[],d=no(t[4][0].data),p=0,g=[],m=0;m<e.length;++m){if(e[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),d.setUint16(m*2,p,!0);var _,y;switch(typeof e[m]){case"string":_=Cp({t:"s",v:e[m]},r),y=Np({t:"s",v:e[m]},r);break;case"number":_=Cp({t:"n",v:e[m]},r),y=Np({t:"n",v:e[m]},r);break;case"boolean":_=Cp({t:"b",v:e[m]},r),y=Np({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(_),u+=_.length,g.push(y),p+=y.length,++l}for(t[2][0].data=pt(l);m<t[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return t[6][0].data=cs(h),t[3][0].data=cs(g),l}function R7(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=kn(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(qe(n)));var a=wh(r,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(q){return q.forEach(function(H){typeof H=="string"&&s.push(H)})});var o={},l=[],c=Pe.read(e.numbers,{type:"base64"});c.FileIndex.map(function(q,H){return[q,c.FullPaths[H]]}).forEach(function(q){var H=q[0],G=q[1];if(H.type==2&&H.name.match(/\.iwa/)){var K=H.content,ne=Wn(K),ae=zn(ne);ae.forEach(function(ue){l.push(ue.id),o[ue.id]={deps:[],location:G,type:Xt(ue.messages[0].meta[1][0].data)}})}}),l.sort(function(q,H){return q-H});var u=l.filter(function(q){return q>1}).map(function(q){return[q,pt(q)]});c.FileIndex.map(function(q,H){return[q,c.FullPaths[H]]}).forEach(function(q){var H=q[0];if(q[1],!!H.name.match(/\.iwa/)){var G=zn(Wn(H.content));G.forEach(function(K){K.messages.forEach(function(ne){u.forEach(function(ae){K.messages.some(function(ue){return Xt(ue.meta[1][0].data)!=11006&&v7(ue.data,ae[1])})&&o[ae[0]].deps.push(K.id)})})})}});for(var h=Pe.find(c,o[1].location),d=zn(Wn(h.content)),p,g=0;g<d.length;++g){var m=d[g];m.id==1&&(p=m)}var _=zr(ft(p.messages[0].data)[1][0].data);for(h=Pe.find(c,o[_].location),d=zn(Wn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==_&&(p=m);for(_=zr(ft(p.messages[0].data)[2][0].data),h=Pe.find(c,o[_].location),d=zn(Wn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==_&&(p=m);for(_=zr(ft(p.messages[0].data)[2][0].data),h=Pe.find(c,o[_].location),d=zn(Wn(h.content)),g=0;g<d.length;++g)m=d[g],m.id==_&&(p=m);var y=ft(p.messages[0].data);{y[6][0].data=pt(n.e.r+1),y[7][0].data=pt(n.e.c+1);var T=zr(y[46][0].data),w=Pe.find(c,o[T].location),R=zn(Wn(w.content));{for(var j=0;j<R.length&&R[j].id!=T;++j);if(R[j].id!=T)throw"Bad ColumnRowUIDMapArchive";var D=ft(R[j].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var E=0;E<=n.e.c;++E){var S=[];S[1]=S[2]=[{type:0,data:pt(E+420690)}],D[1].push({type:2,data:Sr(S)}),D[2].push({type:0,data:pt(E)}),D[3].push({type:0,data:pt(E)})}D[4]=[],D[5]=[],D[6]=[];for(var k=0;k<=n.e.r;++k)S=[],S[1]=S[2]=[{type:0,data:pt(k+726270)}],D[4].push({type:2,data:Sr(S)}),D[5].push({type:0,data:pt(k)}),D[6].push({type:0,data:pt(k)});R[j].messages[0].data=Sr(D)}w.content=Do(Po(R)),w.size=w.content.length,delete y[46];var I=ft(y[4][0].data);{I[7][0].data=pt(n.e.r+1);var b=ft(I[1][0].data),N=zr(b[2][0].data);w=Pe.find(c,o[N].location),R=zn(Wn(w.content));{if(R[0].id!=N)throw"Bad HeaderStorageBucket";var F=ft(R[0].messages[0].data);for(k=0;k<a.length;++k){var he=ft(F[2][0].data);he[1][0].data=pt(k),he[4][0].data=pt(a[k].length),F[2][k]={type:F[2][0].type,data:Sr(he)}}R[0].messages[0].data=Sr(F)}w.content=Do(Po(R)),w.size=w.content.length;var de=zr(I[2][0].data);w=Pe.find(c,o[de].location),R=zn(Wn(w.content));{if(R[0].id!=de)throw"Bad HeaderStorageBucket";for(F=ft(R[0].messages[0].data),E=0;E<=n.e.c;++E)he=ft(F[2][0].data),he[1][0].data=pt(E),he[4][0].data=pt(n.e.r+1),F[2][E]={type:F[2][0].type,data:Sr(he)};R[0].messages[0].data=Sr(F)}w.content=Do(Po(R)),w.size=w.content.length;var Ae=zr(I[4][0].data);(function(){for(var q=Pe.find(c,o[Ae].location),H=zn(Wn(q.content)),G,K=0;K<H.length;++K){var ne=H[K];ne.id==Ae&&(G=ne)}var ae=ft(G.messages[0].data);{ae[3]=[];var ue=[];s.forEach(function(W,ct){ue[1]=[{type:0,data:pt(ct)}],ue[2]=[{type:0,data:pt(1)}],ue[3]=[{type:2,data:g7(W)}],ae[3].push({type:2,data:Sr(ue)})})}G.messages[0].data=Sr(ae);var ce=Po(H),De=Do(ce);q.content=De,q.size=q.content.length})();var ve=ft(I[3][0].data);{var le=ve[1][0];delete ve[2];var P=ft(le.data);{var Q=zr(P[2][0].data);(function(){for(var q=Pe.find(c,o[Q].location),H=zn(Wn(q.content)),G,K=0;K<H.length;++K){var ne=H[K];ne.id==Q&&(G=ne)}var ae=ft(G.messages[0].data);{delete ae[6],delete ve[7];var ue=new Uint8Array(ae[5][0].data);ae[5]=[];for(var ce=0,De=0;De<=n.e.r;++De){var W=ft(ue);ce+=N7(W,a[De],s),W[1][0].data=pt(De),ae[5].push({data:Sr(W),type:2})}ae[1]=[{type:0,data:pt(n.e.c+1)}],ae[2]=[{type:0,data:pt(n.e.r+1)}],ae[3]=[{type:0,data:pt(ce)}],ae[4]=[{type:0,data:pt(n.e.r+1)}]}G.messages[0].data=Sr(ae);var ct=Po(H),Ke=Do(ct);q.content=Ke,q.size=q.content.length})()}le.data=Sr(P)}I[3][0].data=Sr(ve)}y[4][0].data=Sr(I)}p.messages[0].data=Sr(y);var re=Po(d),O=Do(re);return h.content=O,h.size=h.content.length,c}function _A(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function cx(t){_A([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function ux(t){_A([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function F7(t){return Ze.WS.indexOf(t)>-1?"sheet":t==Ze.CS?"chart":t==Ze.DS?"dialog":t==Ze.MS?"macro":t&&t.length?t:"sheet"}function P7(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,F7(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function D7(t,e,r,n,i,a,s,o,l,c,u,h){try{a[n]=Vc(Fn(t,r,!0),e);var d=sr(t,e),p;switch(o){case"sheet":p=r9(d,e,i,l,a[n],c,u,h);break;case"chart":if(p=n9(d,e,i,l,a[n],c,u,h),!p||!p["!drawel"])break;var g=yc(p["!drawel"].Target,e),m=Tu(g),_=W6(Fn(t,g,!0),Vc(Fn(t,m,!0),g)),y=yc(_,g),T=Tu(y);p=NM(Fn(t,y,!0),y,l,Vc(Fn(t,T,!0),y),c,p);break;case"macro":p=i9(d,e,i,l,a[n],c,u,h);break;case"dialog":p=a9(d,e,i,l,a[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=p;var w=[];a&&a[n]&&Yt(a[n]).forEach(function(R){var j="";if(a[n][R].Type==Ze.CMNT){j=yc(a[n][R].Target,e);var D=c9(sr(t,j,!0),j,l);if(!D||!D.length)return;Qy(p,D,!1)}a[n][R].Type==Ze.TCMNT&&(j=yc(a[n][R].Target,e),w=w.concat($6(sr(t,j,!0),l)))}),w&&w.length&&Qy(p,w,!0,l.people||[])}catch(R){if(l.WTF)throw R}}function Vn(t){return t.charAt(0)=="/"?t.slice(1):t}function O7(t,e){if(Bl(),e=e||{},cx(e),Hn(t,"META-INF/manifest.xml")||Hn(t,"objectdata.xml"))return lw(t,e);if(Hn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Rp<"u"){if(t.FileIndex)return Rp(t);var r=Pe.utils.cfb_new();return xy(t).forEach(function(he){Xe(r,he,G3(t,he))}),Rp(r)}throw new Error("Unsupported NUMBERS file")}if(!Hn(t,"[Content_Types].xml"))throw Hn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Hn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=xy(t),i=BF(Fn(t,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",sr(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!sr(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Uc=[],i.sst)try{Uc=l9(sr(t,Vn(i.sst)),i.sst,e)}catch(he){if(e.WTF)throw he}e.cellStyles&&i.themes.length&&(l=o9(Fn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=s9(sr(t,Vn(i.style)),i.style,l,e))}i.links.map(function(he){try{var de=Vc(Fn(t,Tu(Vn(he))),he);return f9(sr(t,Vn(he)),de,he,e)}catch{}});var u=t9(sr(t,Vn(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=sr(t,Vn(i.coreprops[0]),!0),d&&(h=oS(d)),i.extprops.length!==0&&(d=sr(t,Vn(i.extprops[0]),!0),d&&GF(d,h,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=Fn(t,Vn(i.custprops[0]),!0),d&&(p=KF(d,e)));var g={};if((e.bookSheets||e.bookProps)&&(u.Sheets?s=u.Sheets.map(function(de){return de.name}):h.Worksheets&&h.SheetNames.length>0&&(s=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=p),e.bookSheets&&typeof s<"u"&&(g.SheetNames=s),e.bookSheets?g.SheetNames:e.bookProps))return g;s={};var m={};e.bookDeps&&i.calcchain&&(m=u9(sr(t,Vn(i.calcchain)),i.calcchain));var _=0,y={},T,w;{var R=u.Sheets;h.Worksheets=R.length,h.SheetNames=[];for(var j=0;j!=R.length;++j)h.SheetNames[j]=R[j].name}var D=a?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),S=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Hn(t,S)||(S="xl/_rels/workbook."+D+".rels");var k=Vc(Fn(t,S,!0),S.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=h9(sr(t,Vn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=q6(sr(t,Vn(i.people[0])),e)),k&&(k=P7(k,u.Sheets));var I=sr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=h.Worksheets;++_){var b="sheet";if(k&&k[_]?(T="xl/"+k[_][1].replace(/[\/]?xl\//,""),Hn(t,T)||(T=k[_][1]),Hn(t,T)||(T=S.replace(/_rels\/.*$/,"")+k[_][1]),b=k[_][2]):(T="xl/worksheets/sheet"+(_+1-I)+"."+D,T=T.replace(/sheet0\./,"sheet.")),w=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(h.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==_&&(N=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==h.SheetNames[_].toLowerCase()&&(N=1);if(!N)continue e}}D7(t,T,w,h.SheetNames[_],_,y,s,b,e,u,l,c)}return g={Directory:i,Workbook:u,Props:h,Custprops:p,Deps:m,Sheets:s,SheetNames:h.SheetNames,Strings:Uc,Styles:c,Themes:l,SSF:Dt(Le)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(he,de){he=he.replace(/^Root Entry[\/]/,""),g.keys.push(he),g.files[he]=t.FileIndex[de]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=sr(t,Vn(i.vba[0]),!0):i.defaults&&i.defaults.bin===t5&&(g.vbaraw=sr(t,"xl/vbaProject.bin",!0))),g}function L7(t,e){var r=e||{},n="Workbook",i=Pe.find(t,n);try{if(n="/!DataSpaces/Version",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(hO(i.content),n="/!DataSpaces/DataSpaceMap",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=pO(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=mO(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);vO(i.content)}catch{}if(n="/EncryptionInfo",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=xO(i.content);if(n="/EncryptedPackage",i=Pe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function M7(t,e){return e.bookType=="ods"?xA(t,e):e.bookType=="numbers"?R7(t,e):e.bookType=="xlsb"?j7(t,e):B7(t,e)}function j7(t,e){Qo=1024,t&&!t.SSF&&(t.SSF=Dt(Le)),t&&t.SSF&&(Bl(),ad(t.SSF),e.revssf=od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=GS.indexOf(e.bookType)>-1,i=Xv();ux(e=e||{});var a=Ov(),s="",o=0;if(e.cellXfs=[],xs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Xe(a,s,lS(t.Props,e)),i.coreprops.push(s),mt(e.rels,2,s,Ze.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Xe(a,s,fS(t.Props)),i.extprops.push(s),mt(e.rels,3,s,Ze.EXT_PROPS),t.Custprops!==t.Props&&Yt(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Xe(a,s,hS(t.Custprops)),i.custprops.push(s),mt(e.rels,4,s,Ze.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var u={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Xe(a,s,p9(o-1,s,e,t,u)),i.sheets.push(s),mt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(h){var p=h["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,Xe(a,m,v9(p,m)),i.comments.push(m),mt(u,-1,"../comments"+o+"."+r,Ze.CMNT),g=!0),h["!legacy"]&&g&&Xe(a,"xl/drawings/vmlDrawing"+o+".vml",HS(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Xe(a,Tu(s),sl(u))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+r,Xe(a,s,g9(e.Strings,s,e)),i.strs.push(s),mt(e.wbrels,-1,"sharedStrings."+r,Ze.SST)),s="xl/workbook."+r,Xe(a,s,d9(t,s)),i.workbooks.push(s),mt(e.rels,1,s,Ze.WB),s="xl/theme/theme1.xml",Xe(a,s,tx(t.Themes,e)),i.themes.push(s),mt(e.wbrels,-1,"theme/theme1.xml",Ze.THEME),s="xl/styles."+r,Xe(a,s,m9(t,s,e)),i.styles.push(s),mt(e.wbrels,-1,"styles."+r,Ze.STY),t.vbaraw&&n&&(s="xl/vbaProject.bin",Xe(a,s,t.vbaraw),i.vba.push(s),mt(e.wbrels,-1,"vbaProject.bin",Ze.VBA)),s="xl/metadata."+r,Xe(a,s,x9(s)),i.metadata.push(s),mt(e.wbrels,-1,"metadata."+r,Ze.XLMETA),Xe(a,"[Content_Types].xml",aS(i,e)),Xe(a,"_rels/.rels",sl(e.rels)),Xe(a,"xl/_rels/workbook."+r+".rels",sl(e.wbrels)),delete e.revssf,delete e.ssf,a}function B7(t,e){Qo=1024,t&&!t.SSF&&(t.SSF=Dt(Le)),t&&t.SSF&&(Bl(),ad(t.SSF),e.revssf=od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=GS.indexOf(e.bookType)>-1,i=Xv();ux(e=e||{});var a=Ov(),s="",o=0;if(e.cellXfs=[],xs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Xe(a,s,lS(t.Props,e)),i.coreprops.push(s),mt(e.rels,2,s,Ze.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Xe(a,s,fS(t.Props)),i.extprops.push(s),mt(e.rels,3,s,Ze.EXT_PROPS),t.Custprops!==t.Props&&Yt(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Xe(a,s,hS(t.Custprops)),i.custprops.push(s),mt(e.rels,4,s,Ze.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Xe(a,s,nA(o-1,e,t,h)),i.sheets.push(s),mt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(d){var g=d["!comments"],m=!1,_="";if(g&&g.length>0){var y=!1;g.forEach(function(T){T[1].forEach(function(w){w.T==!0&&(y=!0)})}),y&&(_="xl/threadedComments/threadedComment"+o+"."+r,Xe(a,_,G6(g,u,e)),i.threadedcomments.push(_),mt(h,-1,"../threadedComments/threadedComment"+o+"."+r,Ze.TCMNT)),_="xl/comments"+o+"."+r,Xe(a,_,$S(g)),i.comments.push(_),mt(h,-1,"../comments"+o+"."+r,Ze.CMNT),m=!0}d["!legacy"]&&m&&Xe(a,"xl/drawings/vmlDrawing"+o+".vml",HS(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Xe(a,Tu(s),sl(h))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+r,Xe(a,s,FS(e.Strings,e)),i.strs.push(s),mt(e.wbrels,-1,"sharedStrings."+r,Ze.SST)),s="xl/workbook."+r,Xe(a,s,lA(t)),i.workbooks.push(s),mt(e.rels,1,s,Ze.WB),s="xl/theme/theme1.xml",Xe(a,s,tx(t.Themes,e)),i.themes.push(s),mt(e.wbrels,-1,"theme/theme1.xml",Ze.THEME),s="xl/styles."+r,Xe(a,s,VS(t,e)),i.styles.push(s),mt(e.wbrels,-1,"styles."+r,Ze.STY),t.vbaraw&&n&&(s="xl/vbaProject.bin",Xe(a,s,t.vbaraw),i.vba.push(s),mt(e.wbrels,-1,"vbaProject.bin",Ze.VBA)),s="xl/metadata."+r,Xe(a,s,WS()),i.metadata.push(s),mt(e.wbrels,-1,"metadata."+r,Ze.XLMETA),u.length>1&&(s="xl/persons/person.xml",Xe(a,s,K6(u)),i.people.push(s),mt(e.wbrels,-1,"persons/person.xml",Ze.PEOPLE)),Xe(a,"[Content_Types].xml",aS(i,e)),Xe(a,"_rels/.rels",sl(e.rels)),Xe(a,"xl/_rels/workbook."+r+".rels",sl(e.wbrels)),delete e.revssf,delete e.ssf,a}function fx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Mn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function V7(t,e){return Pe.find(t,"EncryptedPackage")?L7(t,e):hA(t,e)}function U7(t,e){var r,n=t,i=e||{};return i.type||(i.type=Je&&Buffer.isBuffer(t)?"buffer":"base64"),r=Dk(n,i),O7(r,i)}function yA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Jm(t.slice(r),e);default:break e}return Sl.to_workbook(t,e)}function z7(t,e){var r="",n=fx(t,e);switch(e.type){case"base64":r=Mn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Zs(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=_t(r)),e.type="binary",yA(r,e)}function W7(t,e){var r=t;return e.type=="base64"&&(r=Mn(r)),r=Pa.utils.decode(1200,r.slice(2),"str"),e.type="binary",yA(r,e)}function H7(t){return t.match(/[^\x00-\x7F]/)?Ai(t):t}function Fp(t,e,r,n){return n?(r.type="string",Sl.to_workbook(t,r)):Sl.to_workbook(e,r)}function tg(t,e){Nv();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return tg(new Uint8Array(t),(r=Dt(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ll={},r.dateNF&&(ll.dateNF=r.dateNF),r.type||(r.type=Je&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Je?"buffer":"binary",n=j3(t),typeof Uint8Array<"u"&&!Je&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=H7(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Dt(r),r.type="array",tg(Rv(n),r)}switch((i=fx(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return V7(Pe.read(n,r),r);break;case 9:if(i[1]<=8)return hA(n,r);break;case 60:return Jm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return XD(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return NS.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?U7(n,r):Fp(t,n,r,a);case 239:return i[3]===60?Jm(n,r):Fp(t,n,r,a);case 255:if(i[1]===254)return W7(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Hs.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Hs.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Qm.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return MS.to_workbook(n,r);break;case 10:case 13:case 32:return z7(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return KD.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Qm.to_workbook(n,r):Fp(t,n,r,a)}function wA(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Gu(e.file,Pe.write(t,{type:Je?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pe.write(t,e)}function $7(t,e){var r=Dt(e||{}),n=M7(t,r);return G7(n,r)}function G7(t,e){var r={},n=Je?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Pe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(id(i))}return e.password&&typeof encrypt_agile<"u"?wA(encrypt_agile(i,e.password),e):e.type==="file"?Gu(e.file,i):e.type=="string"?_t(i):i}function q7(t,e){var r=e||{},n=H9(t,r);return wA(n,r)}function Ti(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return xu(Ai(n));case"binary":return Ai(n);case"string":return t;case"file":return Gu(e.file,n,"utf8");case"buffer":return Je?ma(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ti(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function K7(t,e){switch(e.type){case"base64":return xu(t);case"binary":return t;case"string":return t;case"file":return Gu(e.file,t,"binary");case"buffer":return Je?ma(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function s0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?xu(r):e.type=="string"?_t(r):r;case"file":return Gu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function EA(t,e){Nv(),VM(t);var r=Dt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=EA(t,r);return r.type="array",id(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ti(M9(t,r),r);case"slk":case"sylk":return Ti(CS.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Ti(pA(t.Sheets[t.SheetNames[i]],r),r);case"txt":return K7(TA(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Ti(hx(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ti(NS.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return s0(Qm.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Ti(Sl.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Ti(MS.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Ti(RS.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Ti(xA(t,r),r);case"wk1":return s0(Hs.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return s0(Hs.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),s0(dA(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),q7(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $7(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function X7(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Y7(t,e,r){var n={};return n.type="file",n.file=e,X7(n),EA(t,n)}function Q7(t,e,r,n,i,a,s,o){var l=er(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!s||t[r])for(var p=e.s.c;p<=e.e.c;++p){var g=s?t[r][p]:t[n[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[p]!=null&&(d[a[p]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[p]!=null){if(m==null)if(g.t=="e"&&m===null)d[a[p]]=null;else if(c!==void 0)d[a[p]]=c;else if(u&&m===null)d[a[p]]=null;else continue;else d[a[p]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:ca(g,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function wh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=lt(u);break;case"number":l=lt(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=er(l.s.r),d=[],p=[],g=0,m=0,_=Array.isArray(t),y=l.s.r,T=0,w={};_&&!t[y]&&(t[y]=[]);var R=c.skipHidden&&t["!cols"]||[],j=c.skipHidden&&t["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(R[T]||{}).hidden)switch(d[T]=Vt(T),r=_?t[y][T]:t[d[T]+h],n){case 1:a[T]=T-l.s.c;break;case 2:a[T]=d[T];break;case 3:a[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=ca(r,null,c),m=w[s]||0,!m)w[s]=1;else{do o=s+"_"+m++;while(w[o]);w[s]=m,w[o]=1}a[T]=o}for(y=l.s.r+i;y<=l.e.r;++y)if(!(j[y]||{}).hidden){var D=Q7(t,l,y,d,n,a,_,c);(D.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=D.row)}return p.length=g,p}var dw=/"/g;function J7(t,e,r,n,i,a,s,o){for(var l=!0,c=[],u="",h=er(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:ca(p,null,o));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===i||m===a||m===34||o.forceQuotes){u='"'+u.replace(dw,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(dw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function hx(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=lt(t["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=Vt(g));for(var m=0,_=i.s.r;_<=i.e.r;++_)(p[_]||{}).hidden||(u=J7(t,i,_,h,s,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function TA(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=hx(t,e);return r}function Z7(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=lt(t["!ref"]),a="",s=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)s[o]=Vt(o);for(var u=i.s.r;u<=i.e.r;++u)for(a=er(u),o=i.s.c;o<=i.e.c;++o)if(e=s[o]+a,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function kA(t,e,r){var n=r||{},i=+!n.skipHeader,a=t||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Ut(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+e.length-1+i}};if(a["!ref"]){var h=lt(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(s=h.e.r+1,u.e.r=s+e.length-1+i)}else s==-1&&(s=0,u.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(m,_){Yt(m).forEach(function(y){(p=d.indexOf(y))==-1&&(d[p=d.length]=y);var T=m[y],w="z",R="",j=Me({c:o+p,r:s+_+i});c=Nu(a,j),T&&typeof T=="object"&&!(T instanceof Date)?a[j]=T:(typeof T=="number"?w="n":typeof T=="boolean"?w="b":typeof T=="string"?w="s":T instanceof Date?(w="d",n.cellDates||(w="n",T=gr(T)),R=n.dateNF||Le[14]):T===null&&n.nullError&&(w="e",T=0),c?(c.t=w,c.v=T,delete c.w,delete c.R,R&&(c.z=R)):a[j]=c={t:w,v:T},R&&(c.z=R))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var g=er(s);if(i)for(p=0;p<d.length;++p)a[Vt(p+o)+g]={t:"s",v:d[p]};return a["!ref"]=qe(u),a}function ej(t,e){return kA(null,t,e)}function Nu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ut(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Nu(t,Me(e)):Nu(t,Me({r:e,c:r||0}))}function tj(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function dx(){return{SheetNames:[],Sheets:{}}}function px(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=s+i)!=-1;++i);}if(oA(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function rj(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=tj(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function nj(t,e){return t.z=e,t}function SA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function ij(t,e,r){return SA(t,"#"+e,r)}function aj(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function sj(t,e,r,n){for(var i=typeof e!="string"?e:lt(e),a=typeof e=="string"?e:qe(e),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=Nu(t,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var cl={encode_col:Vt,encode_row:er,encode_cell:Me,encode_range:qe,decode_col:Wv,decode_row:zv,split_cell:gF,decode_cell:Ut,decode_range:kn,format_cell:ca,sheet_add_aoa:Jk,sheet_add_json:kA,sheet_add_dom:mA,aoa_to_sheet:Vl,json_to_sheet:ej,table_to_sheet:gA,table_to_book:h7,sheet_to_csv:hx,sheet_to_txt:TA,sheet_to_json:wh,sheet_to_html:pA,sheet_to_formulae:Z7,sheet_to_row_object_array:wh,sheet_get_cell:Nu,book_new:dx,book_append_sheet:px,book_set_sheet_visibility:rj,cell_set_number_format:nj,cell_set_hyperlink:SA,cell_set_internal_link:ij,cell_add_comment:aj,sheet_set_array_formula:sj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const oj=t=>{let e="";for(;t>=0;)e=String.fromCharCode(t%26+65)+e,t=Math.floor(t/26)-1;return e};function lj({onFileLoad:t}){const e=X.useCallback(a=>{const s=a[0],o=new FileReader;o.onload=l=>{var T;const c=(T=l.target)==null?void 0:T.result,u=tg(c,{type:"array"}),h=u.SheetNames,d=u.Sheets[h[0]],p=cl.decode_range(d["!ref"]||"A1"),g=[],m={};for(let w=p.s.c;w<=p.e.c;w++){const R=oj(w),j=`${R}1`,D=d[cl.encode_cell({r:0,c:w})];if(D&&D.v){const E=D.v.toString().trim();g.push(E),m[E]=j}else{const E=`Column ${R}`;g.push(E),m[E]=j}}const y=cl.sheet_to_json(d,{header:g,defval:""}).slice(1);t(y,h,m)},o.readAsArrayBuffer(s)},[t]),{getRootProps:r,getInputProps:n,isDragActive:i}=hk({onDrop:e,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1});return x.jsxs("div",{...r(),className:`p-8 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors
        ${i?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"}`,children:[x.jsx("input",{...n()}),x.jsx(mk,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),x.jsx("p",{className:"text-lg font-medium text-gray-600",children:i?"Drop the Excel file here":"Drag & drop an Excel file here, or click to select"}),x.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Supports .xlsx and .xls files"})]})}const Hi=[{key:"last_name",label:"Last Name"},{key:"first_name",label:"First Name"},{key:"middle_name",label:"Middle Name"},{key:"extension_name",label:"Extension Name (Jr., Sr., III, etc.)"},{key:"birth_month",label:"Birth Month"},{key:"birth_day",label:"Birth Day"},{key:"birth_year",label:"Birth Year"},{key:"sex",label:"Sex"},{key:"barangay",label:"Barangay"},{key:"psgc_city",label:"PSGC City"},{key:"city",label:"City"},{key:"province",label:"Province"},{key:"type_of_assistance",label:"Type of Assistance"},{key:"amount",label:"Amount"},{key:"philsys_number",label:"PhilSys Number"},{key:"beneficiary_uniq",label:"Beneficiary ID"},{key:"contact_number",label:"Contact Number"},{key:"target_sector",label:"Target Sector"},{key:"sub_category",label:"Sub Category"},{key:"civil_status",label:"Civil Status"}];function cj({columns:t,mappings:e,onMappingChange:r,columnRefs:n}){const[i,a]=X.useState(""),[s,o]=X.useState(!1),[l,c]=X.useState({});X.useEffect(()=>{const g={};t.forEach(m=>{const _=m.toLowerCase().trim(),y=Hi.find(j=>j.key.toLowerCase()===_);if(y){g[m]={dbField:y.key,exactMatch:!0};return}const T=Hi.find(j=>j.label.toLowerCase()===_);if(T){g[m]={dbField:T.key,exactMatch:!0};return}const w=Hi.find(j=>_.includes(j.key.toLowerCase())||j.key.toLowerCase().includes(_));if(w){g[m]={dbField:w.key,exactMatch:!1};return}const R=Hi.find(j=>_.includes(j.label.toLowerCase())||j.label.toLowerCase().includes(_));R&&(g[m]={dbField:R.key,exactMatch:!1})}),c(g)},[t]);const u=Hi.filter(g=>g.key.toLowerCase().includes(i.toLowerCase())||g.label.toLowerCase().includes(i.toLowerCase())),h=t.filter(g=>g.toLowerCase().includes(i.toLowerCase())),d=()=>{Object.entries(l).forEach(([g,{dbField:m}])=>{e[g]||r(g,m)})},p=()=>{Object.entries(l).forEach(([g,{dbField:m,exactMatch:_}])=>{!e[g]&&_&&r(g,m)})};return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[x.jsxs("div",{className:"flex justify-between items-center mb-6",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Column Mapping"}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:p,className:"flex items-center px-3 py-2 rounded-md bg-green-100 text-green-700 hover:bg-green-200",title:"Apply only exact matches",children:"Auto-Map Exact"}),x.jsx("button",{onClick:d,className:"flex items-center px-3 py-2 rounded-md bg-yellow-100 text-yellow-700 hover:bg-yellow-200",title:"Apply all suggested mappings",children:"Auto-Map All"})]}),x.jsxs("button",{onClick:()=>o(!s),className:`flex items-center px-3 py-2 rounded-md ${s?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"} hover:bg-blue-50`,children:[x.jsx(i3,{className:"w-4 h-4 mr-2"}),s?"Hide Excel Columns":"Show Excel Columns"]}),x.jsxs("div",{className:"relative",children:[x.jsx(Iv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),x.jsx("input",{type:"text",placeholder:"Search fields...",value:i,onChange:g=>a(g.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),s&&x.jsxs("div",{className:"mb-6",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-3",children:"Excel Columns"}),x.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 overflow-x-auto",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[x.jsx("thead",{children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Column Reference"}),x.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Column Name"}),x.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mapped To"})]})}),x.jsx("tbody",{className:"divide-y divide-gray-200",children:h.map(g=>{var m,_;return x.jsxs("tr",{className:"hover:bg-gray-100",children:[x.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:n[g]||"-"}),x.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-700",children:g}),x.jsx("td",{className:"px-4 py-2 text-sm",children:e[g]?x.jsx("span",{className:"text-green-600",children:((m=Hi.find(y=>y.key===e[g]))==null?void 0:m.label)||e[g]}):l[g]?x.jsxs("span",{className:l[g].exactMatch?"text-blue-600 italic":"text-red-600 italic",children:["Suggested: ",(_=Hi.find(y=>y.key===l[g].dbField))==null?void 0:_.label]}):"-"})]},g)})})]})})]}),x.jsx("div",{className:"grid grid-cols-1 gap-4",children:u.map(({key:g,label:m})=>{var _;return x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[x.jsxs("div",{className:"flex justify-between items-center mb-2",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:m}),x.jsxs("span",{className:"text-xs text-gray-500",children:["Database field: ",g]})]}),Object.entries(e).find(([y,T])=>T===g)&&x.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Mapped"})]}),x.jsxs("select",{value:((_=Object.entries(e).find(([y,T])=>T===g))==null?void 0:_[0])||"",onChange:y=>{var w;const T=(w=Object.entries(e).find(([R,j])=>j===g))==null?void 0:w[0];T&&r(T,""),y.target.value&&r(y.target.value,g)},className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[x.jsx("option",{value:"",children:"Select Excel Column"}),t.map(y=>{const T=l[y],w=T&&T.dbField===g;return x.jsxs("option",{value:y,disabled:!!(e[y]&&e[y]!==g),className:w?T.exactMatch?"text-blue-600":"text-red-600":"",children:[n[y]?`${n[y]} - ${y}`:y,w&&(T.exactMatch?" (Exact Match)":" (Similar Match)")]},y)})]}),g==="extension_name"&&x.jsx("p",{className:"mt-2 text-xs text-gray-500 italic",children:"Common values: Jr., Sr., III, IV, etc."})]},g)})})]}),x.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Mapping Progress"}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:"h-2 flex-1 bg-gray-200 rounded-full overflow-hidden",children:x.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:`${Object.keys(e).length/Hi.length*100}%`}})}),x.jsxs("span",{className:"text-sm text-gray-600 min-w-[4rem]",children:[Object.keys(e).length," / ",Hi.length]})]})]})]})}var pw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},uj=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],s=t[r++],o=t[r++],l=((i&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},IA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],s=i+1<t.length,o=s?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,s||(d=64)),n.push(r[u],r[h],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(AA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):uj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||o==null||c==null||h==null)throw new fj;const d=a<<2|o>>4;if(n.push(d),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const g=c<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class fj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hj=function(t){const e=AA(t);return IA.encodeByteArray(e,!0)},Eh=function(t){return hj(t).replace(/\./g,"")},bA=function(t){try{return IA.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=()=>dj().__FIREBASE_DEFAULTS__,mj=()=>{if(typeof process>"u"||typeof pw>"u")return;const t=pw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},gj=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&bA(t[1]);return e&&JSON.parse(e)},dd=()=>{try{return pj()||mj()||gj()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},CA=t=>{var e,r;return(r=(e=dd())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},vj=t=>{const e=CA(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},NA=()=>{var t;return(t=dd())===null||t===void 0?void 0:t.config},RA=t=>{var e;return(e=dd())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _j(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Eh(JSON.stringify(r)),Eh(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zr())}function wj(){var t;const e=(t=dd())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ej(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Tj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function kj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Sj(){const t=Zr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Aj(){return!wj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ij(){try{return typeof indexedDB=="object"}catch{return!1}}function bj(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj="FirebaseError";class xa extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Cj,Object.setPrototypeOf(this,xa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ef.prototype.create)}}class ef{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?Nj(a,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new xa(i,o,n)}}function Nj(t,e){return t.replace(Rj,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Rj=/\{\$([^}]+)}/g;function Fj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Th(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],s=e[i];if(mw(a)&&mw(s)){if(!Th(a,s))return!1}else if(a!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function mw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function wc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Ec(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function Pj(t,e){const r=new Dj(t,e);return r.subscribe.bind(r)}class Dj{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Oj(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Pp),i.error===void 0&&(i.error=Pp),i.complete===void 0&&(i.complete=Pp);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Oj(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Pp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t){return t&&t._delegate?t._delegate:t}class io{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new xj;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jj(e))try{this.getOrInitializeService({instanceIdentifier:Rs})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Rs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rs){return this.instances.has(e)}getOptions(e=Rs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&s.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const s=this.instances.get(i);return s&&e(s,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Mj(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Rs){return this.component?this.component.multipleInstances?e:Rs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Mj(t){return t===Rs?void 0:t}function jj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Lj(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(rt||(rt={}));const Vj={debug:rt.DEBUG,verbose:rt.VERBOSE,info:rt.INFO,warn:rt.WARN,error:rt.ERROR,silent:rt.SILENT},Uj=rt.INFO,zj={[rt.DEBUG]:"log",[rt.VERBOSE]:"log",[rt.INFO]:"info",[rt.WARN]:"warn",[rt.ERROR]:"error"},Wj=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=zj[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mx{constructor(e){this.name=e,this._logLevel=Uj,this._logHandler=Wj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Vj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,rt.DEBUG,...e),this._logHandler(this,rt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,rt.VERBOSE,...e),this._logHandler(this,rt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,rt.INFO,...e),this._logHandler(this,rt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,rt.WARN,...e),this._logHandler(this,rt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,rt.ERROR,...e),this._logHandler(this,rt.ERROR,...e)}}const Hj=(t,e)=>e.some(r=>t instanceof r);let gw,vw;function $j(){return gw||(gw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Gj(){return vw||(vw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const FA=new WeakMap,rg=new WeakMap,PA=new WeakMap,Dp=new WeakMap,gx=new WeakMap;function qj(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{r(Za(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&FA.set(r,t)}).catch(()=>{}),gx.set(e,t),e}function Kj(t){if(rg.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});rg.set(t,e)}let ng={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return rg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||PA.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Za(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Xj(t){ng=t(ng)}function Yj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Op(this),e,...r);return PA.set(n,e.sort?e.sort():[e]),Za(n)}:Gj().includes(t)?function(...e){return t.apply(Op(this),e),Za(FA.get(this))}:function(...e){return Za(t.apply(Op(this),e))}}function Qj(t){return typeof t=="function"?Yj(t):(t instanceof IDBTransaction&&Kj(t),Hj(t,$j())?new Proxy(t,ng):t)}function Za(t){if(t instanceof IDBRequest)return qj(t);if(Dp.has(t))return Dp.get(t);const e=Qj(t);return e!==t&&(Dp.set(t,e),gx.set(e,t)),e}const Op=t=>gx.get(t);function Jj(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),o=Za(s);return n&&s.addEventListener("upgradeneeded",l=>{n(Za(s.result),l.oldVersion,l.newVersion,Za(s.transaction),l)}),r&&s.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const Zj=["get","getKey","getAll","getAllKeys","count"],eB=["put","add","delete","clear"],Lp=new Map;function xw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Lp.get(e))return Lp.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=eB.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Zj.includes(r)))return;const a=async function(s,...o){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Lp.set(e,a),a}Xj(t=>({...t,get:(e,r,n)=>xw(e,r)||t.get(e,r,n),has:(e,r)=>!!xw(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(rB(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function rB(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ig="@firebase/app",_w="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua=new mx("@firebase/app"),nB="@firebase/app-compat",iB="@firebase/analytics-compat",aB="@firebase/analytics",sB="@firebase/app-check-compat",oB="@firebase/app-check",lB="@firebase/auth",cB="@firebase/auth-compat",uB="@firebase/database",fB="@firebase/data-connect",hB="@firebase/database-compat",dB="@firebase/functions",pB="@firebase/functions-compat",mB="@firebase/installations",gB="@firebase/installations-compat",vB="@firebase/messaging",xB="@firebase/messaging-compat",_B="@firebase/performance",yB="@firebase/performance-compat",wB="@firebase/remote-config",EB="@firebase/remote-config-compat",TB="@firebase/storage",kB="@firebase/storage-compat",SB="@firebase/firestore",AB="@firebase/vertexai-preview",IB="@firebase/firestore-compat",bB="firebase",CB="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="[DEFAULT]",NB={[ig]:"fire-core",[nB]:"fire-core-compat",[aB]:"fire-analytics",[iB]:"fire-analytics-compat",[oB]:"fire-app-check",[sB]:"fire-app-check-compat",[lB]:"fire-auth",[cB]:"fire-auth-compat",[uB]:"fire-rtdb",[fB]:"fire-data-connect",[hB]:"fire-rtdb-compat",[dB]:"fire-fn",[pB]:"fire-fn-compat",[mB]:"fire-iid",[gB]:"fire-iid-compat",[vB]:"fire-fcm",[xB]:"fire-fcm-compat",[_B]:"fire-perf",[yB]:"fire-perf-compat",[wB]:"fire-rc",[EB]:"fire-rc-compat",[TB]:"fire-gcs",[kB]:"fire-gcs-compat",[SB]:"fire-fst",[IB]:"fire-fst-compat",[AB]:"fire-vertex","fire-js":"fire-js",[bB]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh=new Map,RB=new Map,sg=new Map;function yw(t,e){try{t.container.addComponent(e)}catch(r){ua.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Il(t){const e=t.name;if(sg.has(e))return ua.debug(`There were multiple attempts to register component ${e}.`),!1;sg.set(e,t);for(const r of kh.values())yw(r,t);for(const r of RB.values())yw(r,t);return!0}function vx(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ii(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FB={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},es=new ef("app","Firebase",FB);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PB{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new io("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw es.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zl=CB;function DA(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ag,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw es.create("bad-app-name",{appName:String(i)});if(r||(r=NA()),!r)throw es.create("no-options");const a=kh.get(i);if(a){if(Th(r,a.options)&&Th(n,a.config))return a;throw es.create("duplicate-app",{appName:i})}const s=new Bj(i);for(const l of sg.values())s.addComponent(l);const o=new PB(r,n,s);return kh.set(i,o),o}function OA(t=ag){const e=kh.get(t);if(!e&&t===ag&&NA())return DA();if(!e)throw es.create("no-app",{appName:t});return e}function ts(t,e,r){var n;let i=(n=NB[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const a=i.match(/\s|\//),s=e.match(/\s|\//);if(a||s){const o=[`Unable to register library "${i}" with version "${e}":`];a&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ua.warn(o.join(" "));return}Il(new io(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB="firebase-heartbeat-database",OB=1,Ru="firebase-heartbeat-store";let Mp=null;function LA(){return Mp||(Mp=Jj(DB,OB,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ru)}catch(r){console.warn(r)}}}}).catch(t=>{throw es.create("idb-open",{originalErrorMessage:t.message})})),Mp}async function LB(t){try{const r=(await LA()).transaction(Ru),n=await r.objectStore(Ru).get(MA(t));return await r.done,n}catch(e){if(e instanceof xa)ua.warn(e.message);else{const r=es.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ua.warn(r.message)}}}async function ww(t,e){try{const n=(await LA()).transaction(Ru,"readwrite");await n.objectStore(Ru).put(e,MA(t)),await n.done}catch(r){if(r instanceof xa)ua.warn(r.message);else{const n=es.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ua.warn(n.message)}}}function MA(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MB=1024,jB=30*24*60*60*1e3;class BB{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new UB(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Ew();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(s=>s.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=jB}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ua.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Ew(),{heartbeatsToSend:n,unsentEntries:i}=VB(this._heartbeatsCache.heartbeats),a=Eh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return ua.warn(r),""}}}function Ew(){return new Date().toISOString().substring(0,10)}function VB(t,e=MB){const r=[];let n=t.slice();for(const i of t){const a=r.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),Tw(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Tw(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class UB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ij()?bj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await LB(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return ww(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return ww(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Tw(t){return Eh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(t){Il(new io("platform-logger",e=>new tB(e),"PRIVATE")),Il(new io("heartbeat",e=>new BB(e),"PRIVATE")),ts(ig,_w,t),ts(ig,_w,"esm2017"),ts("fire-js","")}zB("");var WB="firebase",HB="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ts(WB,HB,"app");var kw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gs,jA;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,S){function k(){}k.prototype=S.prototype,E.D=S.prototype,E.prototype=new k,E.prototype.constructor=E,E.C=function(I,b,N){for(var F=Array(arguments.length-2),he=2;he<arguments.length;he++)F[he-2]=arguments[he];return S.prototype[b].apply(I,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,S,k){k||(k=0);var I=Array(16);if(typeof S=="string")for(var b=0;16>b;++b)I[b]=S.charCodeAt(k++)|S.charCodeAt(k++)<<8|S.charCodeAt(k++)<<16|S.charCodeAt(k++)<<24;else for(b=0;16>b;++b)I[b]=S[k++]|S[k++]<<8|S[k++]<<16|S[k++]<<24;S=E.g[0],k=E.g[1],b=E.g[2];var N=E.g[3],F=S+(N^k&(b^N))+I[0]+3614090360&4294967295;S=k+(F<<7&4294967295|F>>>25),F=N+(b^S&(k^b))+I[1]+3905402710&4294967295,N=S+(F<<12&4294967295|F>>>20),F=b+(k^N&(S^k))+I[2]+606105819&4294967295,b=N+(F<<17&4294967295|F>>>15),F=k+(S^b&(N^S))+I[3]+3250441966&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(N^k&(b^N))+I[4]+4118548399&4294967295,S=k+(F<<7&4294967295|F>>>25),F=N+(b^S&(k^b))+I[5]+1200080426&4294967295,N=S+(F<<12&4294967295|F>>>20),F=b+(k^N&(S^k))+I[6]+2821735955&4294967295,b=N+(F<<17&4294967295|F>>>15),F=k+(S^b&(N^S))+I[7]+4249261313&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(N^k&(b^N))+I[8]+1770035416&4294967295,S=k+(F<<7&4294967295|F>>>25),F=N+(b^S&(k^b))+I[9]+2336552879&4294967295,N=S+(F<<12&4294967295|F>>>20),F=b+(k^N&(S^k))+I[10]+4294925233&4294967295,b=N+(F<<17&4294967295|F>>>15),F=k+(S^b&(N^S))+I[11]+2304563134&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(N^k&(b^N))+I[12]+1804603682&4294967295,S=k+(F<<7&4294967295|F>>>25),F=N+(b^S&(k^b))+I[13]+4254626195&4294967295,N=S+(F<<12&4294967295|F>>>20),F=b+(k^N&(S^k))+I[14]+2792965006&4294967295,b=N+(F<<17&4294967295|F>>>15),F=k+(S^b&(N^S))+I[15]+1236535329&4294967295,k=b+(F<<22&4294967295|F>>>10),F=S+(b^N&(k^b))+I[1]+4129170786&4294967295,S=k+(F<<5&4294967295|F>>>27),F=N+(k^b&(S^k))+I[6]+3225465664&4294967295,N=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(N^S))+I[11]+643717713&4294967295,b=N+(F<<14&4294967295|F>>>18),F=k+(N^S&(b^N))+I[0]+3921069994&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(b^N&(k^b))+I[5]+3593408605&4294967295,S=k+(F<<5&4294967295|F>>>27),F=N+(k^b&(S^k))+I[10]+38016083&4294967295,N=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(N^S))+I[15]+3634488961&4294967295,b=N+(F<<14&4294967295|F>>>18),F=k+(N^S&(b^N))+I[4]+3889429448&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(b^N&(k^b))+I[9]+568446438&4294967295,S=k+(F<<5&4294967295|F>>>27),F=N+(k^b&(S^k))+I[14]+3275163606&4294967295,N=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(N^S))+I[3]+4107603335&4294967295,b=N+(F<<14&4294967295|F>>>18),F=k+(N^S&(b^N))+I[8]+1163531501&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(b^N&(k^b))+I[13]+2850285829&4294967295,S=k+(F<<5&4294967295|F>>>27),F=N+(k^b&(S^k))+I[2]+4243563512&4294967295,N=S+(F<<9&4294967295|F>>>23),F=b+(S^k&(N^S))+I[7]+1735328473&4294967295,b=N+(F<<14&4294967295|F>>>18),F=k+(N^S&(b^N))+I[12]+2368359562&4294967295,k=b+(F<<20&4294967295|F>>>12),F=S+(k^b^N)+I[5]+4294588738&4294967295,S=k+(F<<4&4294967295|F>>>28),F=N+(S^k^b)+I[8]+2272392833&4294967295,N=S+(F<<11&4294967295|F>>>21),F=b+(N^S^k)+I[11]+1839030562&4294967295,b=N+(F<<16&4294967295|F>>>16),F=k+(b^N^S)+I[14]+4259657740&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(k^b^N)+I[1]+2763975236&4294967295,S=k+(F<<4&4294967295|F>>>28),F=N+(S^k^b)+I[4]+1272893353&4294967295,N=S+(F<<11&4294967295|F>>>21),F=b+(N^S^k)+I[7]+4139469664&4294967295,b=N+(F<<16&4294967295|F>>>16),F=k+(b^N^S)+I[10]+3200236656&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(k^b^N)+I[13]+681279174&4294967295,S=k+(F<<4&4294967295|F>>>28),F=N+(S^k^b)+I[0]+3936430074&4294967295,N=S+(F<<11&4294967295|F>>>21),F=b+(N^S^k)+I[3]+3572445317&4294967295,b=N+(F<<16&4294967295|F>>>16),F=k+(b^N^S)+I[6]+76029189&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(k^b^N)+I[9]+3654602809&4294967295,S=k+(F<<4&4294967295|F>>>28),F=N+(S^k^b)+I[12]+3873151461&4294967295,N=S+(F<<11&4294967295|F>>>21),F=b+(N^S^k)+I[15]+530742520&4294967295,b=N+(F<<16&4294967295|F>>>16),F=k+(b^N^S)+I[2]+3299628645&4294967295,k=b+(F<<23&4294967295|F>>>9),F=S+(b^(k|~N))+I[0]+4096336452&4294967295,S=k+(F<<6&4294967295|F>>>26),F=N+(k^(S|~b))+I[7]+1126891415&4294967295,N=S+(F<<10&4294967295|F>>>22),F=b+(S^(N|~k))+I[14]+2878612391&4294967295,b=N+(F<<15&4294967295|F>>>17),F=k+(N^(b|~S))+I[5]+4237533241&4294967295,k=b+(F<<21&4294967295|F>>>11),F=S+(b^(k|~N))+I[12]+1700485571&4294967295,S=k+(F<<6&4294967295|F>>>26),F=N+(k^(S|~b))+I[3]+2399980690&4294967295,N=S+(F<<10&4294967295|F>>>22),F=b+(S^(N|~k))+I[10]+4293915773&4294967295,b=N+(F<<15&4294967295|F>>>17),F=k+(N^(b|~S))+I[1]+2240044497&4294967295,k=b+(F<<21&4294967295|F>>>11),F=S+(b^(k|~N))+I[8]+1873313359&4294967295,S=k+(F<<6&4294967295|F>>>26),F=N+(k^(S|~b))+I[15]+4264355552&4294967295,N=S+(F<<10&4294967295|F>>>22),F=b+(S^(N|~k))+I[6]+2734768916&4294967295,b=N+(F<<15&4294967295|F>>>17),F=k+(N^(b|~S))+I[13]+1309151649&4294967295,k=b+(F<<21&4294967295|F>>>11),F=S+(b^(k|~N))+I[4]+4149444226&4294967295,S=k+(F<<6&4294967295|F>>>26),F=N+(k^(S|~b))+I[11]+3174756917&4294967295,N=S+(F<<10&4294967295|F>>>22),F=b+(S^(N|~k))+I[2]+718787259&4294967295,b=N+(F<<15&4294967295|F>>>17),F=k+(N^(b|~S))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+S&4294967295,E.g[1]=E.g[1]+(b+(F<<21&4294967295|F>>>11))&4294967295,E.g[2]=E.g[2]+b&4294967295,E.g[3]=E.g[3]+N&4294967295}n.prototype.u=function(E,S){S===void 0&&(S=E.length);for(var k=S-this.blockSize,I=this.B,b=this.h,N=0;N<S;){if(b==0)for(;N<=k;)i(this,E,N),N+=this.blockSize;if(typeof E=="string"){for(;N<S;)if(I[b++]=E.charCodeAt(N++),b==this.blockSize){i(this,I),b=0;break}}else for(;N<S;)if(I[b++]=E[N++],b==this.blockSize){i(this,I),b=0;break}}this.h=b,this.o+=S},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var S=1;S<E.length-8;++S)E[S]=0;var k=8*this.o;for(S=E.length-8;S<E.length;++S)E[S]=k&255,k/=256;for(this.u(E),E=Array(16),S=k=0;4>S;++S)for(var I=0;32>I;I+=8)E[k++]=this.g[S]>>>I&255;return E};function a(E,S){var k=o;return Object.prototype.hasOwnProperty.call(k,E)?k[E]:k[E]=S(E)}function s(E,S){this.h=S;for(var k=[],I=!0,b=E.length-1;0<=b;b--){var N=E[b]|0;I&&N==S||(k[b]=N,I=!1)}this.g=k}var o={};function l(E){return-128<=E&&128>E?a(E,function(S){return new s([S|0],0>S?-1:0)}):new s([E|0],0>E?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return _(c(-E));for(var S=[],k=1,I=0;E>=k;I++)S[I]=E/k|0,k*=4294967296;return new s(S,0)}function u(E,S){if(E.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E.charAt(0)=="-")return _(u(E.substring(1),S));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(S,8)),I=h,b=0;b<E.length;b+=8){var N=Math.min(8,E.length-b),F=parseInt(E.substring(b,b+N),S);8>N?(N=c(Math.pow(S,N)),I=I.j(N).add(c(F))):(I=I.j(k),I=I.add(c(F)))}return I}var h=l(0),d=l(1),p=l(16777216);t=s.prototype,t.m=function(){if(m(this))return-_(this).m();for(var E=0,S=1,k=0;k<this.g.length;k++){var I=this.i(k);E+=(0<=I?I:4294967296+I)*S,S*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g(this))return"0";if(m(this))return"-"+_(this).toString(E);for(var S=c(Math.pow(E,6)),k=this,I="";;){var b=R(k,S).g;k=y(k,b.j(S));var N=((0<k.g.length?k.g[0]:k.h)>>>0).toString(E);if(k=b,g(k))return N+I;for(;6>N.length;)N="0"+N;I=N+I}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function g(E){if(E.h!=0)return!1;for(var S=0;S<E.g.length;S++)if(E.g[S]!=0)return!1;return!0}function m(E){return E.h==-1}t.l=function(E){return E=y(this,E),m(E)?-1:g(E)?0:1};function _(E){for(var S=E.g.length,k=[],I=0;I<S;I++)k[I]=~E.g[I];return new s(k,~E.h).add(d)}t.abs=function(){return m(this)?_(this):this},t.add=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],I=0,b=0;b<=S;b++){var N=I+(this.i(b)&65535)+(E.i(b)&65535),F=(N>>>16)+(this.i(b)>>>16)+(E.i(b)>>>16);I=F>>>16,N&=65535,F&=65535,k[b]=F<<16|N}return new s(k,k[k.length-1]&-2147483648?-1:0)};function y(E,S){return E.add(_(S))}t.j=function(E){if(g(this)||g(E))return h;if(m(this))return m(E)?_(this).j(_(E)):_(_(this).j(E));if(m(E))return _(this.j(_(E)));if(0>this.l(p)&&0>E.l(p))return c(this.m()*E.m());for(var S=this.g.length+E.g.length,k=[],I=0;I<2*S;I++)k[I]=0;for(I=0;I<this.g.length;I++)for(var b=0;b<E.g.length;b++){var N=this.i(I)>>>16,F=this.i(I)&65535,he=E.i(b)>>>16,de=E.i(b)&65535;k[2*I+2*b]+=F*de,T(k,2*I+2*b),k[2*I+2*b+1]+=N*de,T(k,2*I+2*b+1),k[2*I+2*b+1]+=F*he,T(k,2*I+2*b+1),k[2*I+2*b+2]+=N*he,T(k,2*I+2*b+2)}for(I=0;I<S;I++)k[I]=k[2*I+1]<<16|k[2*I];for(I=S;I<2*S;I++)k[I]=0;return new s(k,0)};function T(E,S){for(;(E[S]&65535)!=E[S];)E[S+1]+=E[S]>>>16,E[S]&=65535,S++}function w(E,S){this.g=E,this.h=S}function R(E,S){if(g(S))throw Error("division by zero");if(g(E))return new w(h,h);if(m(E))return S=R(_(E),S),new w(_(S.g),_(S.h));if(m(S))return S=R(E,_(S)),new w(_(S.g),S.h);if(30<E.g.length){if(m(E)||m(S))throw Error("slowDivide_ only works with positive integers.");for(var k=d,I=S;0>=I.l(E);)k=j(k),I=j(I);var b=D(k,1),N=D(I,1);for(I=D(I,2),k=D(k,2);!g(I);){var F=N.add(I);0>=F.l(E)&&(b=b.add(k),N=F),I=D(I,1),k=D(k,1)}return S=y(E,b.j(S)),new w(b,S)}for(b=h;0<=E.l(S);){for(k=Math.max(1,Math.floor(E.m()/S.m())),I=Math.ceil(Math.log(k)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),N=c(k),F=N.j(S);m(F)||0<F.l(E);)k-=I,N=c(k),F=N.j(S);g(N)&&(N=d),b=b.add(N),E=y(E,F)}return new w(b,E)}t.A=function(E){return R(this,E).h},t.and=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],I=0;I<S;I++)k[I]=this.i(I)&E.i(I);return new s(k,this.h&E.h)},t.or=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],I=0;I<S;I++)k[I]=this.i(I)|E.i(I);return new s(k,this.h|E.h)},t.xor=function(E){for(var S=Math.max(this.g.length,E.g.length),k=[],I=0;I<S;I++)k[I]=this.i(I)^E.i(I);return new s(k,this.h^E.h)};function j(E){for(var S=E.g.length+1,k=[],I=0;I<S;I++)k[I]=E.i(I)<<1|E.i(I-1)>>>31;return new s(k,E.h)}function D(E,S){var k=S>>5;S%=32;for(var I=E.g.length-k,b=[],N=0;N<I;N++)b[N]=0<S?E.i(N+k)>>>S|E.i(N+k+1)<<32-S:E.i(N+k);return new s(b,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,jA=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=u,Gs=s}).apply(typeof kw<"u"?kw:typeof self<"u"?self:typeof window<"u"?window:{});var o0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BA,Tc,VA,S0,og,UA,zA,WA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,A){return f==Array.prototype||f==Object.prototype||(f[v]=A.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof o0=="object"&&o0];for(var v=0;v<f.length;++v){var A=f[v];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function i(f,v){if(v)e:{var A=n;f=f.split(".");for(var L=0;L<f.length-1;L++){var Y=f[L];if(!(Y in A))break e;A=A[Y]}f=f[f.length-1],L=A[f],v=v(L),v!=L&&v!=null&&e(A,f,{configurable:!0,writable:!0,value:v})}}function a(f,v){f instanceof String&&(f+="");var A=0,L=!1,Y={next:function(){if(!L&&A<f.length){var ie=A++;return{value:v(ie,f[ie]),done:!1}}return L=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}i("Array.prototype.values",function(f){return f||function(){return a(this,function(v,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function l(f){var v=typeof f;return v=v!="object"?v:f?Array.isArray(f)?"array":v:"null",v=="array"||v=="object"&&typeof f.length=="number"}function c(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function u(f,v,A){return f.call.apply(f.bind,arguments)}function h(f,v,A){if(!f)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,L),f.apply(v,Y)}}return function(){return f.apply(v,arguments)}}function d(f,v,A){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function p(f,v){var A=Array.prototype.slice.call(arguments,1);return function(){var L=A.slice();return L.push.apply(L,arguments),f.apply(this,L)}}function g(f,v){function A(){}A.prototype=v.prototype,f.aa=v.prototype,f.prototype=new A,f.prototype.constructor=f,f.Qb=function(L,Y,ie){for(var Se=Array(arguments.length-2),kt=2;kt<arguments.length;kt++)Se[kt-2]=arguments[kt];return v.prototype[Y].apply(L,Se)}}function m(f){const v=f.length;if(0<v){const A=Array(v);for(let L=0;L<v;L++)A[L]=f[L];return A}return[]}function _(f,v){for(let A=1;A<arguments.length;A++){const L=arguments[A];if(l(L)){const Y=f.length||0,ie=L.length||0;f.length=Y+ie;for(let Se=0;Se<ie;Se++)f[Y+Se]=L[Se]}else f.push(L)}}class y{constructor(v,A){this.i=v,this.j=A,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function T(f){return/^[\s\xa0]*$/.test(f)}function w(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function R(f){return R[" "](f),f}R[" "]=function(){};var j=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function D(f,v,A){for(const L in f)v.call(A,f[L],L,f)}function E(f,v){for(const A in f)v.call(void 0,f[A],A,f)}function S(f){const v={};for(const A in f)v[A]=f[A];return v}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(f,v){let A,L;for(let Y=1;Y<arguments.length;Y++){L=arguments[Y];for(A in L)f[A]=L[A];for(let ie=0;ie<k.length;ie++)A=k[ie],Object.prototype.hasOwnProperty.call(L,A)&&(f[A]=L[A])}}function b(f){var v=1;f=f.split(":");const A=[];for(;0<v&&f.length;)A.push(f.shift()),v--;return f.length&&A.push(f.join(":")),A}function N(f){o.setTimeout(()=>{throw f},0)}function F(){var f=P;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class he{constructor(){this.h=this.g=null}add(v,A){const L=de.get();L.set(v,A),this.h?this.h.next=L:this.g=L,this.h=L}}var de=new y(()=>new Ae,f=>f.reset());class Ae{constructor(){this.next=this.g=this.h=null}set(v,A){this.h=v,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,le=!1,P=new he,Q=()=>{const f=o.Promise.resolve(void 0);ve=()=>{f.then(re)}};var re=()=>{for(var f;f=F();){try{f.h.call(f.g)}catch(A){N(A)}var v=de;v.j(f),100>v.h&&(v.h++,f.next=v.g,v.g=f)}le=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const A=()=>{};o.addEventListener("test",A,v),o.removeEventListener("test",A,v)}catch{}return f}();function G(f,v){if(q.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var A=this.type=f.type,L=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget){if(j){e:{try{R(v.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(v=null)}}else A=="mouseover"?v=f.fromElement:A=="mouseout"&&(v=f.toElement);this.relatedTarget=v,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:K[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&G.aa.h.call(this)}}g(G,q);var K={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),ae=0;function ue(f,v,A,L,Y){this.listener=f,this.proxy=null,this.src=v,this.type=A,this.capture=!!L,this.ha=Y,this.key=++ae,this.da=this.fa=!1}function ce(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function De(f){this.src=f,this.g={},this.h=0}De.prototype.add=function(f,v,A,L,Y){var ie=f.toString();f=this.g[ie],f||(f=this.g[ie]=[],this.h++);var Se=ct(f,v,L,Y);return-1<Se?(v=f[Se],A||(v.fa=!1)):(v=new ue(v,this.src,ie,!!L,Y),v.fa=A,f.push(v)),v};function W(f,v){var A=v.type;if(A in f.g){var L=f.g[A],Y=Array.prototype.indexOf.call(L,v,void 0),ie;(ie=0<=Y)&&Array.prototype.splice.call(L,Y,1),ie&&(ce(v),f.g[A].length==0&&(delete f.g[A],f.h--))}}function ct(f,v,A,L){for(var Y=0;Y<f.length;++Y){var ie=f[Y];if(!ie.da&&ie.listener==v&&ie.capture==!!A&&ie.ha==L)return Y}return-1}var Ke="closure_lm_"+(1e6*Math.random()|0),nt={};function Ge(f,v,A,L,Y){if(Array.isArray(v)){for(var ie=0;ie<v.length;ie++)Ge(f,v[ie],A,L,Y);return null}return A=Fe(A),f&&f[ne]?f.K(v,A,c(L)?!!L.capture:!!L,Y):Te(f,v,A,!1,L,Y)}function Te(f,v,A,L,Y,ie){if(!v)throw Error("Invalid event type");var Se=c(Y)?!!Y.capture:!!Y,kt=hn(f);if(kt||(f[Ke]=kt=new De(f)),A=kt.add(v,A,L,Se,ie),A.proxy)return A;if(L=wt(),A.proxy=L,L.src=f,L.listener=A,f.addEventListener)H||(Y=Se),Y===void 0&&(Y=!1),f.addEventListener(v.toString(),L,Y);else if(f.attachEvent)f.attachEvent(fn(v.toString()),L);else if(f.addListener&&f.removeListener)f.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return A}function wt(){function f(A){return v.call(f.src,f.listener,A)}const v=ji;return f}function nr(f,v,A,L,Y){if(Array.isArray(v))for(var ie=0;ie<v.length;ie++)nr(f,v[ie],A,L,Y);else L=c(L)?!!L.capture:!!L,A=Fe(A),f&&f[ne]?(f=f.i,v=String(v).toString(),v in f.g&&(ie=f.g[v],A=ct(ie,A,L,Y),-1<A&&(ce(ie[A]),Array.prototype.splice.call(ie,A,1),ie.length==0&&(delete f.g[v],f.h--)))):f&&(f=hn(f))&&(v=f.g[v.toString()],f=-1,v&&(f=ct(v,A,L,Y)),(A=-1<f?v[f]:null)&&ur(A))}function ur(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[ne])W(v.i,f);else{var A=f.type,L=f.proxy;v.removeEventListener?v.removeEventListener(A,L,f.capture):v.detachEvent?v.detachEvent(fn(A),L):v.addListener&&v.removeListener&&v.removeListener(L),(A=hn(v))?(W(A,f),A.h==0&&(A.src=null,v[Ke]=null)):ce(f)}}}function fn(f){return f in nt?nt[f]:nt[f]="on"+f}function ji(f,v){if(f.da)f=!0;else{v=new G(v,this);var A=f.listener,L=f.ha||f.src;f.fa&&ur(f),f=A.call(L,v)}return f}function hn(f){return f=f[Ke],f instanceof De?f:null}var ye="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fe(f){return typeof f=="function"?f:(f[ye]||(f[ye]=function(v){return f.handleEvent(v)}),f[ye])}function Ue(){O.call(this),this.i=new De(this),this.M=this,this.F=null}g(Ue,O),Ue.prototype[ne]=!0,Ue.prototype.removeEventListener=function(f,v,A,L){nr(this,f,v,A,L)};function Ye(f,v){var A,L=f.F;if(L)for(A=[];L;L=L.F)A.push(L);if(f=f.M,L=v.type||v,typeof v=="string")v=new q(v,f);else if(v instanceof q)v.target=v.target||f;else{var Y=v;v=new q(L,f),I(v,Y)}if(Y=!0,A)for(var ie=A.length-1;0<=ie;ie--){var Se=v.g=A[ie];Y=it(Se,L,!0,v)&&Y}if(Se=v.g=f,Y=it(Se,L,!0,v)&&Y,Y=it(Se,L,!1,v)&&Y,A)for(ie=0;ie<A.length;ie++)Se=v.g=A[ie],Y=it(Se,L,!1,v)&&Y}Ue.prototype.N=function(){if(Ue.aa.N.call(this),this.i){var f=this.i,v;for(v in f.g){for(var A=f.g[v],L=0;L<A.length;L++)ce(A[L]);delete f.g[v],f.h--}}this.F=null},Ue.prototype.K=function(f,v,A,L){return this.i.add(String(f),v,!1,A,L)},Ue.prototype.L=function(f,v,A,L){return this.i.add(String(f),v,!0,A,L)};function it(f,v,A,L){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();for(var Y=!0,ie=0;ie<v.length;++ie){var Se=v[ie];if(Se&&!Se.da&&Se.capture==A){var kt=Se.listener,kr=Se.ha||Se.src;Se.fa&&W(f.i,Se),Y=kt.call(kr,L)!==!1&&Y}}return Y&&!L.defaultPrevented}function fr(f,v,A){if(typeof f=="function")A&&(f=d(f,A));else if(f&&typeof f.handleEvent=="function")f=d(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(f,v||0)}function je(f){f.g=fr(()=>{f.g=null,f.i&&(f.i=!1,je(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class Et extends O{constructor(v,A){super(),this.m=v,this.l=A,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $t(f){O.call(this),this.h=f,this.g={}}g($t,O);var At=[];function tn(f){D(f.g,function(v,A){this.g.hasOwnProperty(A)&&ur(v)},f),f.g={}}$t.prototype.N=function(){$t.aa.N.call(this),tn(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gi=o.JSON.stringify,ys=o.JSON.parse,ws=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function vi(){}vi.prototype.h=null;function Es(f){return f.h||(f.h=f.i())}function Kl(){}var Ts={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xl(){q.call(this,"d")}g(Xl,q);function wa(){q.call(this,"c")}g(wa,q);var Bi={},vf=null;function Ao(){return vf=vf||new Ue}Bi.La="serverreachability";function xf(f){q.call(this,Bi.La,f)}g(xf,q);function ks(f){const v=Ao();Ye(v,new xf(v))}Bi.STAT_EVENT="statevent";function _f(f,v){q.call(this,Bi.STAT_EVENT,f),this.stat=v}g(_f,q);function Tr(f){const v=Ao();Ye(v,new _f(v,f))}Bi.Ma="timingevent";function yf(f,v){q.call(this,Bi.Ma,f),this.size=v}g(yf,q);function Vi(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},v)}function Ss(){this.g=!0}Ss.prototype.xa=function(){this.g=!1};function Md(f,v,A,L,Y,ie){f.info(function(){if(f.g)if(ie)for(var Se="",kt=ie.split("&"),kr=0;kr<kt.length;kr++){var ut=kt[kr].split("=");if(1<ut.length){var Lr=ut[0];ut=ut[1];var Mr=Lr.split("_");Se=2<=Mr.length&&Mr[1]=="type"?Se+(Lr+"="+ut+"&"):Se+(Lr+"=redacted&")}}else Se=null;else Se=ie;return"XMLHTTP REQ ("+L+") [attempt "+Y+"]: "+v+`
`+A+`
`+Se})}function jd(f,v,A,L,Y,ie,Se){f.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+Y+"]: "+v+`
`+A+`
`+ie+" "+Se})}function C(f,v,A,L){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+M(f,A)+(L?" "+L:"")})}function V(f,v){f.info(function(){return"TIMEOUT: "+v})}Ss.prototype.info=function(){};function M(f,v){if(!f.g)return v;if(!v)return null;try{var A=JSON.parse(v);if(A){for(f=0;f<A.length;f++)if(Array.isArray(A[f])){var L=A[f];if(!(2>L.length)){var Y=L[1];if(Array.isArray(Y)&&!(1>Y.length)){var ie=Y[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var Se=1;Se<Y.length;Se++)Y[Se]=""}}}}return gi(A)}catch{return v}}var B={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},U={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},z;function J(){}g(J,vi),J.prototype.g=function(){return new XMLHttpRequest},J.prototype.i=function(){return{}},z=new J;function se(f,v,A,L){this.j=f,this.i=v,this.l=A,this.R=L||1,this.U=new $t(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Z}function Z(){this.i=null,this.g="",this.h=!1}var ee={},te={};function ge(f,v,A){f.L=1,f.v=Tf(zi(v)),f.m=A,f.P=!0,ke(f,null)}function ke(f,v){f.F=Date.now(),Ie(f),f.A=zi(f.v);var A=f.A,L=f.R;Array.isArray(L)||(L=[String(L)]),p1(A.i,"t",L),f.C=0,A=f.j.J,f.h=new Z,f.g=F1(f.j,A?v:null,!f.m),0<f.O&&(f.M=new Et(d(f.Y,f,f.g),f.O)),v=f.U,A=f.g,L=f.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(At[0]=Y.toString()),Y=At);for(var ie=0;ie<Y.length;ie++){var Se=Ge(A,Y[ie],L||v.handleEvent,!1,v.h||v);if(!Se)break;v.g[Se.key]=Se}v=f.H?S(f.H):{},f.m?(f.u||(f.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,v)):(f.u="GET",f.g.ea(f.A,f.u,null,v)),ks(),Md(f.i,f.u,f.A,f.l,f.R,f.m)}se.prototype.ca=function(f){f=f.target;const v=this.M;v&&Wi(f)==3?v.j():this.Y(f)},se.prototype.Y=function(f){try{if(f==this.g)e:{const Mr=Wi(this.g);var v=this.g.Ba();const No=this.g.Z();if(!(3>Mr)&&(Mr!=3||this.g&&(this.h.h||this.g.oa()||w1(this.g)))){this.J||Mr!=4||v==7||(v==8||0>=No?ks(3):ks(2)),Tt(this);var A=this.g.Z();this.X=A;t:if(be(this)){var L=w1(this.g);f="";var Y=L.length,ie=Wi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ot(this),dt(this);var Se="";break t}this.h.i=new o.TextDecoder}for(v=0;v<Y;v++)this.h.h=!0,f+=this.h.i.decode(L[v],{stream:!(ie&&v==Y-1)});L.length=0,this.h.g+=f,this.C=0,Se=this.h.g}else Se=this.g.oa();if(this.o=A==200,jd(this.i,this.u,this.A,this.l,this.R,Mr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var kt,kr=this.g;if((kt=kr.g?kr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(kt)){var ut=kt;break t}}ut=null}if(A=ut)C(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ui(this,A);else{this.o=!1,this.s=3,Tr(12),Ot(this),dt(this);break e}}if(this.P){A=!0;let ti;for(;!this.J&&this.C<Se.length;)if(ti=_e(this,Se),ti==te){Mr==4&&(this.s=4,Tr(14),A=!1),C(this.i,this.l,null,"[Incomplete Response]");break}else if(ti==ee){this.s=4,Tr(15),C(this.i,this.l,Se,"[Invalid Chunk]"),A=!1;break}else C(this.i,this.l,ti,null),Ui(this,ti);if(be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mr!=4||Se.length!=0||this.h.h||(this.s=1,Tr(16),A=!1),this.o=this.o&&A,!A)C(this.i,this.l,Se,"[Invalid Chunked Response]"),Ot(this),dt(this);else if(0<Se.length&&!this.W){this.W=!0;var Lr=this.j;Lr.g==this&&Lr.ba&&!Lr.M&&(Lr.j.info("Great, no buffering proxy detected. Bytes received: "+Se.length),Wd(Lr),Lr.M=!0,Tr(11))}}else C(this.i,this.l,Se,null),Ui(this,Se);Mr==4&&Ot(this),this.o&&!this.J&&(Mr==4?b1(this.j,this):(this.o=!1,Ie(this)))}else vb(this.g),A==400&&0<Se.indexOf("Unknown SID")?(this.s=3,Tr(12)):(this.s=0,Tr(13)),Ot(this),dt(this)}}}catch{}finally{}};function be(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function _e(f,v){var A=f.C,L=v.indexOf(`
`,A);return L==-1?te:(A=Number(v.substring(A,L)),isNaN(A)?ee:(L+=1,L+A>v.length?te:(v=v.slice(L,L+A),f.C=L+A,v)))}se.prototype.cancel=function(){this.J=!0,Ot(this)};function Ie(f){f.S=Date.now()+f.I,ze(f,f.I)}function ze(f,v){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Vi(d(f.ba,f),v)}function Tt(f){f.B&&(o.clearTimeout(f.B),f.B=null)}se.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(V(this.i,this.A),this.L!=2&&(ks(),Tr(17)),Ot(this),this.s=2,dt(this)):ze(this,this.S-f)};function dt(f){f.j.G==0||f.J||b1(f.j,f)}function Ot(f){Tt(f);var v=f.M;v&&typeof v.ma=="function"&&v.ma(),f.M=null,tn(f.U),f.g&&(v=f.g,f.g=null,v.abort(),v.ma())}function Ui(f,v){try{var A=f.j;if(A.G!=0&&(A.g==f||An(A.h,f))){if(!f.K&&An(A.h,f)&&A.G==3){try{var L=A.Da.g.parse(v)}catch{L=null}if(Array.isArray(L)&&L.length==3){var Y=L;if(Y[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<f.F)Cf(A),If(A);else break e;zd(A),Tr(18)}}else A.za=Y[1],0<A.za-A.T&&37500>Y[2]&&A.F&&A.v==0&&!A.C&&(A.C=Vi(d(A.Za,A),6e3));if(1>=Io(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else bs(A,11)}else if((f.K||A.g==f)&&Cf(A),!T(v))for(Y=A.Da.g.parse(v),v=0;v<Y.length;v++){let ut=Y[v];if(A.T=ut[0],ut=ut[1],A.G==2)if(ut[0]=="c"){A.K=ut[1],A.ia=ut[2];const Lr=ut[3];Lr!=null&&(A.la=Lr,A.j.info("VER="+A.la));const Mr=ut[4];Mr!=null&&(A.Aa=Mr,A.j.info("SVER="+A.Aa));const No=ut[5];No!=null&&typeof No=="number"&&0<No&&(L=1.5*No,A.L=L,A.j.info("backChannelRequestTimeoutMs_="+L)),L=A;const ti=f.g;if(ti){const Rf=ti.g?ti.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rf){var ie=L.h;ie.g||Rf.indexOf("spdy")==-1&&Rf.indexOf("quic")==-1&&Rf.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(Bd(ie,ie.h),ie.h=null))}if(L.D){const Hd=ti.g?ti.g.getResponseHeader("X-HTTP-Session-Id"):null;Hd&&(L.ya=Hd,bt(L.I,L.D,Hd))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-f.F,A.j.info("Handshake RTT: "+A.R+"ms")),L=A;var Se=f;if(L.qa=R1(L,L.J?L.ia:null,L.W),Se.K){s1(L.h,Se);var kt=Se,kr=L.L;kr&&(kt.I=kr),kt.B&&(Tt(kt),Ie(kt)),L.g=Se}else A1(L);0<A.i.length&&bf(A)}else ut[0]!="stop"&&ut[0]!="close"||bs(A,7);else A.G==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?bs(A,7):Ud(A):ut[0]!="noop"&&A.l&&A.l.ta(ut),A.v=0)}}ks(4)}catch{}}var As=class{constructor(f,v){this.g=f,this.map=v}};function Ea(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xi(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Io(f){return f.h?1:f.g?f.g.size:0}function An(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function Bd(f,v){f.g?f.g.add(v):f.h=v}function s1(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}Ea.prototype.cancel=function(){if(this.i=o1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function o1(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const A of f.g.values())v=v.concat(A.D);return v}return m(f.i)}function rb(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var v=[],A=f.length,L=0;L<A;L++)v.push(f[L]);return v}v=[],A=0;for(L in f)v[A++]=f[L];return v}function nb(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var v=[];f=f.length;for(var A=0;A<f;A++)v.push(A);return v}v=[],A=0;for(const L in f)v[A++]=L;return v}}}function l1(f,v){if(f.forEach&&typeof f.forEach=="function")f.forEach(v,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,v,void 0);else for(var A=nb(f),L=rb(f),Y=L.length,ie=0;ie<Y;ie++)v.call(void 0,L[ie],A&&A[ie],f)}var c1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ib(f,v){if(f){f=f.split("&");for(var A=0;A<f.length;A++){var L=f[A].indexOf("="),Y=null;if(0<=L){var ie=f[A].substring(0,L);Y=f[A].substring(L+1)}else ie=f[A];v(ie,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Is(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Is){this.h=f.h,wf(this,f.j),this.o=f.o,this.g=f.g,Ef(this,f.s),this.l=f.l;var v=f.i,A=new Jl;A.i=v.i,v.g&&(A.g=new Map(v.g),A.h=v.h),u1(this,A),this.m=f.m}else f&&(v=String(f).match(c1))?(this.h=!1,wf(this,v[1]||"",!0),this.o=Yl(v[2]||""),this.g=Yl(v[3]||"",!0),Ef(this,v[4]),this.l=Yl(v[5]||"",!0),u1(this,v[6]||"",!0),this.m=Yl(v[7]||"")):(this.h=!1,this.i=new Jl(null,this.h))}Is.prototype.toString=function(){var f=[],v=this.j;v&&f.push(Ql(v,f1,!0),":");var A=this.g;return(A||v=="file")&&(f.push("//"),(v=this.o)&&f.push(Ql(v,f1,!0),"@"),f.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&f.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&f.push("/"),f.push(Ql(A,A.charAt(0)=="/"?ob:sb,!0))),(A=this.i.toString())&&f.push("?",A),(A=this.m)&&f.push("#",Ql(A,cb)),f.join("")};function zi(f){return new Is(f)}function wf(f,v,A){f.j=A?Yl(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function Ef(f,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);f.s=v}else f.s=null}function u1(f,v,A){v instanceof Jl?(f.i=v,ub(f.i,f.h)):(A||(v=Ql(v,lb)),f.i=new Jl(v,f.h))}function bt(f,v,A){f.i.set(v,A)}function Tf(f){return bt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Yl(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ql(f,v,A){return typeof f=="string"?(f=encodeURI(f).replace(v,ab),A&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function ab(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var f1=/[#\/\?@]/g,sb=/[#\?:]/g,ob=/[#\?]/g,lb=/[#\?@]/g,cb=/#/g;function Jl(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Ta(f){f.g||(f.g=new Map,f.h=0,f.i&&ib(f.i,function(v,A){f.add(decodeURIComponent(v.replace(/\+/g," ")),A)}))}t=Jl.prototype,t.add=function(f,v){Ta(this),this.i=null,f=bo(this,f);var A=this.g.get(f);return A||this.g.set(f,A=[]),A.push(v),this.h+=1,this};function h1(f,v){Ta(f),v=bo(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function d1(f,v){return Ta(f),v=bo(f,v),f.g.has(v)}t.forEach=function(f,v){Ta(this),this.g.forEach(function(A,L){A.forEach(function(Y){f.call(v,Y,L,this)},this)},this)},t.na=function(){Ta(this);const f=Array.from(this.g.values()),v=Array.from(this.g.keys()),A=[];for(let L=0;L<v.length;L++){const Y=f[L];for(let ie=0;ie<Y.length;ie++)A.push(v[L])}return A},t.V=function(f){Ta(this);let v=[];if(typeof f=="string")d1(this,f)&&(v=v.concat(this.g.get(bo(this,f))));else{f=Array.from(this.g.values());for(let A=0;A<f.length;A++)v=v.concat(f[A])}return v},t.set=function(f,v){return Ta(this),this.i=null,f=bo(this,f),d1(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},t.get=function(f,v){return f?(f=this.V(f),0<f.length?String(f[0]):v):v};function p1(f,v,A){h1(f,v),0<A.length&&(f.i=null,f.g.set(bo(f,v),m(A)),f.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(var A=0;A<v.length;A++){var L=v[A];const ie=encodeURIComponent(String(L)),Se=this.V(L);for(L=0;L<Se.length;L++){var Y=ie;Se[L]!==""&&(Y+="="+encodeURIComponent(String(Se[L]))),f.push(Y)}}return this.i=f.join("&")};function bo(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function ub(f,v){v&&!f.j&&(Ta(f),f.i=null,f.g.forEach(function(A,L){var Y=L.toLowerCase();L!=Y&&(h1(this,L),p1(this,Y,A))},f)),f.j=v}function fb(f,v){const A=new Ss;if(o.Image){const L=new Image;L.onload=p(ka,A,"TestLoadImage: loaded",!0,v,L),L.onerror=p(ka,A,"TestLoadImage: error",!1,v,L),L.onabort=p(ka,A,"TestLoadImage: abort",!1,v,L),L.ontimeout=p(ka,A,"TestLoadImage: timeout",!1,v,L),o.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=f}else v(!1)}function hb(f,v){const A=new Ss,L=new AbortController,Y=setTimeout(()=>{L.abort(),ka(A,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:L.signal}).then(ie=>{clearTimeout(Y),ie.ok?ka(A,"TestPingServer: ok",!0,v):ka(A,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Y),ka(A,"TestPingServer: error",!1,v)})}function ka(f,v,A,L,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),L(A)}catch{}}function db(){this.g=new ws}function pb(f,v,A){const L=A||"";try{l1(f,function(Y,ie){let Se=Y;c(Y)&&(Se=gi(Y)),v.push(L+ie+"="+encodeURIComponent(Se))})}catch(Y){throw v.push(L+"type="+encodeURIComponent("_badmap")),Y}}function kf(f){this.l=f.Ub||null,this.j=f.eb||!1}g(kf,vi),kf.prototype.g=function(){return new Sf(this.l,this.j)},kf.prototype.i=function(f){return function(){return f}}({});function Sf(f,v){Ue.call(this),this.D=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Sf,Ue),t=Sf.prototype,t.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=v,this.readyState=1,ec(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(v.body=f),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zl(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,ec(this)),this.g&&(this.readyState=3,ec(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;m1(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function m1(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?Zl(this):ec(this),this.readyState==3&&m1(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Zl(this))},t.Qa=function(f){this.g&&(this.response=f,Zl(this))},t.ga=function(){this.g&&Zl(this)};function Zl(f){f.readyState=4,f.l=null,f.j=null,f.v=null,ec(f)}t.setRequestHeader=function(f,v){this.u.append(f,v)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var A=v.next();!A.done;)A=A.value,f.push(A[0]+": "+A[1]),A=v.next();return f.join(`\r
`)};function ec(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Sf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function g1(f){let v="";return D(f,function(A,L){v+=L,v+=":",v+=A,v+=`\r
`}),v}function Vd(f,v,A){e:{for(L in A){var L=!1;break e}L=!0}L||(A=g1(A),typeof f=="string"?A!=null&&encodeURIComponent(String(A)):bt(f,v,A))}function Gt(f){Ue.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Gt,Ue);var mb=/^https?$/i,gb=["POST","PUT"];t=Gt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,v,A,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():z.g(),this.v=this.o?Es(this.o):Es(z),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(ie){v1(this,ie);return}if(f=A||"",A=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var Y in L)A.set(Y,L[Y]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const ie of L.keys())A.set(ie,L.get(ie));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(A.keys()).find(ie=>ie.toLowerCase()=="content-type"),Y=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(gb,v,void 0))||L||Y||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,Se]of A)this.g.setRequestHeader(ie,Se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{y1(this),this.u=!0,this.g.send(f),this.u=!1}catch(ie){v1(this,ie)}};function v1(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.m=5,x1(f),Af(f)}function x1(f){f.A||(f.A=!0,Ye(f,"complete"),Ye(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ye(this,"complete"),Ye(this,"abort"),Af(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Af(this,!0)),Gt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?_1(this):this.bb())},t.bb=function(){_1(this)};function _1(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Wi(f)!=4||f.Z()!=2)){if(f.u&&Wi(f)==4)fr(f.Ea,0,f);else if(Ye(f,"readystatechange"),Wi(f)==4){f.h=!1;try{const Se=f.Z();e:switch(Se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var A;if(!(A=v)){var L;if(L=Se===0){var Y=String(f.D).match(c1)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),L=!mb.test(Y?Y.toLowerCase():"")}A=L}if(A)Ye(f,"complete"),Ye(f,"success");else{f.m=6;try{var ie=2<Wi(f)?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.Z()+"]",x1(f)}}finally{Af(f)}}}}function Af(f,v){if(f.g){y1(f);const A=f.g,L=f.v[0]?()=>{}:null;f.g=null,f.v=null,v||Ye(f,"ready");try{A.onreadystatechange=L}catch{}}}function y1(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Wi(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Wi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),ys(v)}};function w1(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function vb(f){const v={};f=(f.g&&2<=Wi(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<f.length;L++){if(T(f[L]))continue;var A=b(f[L]);const Y=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const ie=v[Y]||[];v[Y]=ie,ie.push(A)}E(v,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function tc(f,v,A){return A&&A.internalChannelParams&&A.internalChannelParams[f]||v}function E1(f){this.Aa=0,this.i=[],this.j=new Ss,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=tc("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=tc("baseRetryDelayMs",5e3,f),this.cb=tc("retryDelaySeedMs",1e4,f),this.Wa=tc("forwardChannelMaxRetries",2,f),this.wa=tc("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Ea(f&&f.concurrentRequestLimit),this.Da=new db,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=E1.prototype,t.la=8,t.G=1,t.connect=function(f,v,A,L){Tr(0),this.W=f,this.H=v||{},A&&L!==void 0&&(this.H.OSID=A,this.H.OAID=L),this.F=this.X,this.I=R1(this,null,this.W),bf(this)};function Ud(f){if(T1(f),f.G==3){var v=f.U++,A=zi(f.I);if(bt(A,"SID",f.K),bt(A,"RID",v),bt(A,"TYPE","terminate"),rc(f,A),v=new se(f,f.j,v),v.L=2,v.v=Tf(zi(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=v.v,A=!0),A||(v.g=F1(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Ie(v)}N1(f)}function If(f){f.g&&(Wd(f),f.g.cancel(),f.g=null)}function T1(f){If(f),f.u&&(o.clearTimeout(f.u),f.u=null),Cf(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function bf(f){if(!xi(f.h)&&!f.s){f.s=!0;var v=f.Ga;ve||Q(),le||(ve(),le=!0),P.add(v,f),f.B=0}}function xb(f,v){return Io(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=v.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Vi(d(f.Ga,f,v),C1(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const Y=new se(this,this.j,f);let ie=this.o;if(this.S&&(ie?(ie=S(ie),I(ie,this.S)):ie=this.S),this.m!==null||this.O||(Y.H=ie,ie=null),this.P)e:{for(var v=0,A=0;A<this.i.length;A++){t:{var L=this.i[A];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(v+=L,4096<v){v=A;break e}if(v===4096||A===this.i.length-1){v=A+1;break e}}v=1e3}else v=1e3;v=S1(this,Y,v),A=zi(this.I),bt(A,"RID",f),bt(A,"CVER",22),this.D&&bt(A,"X-HTTP-Session-Id",this.D),rc(this,A),ie&&(this.O?v="headers="+encodeURIComponent(String(g1(ie)))+"&"+v:this.m&&Vd(A,this.m,ie)),Bd(this.h,Y),this.Ua&&bt(A,"TYPE","init"),this.P?(bt(A,"$req",v),bt(A,"SID","null"),Y.T=!0,ge(Y,A,null)):ge(Y,A,v),this.G=2}}else this.G==3&&(f?k1(this,f):this.i.length==0||xi(this.h)||k1(this))};function k1(f,v){var A;v?A=v.l:A=f.U++;const L=zi(f.I);bt(L,"SID",f.K),bt(L,"RID",A),bt(L,"AID",f.T),rc(f,L),f.m&&f.o&&Vd(L,f.m,f.o),A=new se(f,f.j,A,f.B+1),f.m===null&&(A.H=f.o),v&&(f.i=v.D.concat(f.i)),v=S1(f,A,1e3),A.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Bd(f.h,A),ge(A,L,v)}function rc(f,v){f.H&&D(f.H,function(A,L){bt(v,L,A)}),f.l&&l1({},function(A,L){bt(v,L,A)})}function S1(f,v,A){A=Math.min(f.i.length,A);var L=f.l?d(f.l.Na,f.l,f):null;e:{var Y=f.i;let ie=-1;for(;;){const Se=["count="+A];ie==-1?0<A?(ie=Y[0].g,Se.push("ofs="+ie)):ie=0:Se.push("ofs="+ie);let kt=!0;for(let kr=0;kr<A;kr++){let ut=Y[kr].g;const Lr=Y[kr].map;if(ut-=ie,0>ut)ie=Math.max(0,Y[kr].g-100),kt=!1;else try{pb(Lr,Se,"req"+ut+"_")}catch{L&&L(Lr)}}if(kt){L=Se.join("&");break e}}}return f=f.i.splice(0,A),v.D=f,L}function A1(f){if(!f.g&&!f.u){f.Y=1;var v=f.Fa;ve||Q(),le||(ve(),le=!0),P.add(v,f),f.v=0}}function zd(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Vi(d(f.Fa,f),C1(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,I1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Vi(d(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tr(10),If(this),I1(this))};function Wd(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function I1(f){f.g=new se(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var v=zi(f.qa);bt(v,"RID","rpc"),bt(v,"SID",f.K),bt(v,"AID",f.T),bt(v,"CI",f.F?"0":"1"),!f.F&&f.ja&&bt(v,"TO",f.ja),bt(v,"TYPE","xmlhttp"),rc(f,v),f.m&&f.o&&Vd(v,f.m,f.o),f.L&&(f.g.I=f.L);var A=f.g;f=f.ia,A.L=1,A.v=Tf(zi(v)),A.m=null,A.P=!0,ke(A,f)}t.Za=function(){this.C!=null&&(this.C=null,If(this),zd(this),Tr(19))};function Cf(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function b1(f,v){var A=null;if(f.g==v){Cf(f),Wd(f),f.g=null;var L=2}else if(An(f.h,v))A=v.D,s1(f.h,v),L=1;else return;if(f.G!=0){if(v.o)if(L==1){A=v.m?v.m.length:0,v=Date.now()-v.F;var Y=f.B;L=Ao(),Ye(L,new yf(L,A)),bf(f)}else A1(f);else if(Y=v.s,Y==3||Y==0&&0<v.X||!(L==1&&xb(f,v)||L==2&&zd(f)))switch(A&&0<A.length&&(v=f.h,v.i=v.i.concat(A)),Y){case 1:bs(f,5);break;case 4:bs(f,10);break;case 3:bs(f,6);break;default:bs(f,2)}}}function C1(f,v){let A=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(A*=2),A*v}function bs(f,v){if(f.j.info("Error code "+v),v==2){var A=d(f.fb,f),L=f.Xa;const Y=!L;L=new Is(L||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||wf(L,"https"),Tf(L),Y?fb(L.toString(),A):hb(L.toString(),A)}else Tr(2);f.G=0,f.l&&f.l.sa(v),N1(f),T1(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Tr(2)):(this.j.info("Failed to ping google.com"),Tr(1))};function N1(f){if(f.G=0,f.ka=[],f.l){const v=o1(f.h);(v.length!=0||f.i.length!=0)&&(_(f.ka,v),_(f.ka,f.i),f.h.i.length=0,m(f.i),f.i.length=0),f.l.ra()}}function R1(f,v,A){var L=A instanceof Is?zi(A):new Is(A);if(L.g!="")v&&(L.g=v+"."+L.g),Ef(L,L.s);else{var Y=o.location;L=Y.protocol,v=v?v+"."+Y.hostname:Y.hostname,Y=+Y.port;var ie=new Is(null);L&&wf(ie,L),v&&(ie.g=v),Y&&Ef(ie,Y),A&&(ie.l=A),L=ie}return A=f.D,v=f.ya,A&&v&&bt(L,A,v),bt(L,"VER",f.la),rc(f,L),L}function F1(f,v,A){if(v&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Ca&&!f.pa?new Gt(new kf({eb:A})):new Gt(f.pa),v.Ha(f.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function P1(){}t=P1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Nf(){}Nf.prototype.g=function(f,v){return new In(f,v)};function In(f,v){Ue.call(this),this.g=new E1(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(f?f["X-WebChannel-Client-Profile"]=v.va:f={"X-WebChannel-Client-Profile":v.va}),this.g.S=f,(f=v&&v.Sb)&&!T(f)&&(this.g.m=f),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!T(v)&&(this.g.D=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new Co(this)}g(In,Ue),In.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){Ud(this.g)},In.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var A={};A.__data__=f,f=A}else this.u&&(A={},A.__data__=gi(f),f=A);v.i.push(new As(v.Ya++,f)),v.G==3&&bf(v)},In.prototype.N=function(){this.g.l=null,delete this.j,Ud(this.g),delete this.g,In.aa.N.call(this)};function D1(f){Xl.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const A in v){f=A;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}g(D1,Xl);function O1(){wa.call(this),this.status=1}g(O1,wa);function Co(f){this.g=f}g(Co,P1),Co.prototype.ua=function(){Ye(this.g,"a")},Co.prototype.ta=function(f){Ye(this.g,new D1(f))},Co.prototype.sa=function(f){Ye(this.g,new O1)},Co.prototype.ra=function(){Ye(this.g,"b")},Nf.prototype.createWebChannel=Nf.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,WA=function(){return new Nf},zA=function(){return Ao()},UA=Bi,og={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},B.NO_ERROR=0,B.TIMEOUT=8,B.HTTP_ERROR=6,S0=B,U.COMPLETE="complete",VA=U,Kl.EventType=Ts,Ts.OPEN="a",Ts.CLOSE="b",Ts.ERROR="c",Ts.MESSAGE="d",Ue.prototype.listen=Ue.prototype.K,Tc=Kl,Gt.prototype.listenOnce=Gt.prototype.L,Gt.prototype.getLastError=Gt.prototype.Ka,Gt.prototype.getLastErrorCode=Gt.prototype.Ba,Gt.prototype.getStatus=Gt.prototype.Z,Gt.prototype.getResponseJson=Gt.prototype.Oa,Gt.prototype.getResponseText=Gt.prototype.oa,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Ha,BA=Gt}).apply(typeof o0<"u"?o0:typeof self<"u"?self:typeof window<"u"?window:{});const Sw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wr.UNAUTHENTICATED=new Wr(null),Wr.GOOGLE_CREDENTIALS=new Wr("google-credentials-uid"),Wr.FIRST_PARTY=new Wr("first-party-uid"),Wr.MOCK_USER=new Wr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao=new mx("@firebase/firestore");function hc(){return ao.logLevel}function Re(t,...e){if(ao.logLevel<=rt.DEBUG){const r=e.map(xx);ao.debug(`Firestore (${Wl}): ${t}`,...r)}}function fa(t,...e){if(ao.logLevel<=rt.ERROR){const r=e.map(xx);ao.error(`Firestore (${Wl}): ${t}`,...r)}}function bl(t,...e){if(ao.logLevel<=rt.WARN){const r=e.map(xx);ao.warn(`Firestore (${Wl}): ${t}`,...r)}}function xx(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(t="Unexpected state"){const e=`FIRESTORE (${Wl}) INTERNAL ASSERTION FAILED: `+t;throw fa(e),new Error(e)}function xt(t,e){t||We()}function $e(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends xa{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $B{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Wr.UNAUTHENTICATED))}shutdown(){}}class GB{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class qB{constructor(e){this.t=e,this.currentUser=Wr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){xt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new na;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new na,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const l=a;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new na)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(xt(typeof n.accessToken=="string"),new HA(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xt(e===null||typeof e=="string"),new Wr(e)}}class KB{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Wr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class XB{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new KB(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Wr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class YB{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class QB{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){xt(this.o===void 0);const n=a=>{a.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.R;return this.R=a.token,Re("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?i(a):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(xt(typeof r.token=="string"),this.R=r.token,new YB(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=JB(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%e.length))}return n}}function ht(t,e){return t<e?-1:t>e?1:0}function Cl(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return mr.fromMillis(Date.now())}static fromDate(e){return mr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new mr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ht(this.nanoseconds,e.nanoseconds):ht(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.timestamp=e}static fromTimestamp(e){return new He(e)}static min(){return new He(new mr(0,0))}static max(){return new He(new mr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,r,n){r===void 0?r=0:r>e.length&&We(),n===void 0?n=e.length-r:n>e.length-r&&We(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Fu.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Fu?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=e.get(i),s=r.get(i);if(a<s)return-1;if(a>s)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Rt extends Fu{construct(e,r,n){return new Rt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ce(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Rt(r)}static emptyPath(){return new Rt([])}}const ZB=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rr extends Fu{construct(e,r,n){return new Rr(e,r,n)}static isValidIdentifier(e){return ZB.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Rr(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Ce(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new Ce(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ce(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(s=!s,i++):o!=="."||s?(n+=o,i++):(a(),i++)}if(a(),s)throw new Ce(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Rr(r)}static emptyPath(){return new Rr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.path=e}static fromPath(e){return new Oe(Rt.fromString(e))}static fromName(e){return new Oe(Rt.fromString(e).popFirst(5))}static empty(){return new Oe(Rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Rt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oe(new Rt(e.slice()))}}function eV(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=He.fromTimestamp(n===1e9?new mr(r+1,0):new mr(r,n));return new us(i,Oe.empty(),e)}function tV(t){return new us(t.readTime,t.key,-1)}class us{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new us(He.min(),Oe.empty(),-1)}static max(){return new us(He.max(),Oe.empty(),-1)}}function rV(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Oe.comparator(t.documentKey,e.documentKey),r!==0?r:ht(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rf(t){if(t.code!==fe.FAILED_PRECONDITION||t.message!==nV)throw t;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&We(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new me((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof me?r:me.resolve(r)}catch(r){return me.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):me.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):me.reject(r)}static resolve(e){return new me((r,n)=>{r(e)})}static reject(e){return new me((r,n)=>{n(e)})}static waitFor(e){return new me((r,n)=>{let i=0,a=0,s=!1;e.forEach(o=>{++i,o.next(()=>{++a,s&&a===i&&r()},l=>n(l))}),s=!0,a===i&&r()})}static or(e){let r=me.resolve(!1);for(const n of e)r=r.next(i=>i?me.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new me((n,i)=>{const a=e.length,s=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(e[c]).next(u=>{s[c]=u,++o,o===a&&n(s)},u=>i(u))}})}static doWhile(e,r){return new me((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function aV(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function nf(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}_x.oe=-1;function pd(t){return t==null}function Sh(t){return t===0&&1/t==-1/0}function sV(t){return typeof t=="number"&&Number.isInteger(t)&&!Sh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function yo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function GA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,r){this.comparator=e,this.root=r||br.EMPTY}insert(e,r){return new Ht(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,br.BLACK,null,null))}remove(e){return new Ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,br.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new l0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new l0(this.root,e,this.comparator,!1)}getReverseIterator(){return new l0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new l0(this.root,e,this.comparator,!0)}}class l0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class br{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??br.RED,this.left=i??br.EMPTY,this.right=a??br.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new br(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return br.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return br.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,br.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,br.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw We();const e=this.left.check();if(e!==this.right.check())throw We();return e+(this.isRed()?0:1)}}br.EMPTY=null,br.RED=!0,br.BLACK=!1;br.EMPTY=new class{constructor(){this.size=0}get key(){throw We()}get value(){throw We()}get color(){throw We()}get left(){throw We()}get right(){throw We()}copy(e,r,n,i,a){return this}insert(e,r,n){return new br(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.comparator=e,this.data=new Ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Iw(this.data.getIterator())}getIteratorFrom(e){return new Iw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Pr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Pr(this.comparator);return r.data=e,r}}class Iw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.fields=e,e.sort(Rr.comparator)}static empty(){return new Dn([])}unionWith(e){let r=new Pr(Rr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Dn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Cl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new qA("Invalid base64 string: "+a):a}}(e);return new Or(r)}static fromUint8Array(e){const r=function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a}(e);return new Or(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ht(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Or.EMPTY_BYTE_STRING=new Or("");const oV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fs(t){if(xt(!!t),typeof t=="string"){let e=0;const r=oV.exec(t);if(xt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Jt(t.seconds),nanos:Jt(t.nanos)}}function Jt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function so(t){return typeof t=="string"?Or.fromBase64String(t):Or.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function wx(t){const e=t.mapValue.fields.__previous_value__;return yx(e)?wx(e):e}function Pu(t){const e=fs(t.mapValue.fields.__local_write_time__.timestampValue);return new mr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,r,n,i,a,s,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Du{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Du("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Du&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yx(t)?4:uV(t)?9007199254740991:cV(t)?10:11:We()}function Di(t,e){if(t===e)return!0;const r=oo(t);if(r!==oo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Pu(t).isEqual(Pu(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=fs(i.timestampValue),o=fs(a.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return so(i.bytesValue).isEqual(so(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return Jt(i.geoPointValue.latitude)===Jt(a.geoPointValue.latitude)&&Jt(i.geoPointValue.longitude)===Jt(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return Jt(i.integerValue)===Jt(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=Jt(i.doubleValue),o=Jt(a.doubleValue);return s===o?Sh(s)===Sh(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Cl(t.arrayValue.values||[],e.arrayValue.values||[],Di);case 10:case 11:return function(i,a){const s=i.mapValue.fields||{},o=a.mapValue.fields||{};if(Aw(s)!==Aw(o))return!1;for(const l in s)if(s.hasOwnProperty(l)&&(o[l]===void 0||!Di(s[l],o[l])))return!1;return!0}(t,e);default:return We()}}function Ou(t,e){return(t.values||[]).find(r=>Di(r,e))!==void 0}function Nl(t,e){if(t===e)return 0;const r=oo(t),n=oo(e);if(r!==n)return ht(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ht(t.booleanValue,e.booleanValue);case 2:return function(a,s){const o=Jt(a.integerValue||a.doubleValue),l=Jt(s.integerValue||s.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return bw(t.timestampValue,e.timestampValue);case 4:return bw(Pu(t),Pu(e));case 5:return ht(t.stringValue,e.stringValue);case 6:return function(a,s){const o=so(a),l=so(s);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const o=a.split("/"),l=s.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=ht(o[c],l[c]);if(u!==0)return u}return ht(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const o=ht(Jt(a.latitude),Jt(s.latitude));return o!==0?o:ht(Jt(a.longitude),Jt(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Cw(t.arrayValue,e.arrayValue);case 10:return function(a,s){var o,l,c,u;const h=a.fields||{},d=s.fields||{},p=(o=h.value)===null||o===void 0?void 0:o.arrayValue,g=(l=d.value)===null||l===void 0?void 0:l.arrayValue,m=ht(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return m!==0?m:Cw(p,g)}(t.mapValue,e.mapValue);case 11:return function(a,s){if(a===c0.mapValue&&s===c0.mapValue)return 0;if(a===c0.mapValue)return 1;if(s===c0.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=s.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const d=ht(l[h],u[h]);if(d!==0)return d;const p=Nl(o[l[h]],c[u[h]]);if(p!==0)return p}return ht(l.length,u.length)}(t.mapValue,e.mapValue);default:throw We()}}function bw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ht(t,e);const r=fs(t),n=fs(e),i=ht(r.seconds,n.seconds);return i!==0?i:ht(r.nanos,n.nanos)}function Cw(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=Nl(r[i],n[i]);if(a)return a}return ht(r.length,n.length)}function Rl(t){return lg(t)}function lg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=fs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return so(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Oe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=lg(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const s of n)a?a=!1:i+=",",i+=`${s}:${lg(r.fields[s])}`;return i+"}"}(t.mapValue):We()}function Nw(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function cg(t){return!!t&&"integerValue"in t}function Ex(t){return!!t&&"arrayValue"in t}function Rw(t){return!!t&&"nullValue"in t}function Fw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function A0(t){return!!t&&"mapValue"in t}function cV(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function $c(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return yo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=$c(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=$c(t.arrayValue.values[r]);return e}return Object.assign({},t)}function uV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.value=e}static empty(){return new gn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!A0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=$c(r)}setAll(e){let r=Rr.emptyPath(),n={},i=[];e.forEach((s,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}s?n[o.lastSegment()]=$c(s):i.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());A0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Di(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];A0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){yo(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new gn($c(this.value))}}function KA(t){const e=[];return yo(t.fields,(r,n)=>{const i=new Rr([r]);if(A0(n)){const a=KA(n.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)}),new Dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,r,n,i,a,s,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Kr(e,0,He.min(),He.min(),He.min(),gn.empty(),0)}static newFoundDocument(e,r,n,i){return new Kr(e,1,r,He.min(),n,i,0)}static newNoDocument(e,r){return new Kr(e,2,r,He.min(),He.min(),gn.empty(),0)}static newUnknownDocument(e,r){return new Kr(e,3,r,He.min(),He.min(),gn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(He.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=He.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,r){this.position=e,this.inclusive=r}}function Pw(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],s=t.position[i];if(a.field.isKeyField()?n=Oe.comparator(Oe.fromName(s.referenceValue),r.key):n=Nl(s,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function Dw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Di(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,r="asc"){this.field=e,this.dir=r}}function fV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{}class cr extends XA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new dV(e,r,n):r==="array-contains"?new gV(e,n):r==="in"?new vV(e,n):r==="not-in"?new xV(e,n):r==="array-contains-any"?new _V(e,n):new cr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new pV(e,n):new mV(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Nl(r,this.value)):r!==null&&oo(this.value)===oo(r)&&this.matchesComparison(Nl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return We()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pi extends XA{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new pi(e,r)}matches(e){return YA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function YA(t){return t.op==="and"}function QA(t){return hV(t)&&YA(t)}function hV(t){for(const e of t.filters)if(e instanceof pi)return!1;return!0}function ug(t){if(t instanceof cr)return t.field.canonicalString()+t.op.toString()+Rl(t.value);if(QA(t))return t.filters.map(e=>ug(e)).join(",");{const e=t.filters.map(r=>ug(r)).join(",");return`${t.op}(${e})`}}function JA(t,e){return t instanceof cr?function(n,i){return i instanceof cr&&n.op===i.op&&n.field.isEqual(i.field)&&Di(n.value,i.value)}(t,e):t instanceof pi?function(n,i){return i instanceof pi&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,s,o)=>a&&JA(s,i.filters[o]),!0):!1}(t,e):void We()}function ZA(t){return t instanceof cr?function(r){return`${r.field.canonicalString()} ${r.op} ${Rl(r.value)}`}(t):t instanceof pi?function(r){return r.op.toString()+" {"+r.getFilters().map(ZA).join(" ,")+"}"}(t):"Filter"}class dV extends cr{constructor(e,r,n){super(e,r,n),this.key=Oe.fromName(n.referenceValue)}matches(e){const r=Oe.comparator(e.key,this.key);return this.matchesComparison(r)}}class pV extends cr{constructor(e,r){super(e,"in",r),this.keys=e4("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class mV extends cr{constructor(e,r){super(e,"not-in",r),this.keys=e4("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function e4(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Oe.fromName(n.referenceValue))}class gV extends cr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Ex(r)&&Ou(r.arrayValue,this.value)}}class vV extends cr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Ou(this.value.arrayValue,r)}}class xV extends cr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Ou(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Ou(this.value.arrayValue,r)}}class _V extends cr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Ex(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Ou(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e,r=null,n=[],i=[],a=null,s=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=s,this.endAt=o,this.ue=null}}function Ow(t,e=null,r=[],n=[],i=null,a=null,s=null){return new yV(t,e,r,n,i,a,s)}function Tx(t){const e=$e(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>ug(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),pd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Rl(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Rl(n)).join(",")),e.ue=r}return e.ue}function kx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!fV(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!JA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Dw(t.startAt,e.startAt)&&Dw(t.endAt,e.endAt)}function fg(t){return Oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,r=null,n=[],i=[],a=null,s="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=s,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function wV(t,e,r,n,i,a,s,o){return new Hl(t,e,r,n,i,a,s,o)}function Sx(t){return new Hl(t)}function Lw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function t4(t){return t.collectionGroup!==null}function Gc(t){const e=$e(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let o=new Pr(Rr.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new Lu(a,n))}),r.has(Rr.keyField().canonicalString())||e.ce.push(new Lu(Rr.keyField(),n))}return e.ce}function Ni(t){const e=$e(t);return e.le||(e.le=EV(e,Gc(t))),e.le}function EV(t,e){if(t.limitType==="F")return Ow(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new Lu(i.field,a)});const r=t.endAt?new Ah(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ah(t.startAt.position,t.startAt.inclusive):null;return Ow(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function hg(t,e){const r=t.filters.concat([e]);return new Hl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function dg(t,e,r){return new Hl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function md(t,e){return kx(Ni(t),Ni(e))&&t.limitType===e.limitType}function r4(t){return`${Tx(Ni(t))}|lt:${t.limitType}`}function Lo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>ZA(i)).join(", ")}]`),pd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Rl(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Rl(i)).join(",")),`Target(${n})`}(Ni(t))}; limitType=${t.limitType})`}function gd(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Oe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of Gc(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,o,l){const c=Pw(s,o,l);return s.inclusive?c<=0:c<0}(n.startAt,Gc(n),i)||n.endAt&&!function(s,o,l){const c=Pw(s,o,l);return s.inclusive?c>=0:c>0}(n.endAt,Gc(n),i))}(t,e)}function TV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function n4(t){return(e,r)=>{let n=!1;for(const i of Gc(t)){const a=kV(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function kV(t,e,r){const n=t.field.isKeyField()?Oe.comparator(e.key,r.key):function(a,s,o){const l=s.data.field(a),c=o.data.field(a);return l!==null&&c!==null?Nl(l,c):We()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return We()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){yo(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return GA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV=new Ht(Oe.comparator);function ha(){return SV}const i4=new Ht(Oe.comparator);function kc(...t){let e=i4;for(const r of t)e=e.insert(r.key,r);return e}function a4(t){let e=i4;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Bs(){return qc()}function s4(){return qc()}function qc(){return new $l(t=>t.toString(),(t,e)=>t.isEqual(e))}const AV=new Ht(Oe.comparator),IV=new Pr(Oe.comparator);function tt(...t){let e=IV;for(const r of t)e=e.add(r);return e}const bV=new Pr(ht);function CV(){return bV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sh(e)?"-0":e}}function o4(t){return{integerValue:""+t}}function NV(t,e){return sV(e)?o4(e):Ax(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(){this._=void 0}}function RV(t,e,r){return t instanceof Ih?function(i,a){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&yx(a)&&(a=wx(a)),a&&(s.fields.__previous_value__=a),{mapValue:s}}(r,e):t instanceof Mu?c4(t,e):t instanceof ju?u4(t,e):function(i,a){const s=l4(i,a),o=Mw(s)+Mw(i.Pe);return cg(s)&&cg(i.Pe)?o4(o):Ax(i.serializer,o)}(t,e)}function FV(t,e,r){return t instanceof Mu?c4(t,e):t instanceof ju?u4(t,e):r}function l4(t,e){return t instanceof bh?function(n){return cg(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Ih extends vd{}class Mu extends vd{constructor(e){super(),this.elements=e}}function c4(t,e){const r=f4(e);for(const n of t.elements)r.some(i=>Di(i,n))||r.push(n);return{arrayValue:{values:r}}}class ju extends vd{constructor(e){super(),this.elements=e}}function u4(t,e){let r=f4(e);for(const n of t.elements)r=r.filter(i=>!Di(i,n));return{arrayValue:{values:r}}}class bh extends vd{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function Mw(t){return Jt(t.integerValue||t.doubleValue)}function f4(t){return Ex(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function PV(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Mu&&i instanceof Mu||n instanceof ju&&i instanceof ju?Cl(n.elements,i.elements,Di):n instanceof bh&&i instanceof bh?Di(n.Pe,i.Pe):n instanceof Ih&&i instanceof Ih}(t.transform,e.transform)}class DV{constructor(e,r){this.version=e,this.transformResults=r}}class En{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new En}static exists(e){return new En(void 0,e)}static updateTime(e){return new En(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function I0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class xd{}function h4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _d(t.key,En.none()):new af(t.key,t.data,En.none());{const r=t.data,n=gn.empty();let i=new Pr(Rr.comparator);for(let a of e.fields)if(!i.has(a)){let s=r.field(a);s===null&&a.length>1&&(a=a.popLast(),s=r.field(a)),s===null?n.delete(a):n.set(a,s),i=i.add(a)}return new _s(t.key,n,new Dn(i.toArray()),En.none())}}function OV(t,e,r){t instanceof af?function(i,a,s){const o=i.value.clone(),l=Bw(i.fieldTransforms,a,s.transformResults);o.setAll(l),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,r):t instanceof _s?function(i,a,s){if(!I0(i.precondition,a))return void a.convertToUnknownDocument(s.version);const o=Bw(i.fieldTransforms,a,s.transformResults),l=a.data;l.setAll(d4(i)),l.setAll(o),a.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function Kc(t,e,r,n){return t instanceof af?function(a,s,o,l){if(!I0(a.precondition,s))return o;const c=a.value.clone(),u=Vw(a.fieldTransforms,l,s);return c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof _s?function(a,s,o,l){if(!I0(a.precondition,s))return o;const c=Vw(a.fieldTransforms,l,s),u=s.data;return u.setAll(d4(a)),u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,s,o){return I0(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,r)}function LV(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=l4(n.transform,i||null);a!=null&&(r===null&&(r=gn.empty()),r.set(n.field,a))}return r||null}function jw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Cl(n,i,(a,s)=>PV(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class af extends xd{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class _s extends xd{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function d4(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Bw(t,e,r){const n=new Map;xt(t.length===r.length);for(let i=0;i<r.length;i++){const a=t[i],s=a.transform,o=e.data.field(a.field);n.set(a.field,FV(s,o,r[i]))}return n}function Vw(t,e,r){const n=new Map;for(const i of t){const a=i.transform,s=r.data.field(i.field);n.set(i.field,RV(a,s,e))}return n}class _d extends xd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class MV extends xd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&OV(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Kc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Kc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=s4();return this.mutations.forEach(i=>{const a=e.get(i.key),s=a.overlayedDocument;let o=this.applyToLocalView(s,a.mutatedFields);o=r.has(i.key)?null:o;const l=h4(s,o);l!==null&&n.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(He.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),tt())}isEqual(e){return this.batchId===e.batchId&&Cl(this.mutations,e.mutations,(r,n)=>jw(r,n))&&Cl(this.baseMutations,e.baseMutations,(r,n)=>jw(r,n))}}class Ix{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){xt(e.mutations.length===n.length);let i=function(){return AV}();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,n[s].version);return new Ix(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ar,at;function UV(t){switch(t){default:return We();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}function p4(t){if(t===void 0)return fa("GRPC error has no .code"),fe.UNKNOWN;switch(t){case ar.OK:return fe.OK;case ar.CANCELLED:return fe.CANCELLED;case ar.UNKNOWN:return fe.UNKNOWN;case ar.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case ar.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case ar.INTERNAL:return fe.INTERNAL;case ar.UNAVAILABLE:return fe.UNAVAILABLE;case ar.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case ar.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case ar.NOT_FOUND:return fe.NOT_FOUND;case ar.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case ar.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case ar.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case ar.ABORTED:return fe.ABORTED;case ar.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case ar.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case ar.DATA_LOSS:return fe.DATA_LOSS;default:return We()}}(at=ar||(ar={}))[at.OK=0]="OK",at[at.CANCELLED=1]="CANCELLED",at[at.UNKNOWN=2]="UNKNOWN",at[at.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",at[at.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",at[at.NOT_FOUND=5]="NOT_FOUND",at[at.ALREADY_EXISTS=6]="ALREADY_EXISTS",at[at.PERMISSION_DENIED=7]="PERMISSION_DENIED",at[at.UNAUTHENTICATED=16]="UNAUTHENTICATED",at[at.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",at[at.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",at[at.ABORTED=10]="ABORTED",at[at.OUT_OF_RANGE=11]="OUT_OF_RANGE",at[at.UNIMPLEMENTED=12]="UNIMPLEMENTED",at[at.INTERNAL=13]="INTERNAL",at[at.UNAVAILABLE=14]="UNAVAILABLE",at[at.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV=new Gs([4294967295,4294967295],0);function Uw(t){const e=zV().encode(t),r=new jA;return r.update(e),new Uint8Array(r.digest())}function zw(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Gs([r,n],0),new Gs([i,a],0)]}class bx{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Sc(`Invalid padding: ${r}`);if(n<0)throw new Sc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Sc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Sc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Gs.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Gs.fromNumber(n)));return i.compare(WV)===1&&(i=new Gs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=Uw(e),[n,i]=zw(r);for(let a=0;a<this.hashCount;a++){const s=this.Ee(n,i,a);if(!this.de(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new bx(a,i,r);return n.forEach(o=>s.insert(o)),s}insert(e){if(this.Ie===0)return;const r=Uw(e),[n,i]=zw(r);for(let a=0;a<this.hashCount;a++){const s=this.Ee(n,i,a);this.Ae(s)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,sf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new yd(He.min(),i,new Ht(ht),ha(),tt())}}class sf{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new sf(n,r,tt(),tt(),tt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class m4{constructor(e,r){this.targetId=e,this.me=r}}class g4{constructor(e,r,n=Or.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Ww{constructor(){this.fe=0,this.ge=$w(),this.pe=Or.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=tt(),r=tt(),n=tt();return this.ge.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:We()}}),new sf(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=$w()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class HV{constructor(e){this.Le=e,this.Be=new Map,this.ke=ha(),this.qe=Hw(),this.Qe=new Ht(ht)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:We()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const a=i.target;if(fg(a))if(n===0){const s=new Oe(a.path);this.Ue(r,s,Kr.newNoDocument(s,He.min()))}else xt(n===1);else{const s=this.Ye(r);if(s!==n){const o=this.Ze(e),l=o?this.Xe(o,e,s):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let s,o;try{s=so(n).toUint8Array()}catch(l){if(l instanceof qA)return bl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new bx(s,i,a)}catch(l){return bl(l instanceof Sc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const s=this.Le.tt(),o=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,a,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((a,s)=>{const o=this.Je(s);if(o){if(a.current&&fg(o.target)){const l=new Oe(o.target.path);this.ke.get(l)!==null||this.it(s,l)||this.Ue(s,l,Kr.newNoDocument(l,e))}a.be&&(r.set(s,a.ve()),a.Ce())}});let n=tt();this.qe.forEach((a,s)=>{let o=!0;s.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.ke.forEach((a,s)=>s.setReadTime(e));const i=new yd(e,r,this.Qe,this.ke,n);return this.ke=ha(),this.qe=Hw(),this.Qe=new Ht(ht),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new Ww,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Pr(ht),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Re("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ww),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function Hw(){return new Ht(Oe.comparator)}function $w(){return new Ht(Oe.comparator)}const $V={asc:"ASCENDING",desc:"DESCENDING"},GV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qV={and:"AND",or:"OR"};class KV{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function pg(t,e){return t.useProto3Json||pd(e)?e:{value:e}}function Ch(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function v4(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function XV(t,e){return Ch(t,e.toTimestamp())}function Ri(t){return xt(!!t),He.fromTimestamp(function(r){const n=fs(r);return new mr(n.seconds,n.nanos)}(t))}function Cx(t,e){return mg(t,e).canonicalString()}function mg(t,e){const r=function(i){return new Rt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function x4(t){const e=Rt.fromString(t);return xt(T4(e)),e}function gg(t,e){return Cx(t.databaseId,e.path)}function jp(t,e){const r=x4(e);if(r.get(1)!==t.databaseId.projectId)throw new Ce(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ce(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Oe(y4(r))}function _4(t,e){return Cx(t.databaseId,e)}function YV(t){const e=x4(t);return e.length===4?Rt.emptyPath():y4(e)}function vg(t){return new Rt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function y4(t){return xt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Gw(t,e,r){return{name:gg(t,e),fields:r.value.mapValue.fields}}function QV(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:We()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(xt(u===void 0||typeof u=="string"),Or.fromBase64String(u||"")):(xt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Or.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(c){const u=c.code===void 0?fe.UNKNOWN:p4(c.code);return new Ce(u,c.message||"")}(s);r=new g4(n,i,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=jp(t,n.document.name),a=Ri(n.document.updateTime),s=n.document.createTime?Ri(n.document.createTime):He.min(),o=new gn({mapValue:{fields:n.document.fields}}),l=Kr.newFoundDocument(i,a,s,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new b0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=jp(t,n.document),a=n.readTime?Ri(n.readTime):He.min(),s=Kr.newNoDocument(i,a),o=n.removedTargetIds||[];r=new b0([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=jp(t,n.document),a=n.removedTargetIds||[];r=new b0([],a,i,null)}else{if(!("filter"in e))return We();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,s=new VV(i,a),o=n.targetId;r=new m4(o,s)}}return r}function JV(t,e){let r;if(e instanceof af)r={update:Gw(t,e.key,e.value)};else if(e instanceof _d)r={delete:gg(t,e.key)};else if(e instanceof _s)r={update:Gw(t,e.key,e.data),updateMask:oU(e.fieldMask)};else{if(!(e instanceof MV))return We();r={verify:gg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,s){const o=s.transform;if(o instanceof Ih)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Mu)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ju)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof bh)return{fieldPath:s.field.canonicalString(),increment:o.Pe};throw We()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:XV(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:We()}(t,e.precondition)),r}function ZV(t,e){return t&&t.length>0?(xt(e!==void 0),t.map(r=>function(i,a){let s=i.updateTime?Ri(i.updateTime):Ri(a);return s.isEqual(He.min())&&(s=Ri(a)),new DV(s,i.transformResults||[])}(r,e))):[]}function eU(t,e){return{documents:[_4(t,e.path)]}}function tU(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=_4(t,i);const a=function(c){if(c.length!==0)return E4(pi.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const s=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:Mo(d.field),direction:iU(d.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const o=pg(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function rU(t){let e=YV(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){xt(n===1);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(h){const d=w4(h);return d instanceof pi&&QA(d)?d.getFilters():[d]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(d=>function(g){return new Lu(jo(g.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,pd(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new Ah(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new Ah(p,d)}(r.endAt)),wV(e,i,s,a,o,"F",l,c)}function nU(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return We()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function w4(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=jo(r.unaryFilter.field);return cr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=jo(r.unaryFilter.field);return cr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=jo(r.unaryFilter.field);return cr.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=jo(r.unaryFilter.field);return cr.create(s,"!=",{nullValue:"NULL_VALUE"});default:return We()}}(t):t.fieldFilter!==void 0?function(r){return cr.create(jo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return We()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return pi.create(r.compositeFilter.filters.map(n=>w4(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return We()}}(r.compositeFilter.op))}(t):We()}function iU(t){return $V[t]}function aU(t){return GV[t]}function sU(t){return qV[t]}function Mo(t){return{fieldPath:t.canonicalString()}}function jo(t){return Rr.fromServerFormat(t.fieldPath)}function E4(t){return t instanceof cr?function(r){if(r.op==="=="){if(Fw(r.value))return{unaryFilter:{field:Mo(r.field),op:"IS_NAN"}};if(Rw(r.value))return{unaryFilter:{field:Mo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Fw(r.value))return{unaryFilter:{field:Mo(r.field),op:"IS_NOT_NAN"}};if(Rw(r.value))return{unaryFilter:{field:Mo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mo(r.field),op:aU(r.op),value:r.value}}}(t):t instanceof pi?function(r){const n=r.getFilters().map(i=>E4(i));return n.length===1?n[0]:{compositeFilter:{op:sU(r.op),filters:n}}}(t):We()}function oU(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function T4(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,r,n,i,a=He.min(),s=He.min(),o=Or.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Wa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.ct=e}}function cU(t){const e=rU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(){this.un=new fU}addToCollectionParentIndex(e,r){return this.un.add(r),me.resolve()}getCollectionParents(e,r){return me.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return me.resolve()}deleteFieldIndex(e,r){return me.resolve()}deleteAllFieldIndexes(e){return me.resolve()}createTargetIndexes(e,r){return me.resolve()}getDocumentsMatchingTarget(e,r){return me.resolve(null)}getIndexType(e,r){return me.resolve(0)}getFieldIndexes(e,r){return me.resolve([])}getNextCollectionGroupToUpdate(e){return me.resolve(null)}getMinOffset(e,r){return me.resolve(us.min())}getMinOffsetFromCollectionGroup(e,r){return me.resolve(us.min())}updateCollectionGroup(e,r,n){return me.resolve()}updateIndexEntries(e,r){return me.resolve()}}class fU{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Pr(Rt.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Pr(Rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Fl(0)}static kn(){return new Fl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(){this.changes=new $l(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Kr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?me.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Kc(n.mutation,i,Dn.empty(),mr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,tt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=tt()){const i=Bs();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let s=kc();return a.forEach((o,l)=>{s=s.insert(o,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=Bs();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,tt()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((s,o)=>{r.set(s,o)})})}computeViews(e,r,n,i){let a=ha();const s=qc(),o=function(){return qc()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof _s)?a=a.insert(c.key,c):u!==void 0?(s.set(c.key,u.mutation.getFieldMask()),Kc(u.mutation,c,u.mutation.getFieldMask(),mr.now())):s.set(c.key,Dn.empty())}),this.recalculateAndSaveOverlays(e,a).next(l=>(l.forEach((c,u)=>s.set(c,u)),r.forEach((c,u)=>{var h;return o.set(c,new dU(u,(h=s.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=qc();let i=new Ht((s,o)=>s-o),a=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const o of s)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Dn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(i.get(o.batchId)||tt()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=s4();u.forEach(d=>{if(!a.has(d)){const p=h4(r.get(d),n.get(d));p!==null&&h.set(d,p),a=a.add(d)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return me.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return Oe.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):t4(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):me.resolve(Bs());let o=-1,l=a;return s.next(c=>me.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?me.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,l,c,tt())).next(u=>({batchId:o,changes:a4(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Oe(r)).next(n=>{let i=kc();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let s=kc();return this.indexManager.getCollectionParents(e,a).next(o=>me.forEach(o,l=>{const c=function(h,d){return new Hl(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(u=>{u.forEach((h,d)=>{s=s.insert(h,d)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(s=>{a.forEach((l,c)=>{const u=c.getKey();s.get(u)===null&&(s=s.insert(u,Kr.newInvalidDocument(u)))});let o=kc();return s.forEach((l,c)=>{const u=a.get(l);u!==void 0&&Kc(u.mutation,c,Dn.empty(),mr.now()),gd(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return me.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Ri(i.createTime)}}(r)),me.resolve()}getNamedQuery(e,r){return me.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:cU(i.bundledQuery),readTime:Ri(i.readTime)}}(r)),me.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(){this.overlays=new Ht(Oe.comparator),this.Ir=new Map}getOverlay(e,r){return me.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Bs();return me.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.ht(e,r,a)}),me.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),me.resolve()}getOverlaysForCollection(e,r,n){const i=Bs(),a=r.length+1,s=new Oe(r.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&i.set(l.getKey(),l)}return me.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Ht((c,u)=>c-u);const s=this.overlays.getIterator();for(;s.hasNext();){const c=s.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=Bs(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Bs(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return me.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new BV(r,n));let a=this.Ir.get(r);a===void 0&&(a=tt(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(){this.sessionToken=Or.EMPTY_BYTE_STRING}getSessionToken(e){return me.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,me.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(){this.Tr=new Pr(xr.Er),this.dr=new Pr(xr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new xr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new xr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Oe(new Rt([])),n=new xr(r,e),i=new xr(r,e+1),a=[];return this.dr.forEachInRange([n,i],s=>{this.Vr(s),a.push(s.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Oe(new Rt([])),n=new xr(r,e),i=new xr(r,e+1);let a=tt();return this.dr.forEachInRange([n,i],s=>{a=a.add(s.key)}),a}containsKey(e){const r=new xr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class xr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Oe.comparator(e.key,r.key)||ht(e.wr,r.wr)}static Ar(e,r){return ht(e.wr,r.wr)||Oe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Pr(xr.Er)}checkEmpty(e){return me.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new jV(a,r,n,i);this.mutationQueue.push(s);for(const o of i)this.br=this.br.add(new xr(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return me.resolve(s)}lookupMutationBatch(e,r){return me.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),a=i<0?0:i;return me.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return me.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new xr(r,0),i=new xr(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,i],s=>{const o=this.Dr(s.wr);a.push(o)}),me.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pr(ht);return r.forEach(i=>{const a=new xr(i,0),s=new xr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,s],o=>{n=n.add(o.wr)})}),me.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;Oe.isDocumentKey(a)||(a=a.child(""));const s=new xr(new Oe(a),0);let o=new Pr(ht);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},s),me.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){xt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return me.forEach(r.mutations,i=>{const a=new xr(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new xr(r,0),i=this.br.firstAfterOrEqual(n);return me.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,me.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e){this.Mr=e,this.docs=function(){return new Ht(Oe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,s=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return me.resolve(n?n.document.mutableCopy():Kr.newInvalidDocument(r))}getEntries(e,r){let n=ha();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Kr.newInvalidDocument(i))}),me.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=ha();const s=r.path,o=new Oe(s.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||rV(tV(u),n)<=0||(i.has(u.key)||gd(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return me.resolve(a)}getAllFromCollectionGroup(e,r,n,i){We()}Or(e,r){return me.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new yU(this)}getSize(e){return me.resolve(this.size)}}class yU extends hU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),me.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(e){this.persistence=e,this.Nr=new $l(r=>Tx(r),kx),this.lastRemoteSnapshotVersion=He.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Nx,this.targetCount=0,this.kr=Fl.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),me.resolve()}getLastRemoteSnapshotVersion(e){return me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return me.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),me.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),me.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Fl(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,me.resolve()}updateTargetData(e,r){return this.Kn(r),me.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,me.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.Nr.forEach((s,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(s),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),me.waitFor(a).next(()=>i)}getTargetCount(e){return me.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return me.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),me.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(s=>{a.push(i.markPotentiallyOrphaned(e,s))}),me.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),me.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return me.resolve(n)}containsKey(e,r){return me.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e,r){this.qr={},this.overlays={},this.Qr=new _x(0),this.Kr=!1,this.Kr=!0,this.$r=new vU,this.referenceDelegate=e(this),this.Ur=new wU(this),this.indexManager=new uU,this.remoteDocumentCache=function(i){return new _U(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new lU(r),this.Gr=new mU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new gU,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new xU(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Re("MemoryPersistence","Starting transaction:",e);const i=new TU(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(a=>this.referenceDelegate.jr(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Hr(e,r){return me.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class TU extends iV{constructor(e){super(),this.currentSequenceNumber=e}}class Rx{constructor(e){this.persistence=e,this.Jr=new Nx,this.Yr=null}static Zr(e){return new Rx(e)}get Xr(){if(this.Yr)return this.Yr;throw We()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),me.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),me.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),me.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return me.forEach(this.Xr,n=>{const i=Oe.fromPath(n);return this.ei(e,i).next(a=>{a||r.removeEntry(i,He.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return me.or([()=>me.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=tt(),i=tt();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Fx(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Aj()?8:aV(Zr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.Yi(e,r).next(s=>{a.result=s}).next(()=>{if(!a.result)return this.Zi(e,r,i,n).next(s=>{a.result=s})}).next(()=>{if(a.result)return;const s=new kU;return this.Xi(e,r,s).next(o=>{if(a.result=o,this.zi)return this.es(e,r,s,o.size)})}).next(()=>a.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(hc()<=rt.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",Lo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),me.resolve()):(hc()<=rt.DEBUG&&Re("QueryEngine","Query:",Lo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(hc()<=rt.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",Lo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ni(r))):me.resolve())}Yi(e,r){if(Lw(r))return me.resolve(null);let n=Ni(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=dg(r,null,"F"),n=Ni(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const s=tt(...a);return this.Ji.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,s,l.readTime)?this.Yi(e,dg(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return Lw(r)||i.isEqual(He.min())?me.resolve(null):this.Ji.getDocuments(e,n).next(a=>{const s=this.ts(r,a);return this.ns(r,s,n,i)?me.resolve(null):(hc()<=rt.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Lo(r)),this.rs(e,s,r,eV(i,-1)).next(o=>o))})}ts(e,r){let n=new Pr(n4(e));return r.forEach((i,a)=>{gd(e,a)&&(n=n.add(a))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Xi(e,r,n){return hc()<=rt.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",Lo(r)),this.Ji.getDocumentsMatchingQuery(e,r,us.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(s=>{a=a.insert(s.key,s)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Ht(ht),this._s=new $l(a=>Tx(a),kx),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function IU(t,e,r,n){return new AU(t,e,r,n)}async function k4(t,e){const r=$e(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const s=[],o=[];let l=tt();for(const c of i){s.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:s,addedBatchIds:o}))})})}function bU(t,e){const r=$e(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,d=h.keys();let p=me.resolve();return d.forEach(g=>{p=p.next(()=>u.getEntry(l,g)).next(m=>{const _=c.docVersions.get(g);xt(_!==null),m.version.compareTo(_)<0&&(h.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),u.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=tt();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function S4(t){const e=$e(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function CU(t,e){const r=$e(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const s=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,h)));let p=d.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Or.EMPTY_BYTE_STRING,He.min()).withLastLimboFreeSnapshotVersion(He.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(h,p),function(m,_,y){return m.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,p,u)&&o.push(r.Ur.updateTargetData(a,p))});let l=ha(),c=tt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(NU(a,s,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(He.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(h=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return me.waitFor(o).next(()=>s.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.os=i,a))}function NU(t,e,r){let n=tt(),i=tt();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let s=ha();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(He.min())?(e.removeEntry(o,l.readTime),s=s.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(o,l)):Re("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:s,Is:i}})}function RU(t,e){const r=$e(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function FU(t,e){const r=$e(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(a=>a?(i=a,me.resolve(i)):r.Ur.allocateTargetId(n).next(s=>(i=new Wa(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function xg(t,e,r){const n=$e(t),i=n.os.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!nf(s))throw s;Re("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function qw(t,e,r){const n=$e(t);let i=He.min(),a=tt();return n.persistence.runTransaction("Execute query","readwrite",s=>function(l,c,u){const h=$e(l),d=h._s.get(u);return d!==void 0?me.resolve(h.os.get(d)):h.Ur.getTargetData(c,u)}(n,s,Ni(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(s,o.targetId).next(l=>{a=l})}).next(()=>n.ss.getDocumentsMatchingQuery(s,e,r?i:He.min(),r?a:tt())).next(o=>(PU(n,TV(e),o),{documents:o,Ts:a})))}function PU(t,e,r){let n=t.us.get(e)||He.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.us.set(e,n)}class Kw{constructor(){this.activeTargetIds=CV()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DU{constructor(){this.so=new Kw,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Kw,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u0=null;function Bp(){return u0===null?u0=function(){return 268435456+Math.round(2147483648*Math.random())}():u0++,"0x"+u0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur="WebChannelConnection";class jU extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${a}`}get Fo(){return!1}Mo(r,n,i,a,s){const o=Bp(),l=this.xo(r,n.toUriEncodedString());Re("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,a,s),this.No(r,l,c,i).then(u=>(Re("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw bl("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",i),u})}Lo(r,n,i,a,s,o){return this.Mo(r,n,i,a,s)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,s)=>r[s]=a),i&&i.headers.forEach((a,s)=>r[s]=a)}xo(r,n){const i=LU[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const a=Bp();return new Promise((s,o)=>{const l=new BA;l.setWithCredentials(!0),l.listenOnce(VA.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case S0.NO_ERROR:const u=l.getResponseJson();Re(Ur,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(u)),s(u);break;case S0.TIMEOUT:Re(Ur,`RPC '${e}' ${a} timed out`),o(new Ce(fe.DEADLINE_EXCEEDED,"Request time out"));break;case S0.HTTP_ERROR:const h=l.getStatus();if(Re(Ur,`RPC '${e}' ${a} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const g=function(_){const y=_.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(y)>=0?y:fe.UNKNOWN}(p.status);o(new Ce(g,p.message))}else o(new Ce(fe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ce(fe.UNAVAILABLE,"Connection failed."));break;default:We()}}finally{Re(Ur,`RPC '${e}' ${a} completed.`)}});const c=JSON.stringify(i);Re(Ur,`RPC '${e}' ${a} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Bp(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=WA(),o=zA(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");Re(Ur,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=s.createWebChannel(u,l);let d=!1,p=!1;const g=new MU({Io:_=>{p?Re(Ur,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(d||(Re(Ur,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),Re(Ur,`RPC '${e}' stream ${i} sending:`,_),h.send(_))},To:()=>h.close()}),m=(_,y,T)=>{_.listen(y,w=>{try{T(w)}catch(R){setTimeout(()=>{throw R},0)}})};return m(h,Tc.EventType.OPEN,()=>{p||(Re(Ur,`RPC '${e}' stream ${i} transport opened.`),g.yo())}),m(h,Tc.EventType.CLOSE,()=>{p||(p=!0,Re(Ur,`RPC '${e}' stream ${i} transport closed`),g.So())}),m(h,Tc.EventType.ERROR,_=>{p||(p=!0,bl(Ur,`RPC '${e}' stream ${i} transport errored:`,_),g.So(new Ce(fe.UNAVAILABLE,"The operation could not be completed")))}),m(h,Tc.EventType.MESSAGE,_=>{var y;if(!p){const T=_.data[0];xt(!!T);const w=T,R=w.error||((y=w[0])===null||y===void 0?void 0:y.error);if(R){Re(Ur,`RPC '${e}' stream ${i} received error:`,R);const j=R.status;let D=function(k){const I=ar[k];if(I!==void 0)return p4(I)}(j),E=R.message;D===void 0&&(D=fe.INTERNAL,E="Unknown error status: "+j+" with message "+R.message),p=!0,g.So(new Ce(D,E)),h.close()}else Re(Ur,`RPC '${e}' stream ${i} received:`,T),g.bo(T)}}),m(o,UA.STAT_EVENT,_=>{_.stat===og.PROXY?Re(Ur,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===og.NOPROXY&&Re(Ur,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function Vp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(t){return new KV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(e,r,n=1e3,i=1.5,a=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e,r,n,i,a,s,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new A4(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===fe.RESOURCE_EXHAUSTED?(fa(r.toString()),fa("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new Ce(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class BU extends I4{constructor(e,r,n,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=QV(this.serializer,e),n=function(a){if(!("targetChange"in a))return He.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?He.min():s.readTime?Ri(s.readTime):He.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=vg(this.serializer),r.addTarget=function(a,s){let o;const l=s.target;if(o=fg(l)?{documents:eU(a,l)}:{query:tU(a,l)._t},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=v4(a,s.resumeToken);const c=pg(a,s.expectedCount);c!==null&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(He.min())>0){o.readTime=Ch(a,s.snapshotVersion.toTimestamp());const c=pg(a,s.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=nU(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=vg(this.serializer),r.removeTarget=e,this.a_(r)}}class VU extends I4{constructor(e,r,n,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return xt(!!e.streamToken),this.lastStreamToken=e.streamToken,xt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){xt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=ZV(e.writeResults,e.commitTime),n=Ri(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=vg(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>JV(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Ce(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Mo(e,mg(r,n),i,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ce(fe.UNKNOWN,a.toString())})}Lo(e,r,n,i,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Lo(e,mg(r,n),i,s,o,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ce(fe.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class zU{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(fa(r),this.D_=!1):Re("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(s=>{n.enqueueAndForget(async()=>{wo(this)&&(Re("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=$e(l);c.L_.add(4),await of(c),c.q_.set("Unknown"),c.L_.delete(4),await Ed(c)}(this))})}),this.q_=new zU(n,i)}}async function Ed(t){if(wo(t))for(const e of t.B_)await e(!0)}async function of(t){for(const e of t.B_)await e(!1)}function b4(t,e){const r=$e(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Lx(r)?Ox(r):Gl(r).r_()&&Dx(r,e))}function Px(t,e){const r=$e(t),n=Gl(r);r.N_.delete(e),n.r_()&&C4(r,e),r.N_.size===0&&(n.r_()?n.o_():wo(r)&&r.q_.set("Unknown"))}function Dx(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(He.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Gl(t).A_(e)}function C4(t,e){t.Q_.xe(e),Gl(t).R_(e)}function Ox(t){t.Q_=new HV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Gl(t).start(),t.q_.v_()}function Lx(t){return wo(t)&&!Gl(t).n_()&&t.N_.size>0}function wo(t){return $e(t).L_.size===0}function N4(t){t.Q_=void 0}async function HU(t){t.q_.set("Online")}async function $U(t){t.N_.forEach((e,r)=>{Dx(t,e)})}async function GU(t,e){N4(t),Lx(t)?(t.q_.M_(e),Ox(t)):t.q_.set("Unknown")}async function qU(t,e,r){if(t.q_.set("Online"),e instanceof g4&&e.state===2&&e.cause)try{await async function(i,a){const s=a.cause;for(const o of a.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Nh(t,n)}else if(e instanceof b0?t.Q_.Ke(e):e instanceof m4?t.Q_.He(e):t.Q_.We(e),!r.isEqual(He.min()))try{const n=await S4(t.localStore);r.compareTo(n)>=0&&await function(a,s){const o=a.Q_.rt(s);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.N_.get(c);u&&a.N_.set(c,u.withResumeToken(l.resumeToken,s))}}),o.targetMismatches.forEach((l,c)=>{const u=a.N_.get(l);if(!u)return;a.N_.set(l,u.withResumeToken(Or.EMPTY_BYTE_STRING,u.snapshotVersion)),C4(a,l);const h=new Wa(u.target,l,c,u.sequenceNumber);Dx(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Re("RemoteStore","Failed to raise snapshot:",n),await Nh(t,n)}}async function Nh(t,e,r){if(!nf(e))throw e;t.L_.add(1),await of(t),t.q_.set("Offline"),r||(r=()=>S4(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Re("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Ed(t)})}function R4(t,e){return e().catch(r=>Nh(t,r,e))}async function Td(t){const e=$e(t),r=hs(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;KU(e);)try{const i=await RU(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,XU(e,i)}catch(i){await Nh(e,i)}F4(e)&&P4(e)}function KU(t){return wo(t)&&t.O_.length<10}function XU(t,e){t.O_.push(e);const r=hs(t);r.r_()&&r.V_&&r.m_(e.mutations)}function F4(t){return wo(t)&&!hs(t).n_()&&t.O_.length>0}function P4(t){hs(t).start()}async function YU(t){hs(t).p_()}async function QU(t){const e=hs(t);for(const r of t.O_)e.m_(r.mutations)}async function JU(t,e,r){const n=t.O_.shift(),i=Ix.from(n,e,r);await R4(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Td(t)}async function ZU(t,e){e&&hs(t).V_&&await async function(n,i){if(function(s){return UV(s)&&s!==fe.ABORTED}(i.code)){const a=n.O_.shift();hs(n).s_(),await R4(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Td(n)}}(t,e),F4(t)&&P4(t)}async function Yw(t,e){const r=$e(t);r.asyncQueue.verifyOperationInProgress(),Re("RemoteStore","RemoteStore received new credentials");const n=wo(r);r.L_.add(3),await of(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Ed(r)}async function ez(t,e){const r=$e(t);e?(r.L_.delete(2),await Ed(r)):e||(r.L_.add(2),await of(r),r.q_.set("Unknown"))}function Gl(t){return t.K_||(t.K_=function(r,n,i){const a=$e(r);return a.w_(),new BU(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Eo:HU.bind(null,t),Ro:$U.bind(null,t),mo:GU.bind(null,t),d_:qU.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Lx(t)?Ox(t):t.q_.set("Unknown")):(await t.K_.stop(),N4(t))})),t.K_}function hs(t){return t.U_||(t.U_=function(r,n,i){const a=$e(r);return a.w_(),new VU(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:YU.bind(null,t),mo:ZU.bind(null,t),f_:QU.bind(null,t),g_:JU.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Td(t)):(await t.U_.stop(),t.O_.length>0&&(Re("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new na,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const s=Date.now()+n,o=new Mx(e,r,s,i,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jx(t,e){if(fa("AsyncQueue",`${e}: ${t}`),nf(t))return new Ce(fe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Oe.comparator(r.key,n.key):(r,n)=>Oe.comparator(r.key,n.key),this.keyedMap=kc(),this.sortedSet=new Ht(this.comparator)}static emptySet(e){return new ul(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ul)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ul;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(){this.W_=new Ht(Oe.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):We():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Pl{constructor(e,r,n,i,a,s,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,a){const s=[];return r.forEach(o=>{s.push({type:0,doc:o})}),new Pl(e,r,ul.emptySet(r),s,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&md(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class rz{constructor(){this.queries=Jw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=$e(r),a=i.queries;i.queries=Jw(),a.forEach((s,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Ce(fe.ABORTED,"Firestore shutting down"))}}function Jw(){return new $l(t=>r4(t),md)}async function D4(t,e){const r=$e(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.H_()&&e.J_()&&(n=2):(a=new tz,n=e.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(i,!0);break;case 1:a.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const o=jx(s,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,a),a.j_.push(e),e.Z_(r.onlineState),a.z_&&e.X_(a.z_)&&Bx(r)}async function O4(t,e){const r=$e(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const s=a.j_.indexOf(e);s>=0&&(a.j_.splice(s,1),a.j_.length===0?i=e.J_()?0:1:!a.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function nz(t,e){const r=$e(t);let n=!1;for(const i of e){const a=i.query,s=r.queries.get(a);if(s){for(const o of s.j_)o.X_(i)&&(n=!0);s.z_=i}}n&&Bx(r)}function iz(t,e,r){const n=$e(t),i=n.queries.get(e);if(i)for(const a of i.j_)a.onError(r);n.queries.delete(e)}function Bx(t){t.Y_.forEach(e=>{e.next()})}var _g,Zw;(Zw=_g||(_g={})).ea="default",Zw.Cache="cache";class L4{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Pl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Pl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==_g.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e){this.key=e}}class j4{constructor(e){this.key=e}}class az{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=tt(),this.mutatedKeys=tt(),this.Aa=n4(e),this.Ra=new ul(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new Qw,i=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,s=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),p=gd(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;d&&p?d.data.isEqual(p.data)?g!==m&&(n.track({type:3,doc:p}),_=!0):this.ga(d,p)||(n.track({type:2,doc:p}),_=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),_=!0):d&&!p&&(n.track({type:1,doc:d}),_=!0,(l||c)&&(o=!0)),_&&(p?(s=s.add(p),a=m?a.add(u):a.delete(u)):(s=s.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:s,fa:n,ns:o,mutatedKeys:a}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((u,h)=>function(p,g){const m=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return We()}};return m(p)-m(g)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,s.length!==0||c?{snapshot:new Pl(this.query,e.Ra,a,s,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Qw,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=tt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new j4(n))}),this.da.forEach(n=>{e.has(n)||r.push(new M4(n))}),r}ba(e){this.Ta=e.Ts,this.da=tt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Pl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class sz{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class oz{constructor(e){this.key=e,this.va=!1}}class lz{constructor(e,r,n,i,a,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new $l(o=>r4(o),md),this.Ma=new Map,this.xa=new Set,this.Oa=new Ht(Oe.comparator),this.Na=new Map,this.La=new Nx,this.Ba={},this.ka=new Map,this.qa=Fl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function cz(t,e,r=!0){const n=H4(t);let i;const a=n.Fa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Da()):i=await B4(n,e,r,!0),i}async function uz(t,e){const r=H4(t);await B4(r,e,!0,!1)}async function B4(t,e,r,n){const i=await FU(t.localStore,Ni(e)),a=i.targetId,s=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await fz(t,e,a,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&b4(t.remoteStore,i),o}async function fz(t,e,r,n,i){t.Ka=(h,d,p)=>async function(m,_,y,T){let w=_.view.ma(y);w.ns&&(w=await qw(m.localStore,_.query,!1).then(({documents:E})=>_.view.ma(E,w)));const R=T&&T.targetChanges.get(_.targetId),j=T&&T.targetMismatches.get(_.targetId)!=null,D=_.view.applyChanges(w,m.isPrimaryClient,R,j);return t2(m,_.targetId,D.wa),D.snapshot}(t,h,d,p);const a=await qw(t.localStore,e,!0),s=new az(e,a.Ts),o=s.ma(a.documents),l=sf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=s.applyChanges(o,t.isPrimaryClient,l);t2(t,r,c.wa);const u=new sz(e,r,s);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function hz(t,e,r){const n=$e(t),i=n.Fa.get(e),a=n.Ma.get(i.targetId);if(a.length>1)return n.Ma.set(i.targetId,a.filter(s=>!md(s,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await xg(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Px(n.remoteStore,i.targetId),yg(n,i.targetId)}).catch(rf)):(yg(n,i.targetId),await xg(n.localStore,i.targetId,!0))}async function dz(t,e){const r=$e(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Px(r.remoteStore,n.targetId))}async function pz(t,e,r){const n=wz(t);try{const i=await function(s,o){const l=$e(s),c=mr.now(),u=o.reduce((p,g)=>p.add(g.key),tt());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=ha(),m=tt();return l.cs.getEntries(p,u).next(_=>{g=_,g.forEach((y,T)=>{T.isValidDocument()||(m=m.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(_=>{h=_;const y=[];for(const T of o){const w=LV(T,h.get(T.key).overlayedDocument);w!=null&&y.push(new _s(T.key,w,KA(w.value.mapValue),En.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,y,o)}).next(_=>{d=_;const y=_.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(p,_.batchId,y)})}).then(()=>({batchId:d.batchId,changes:a4(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,l){let c=s.Ba[s.currentUser.toKey()];c||(c=new Ht(ht)),c=c.insert(o,l),s.Ba[s.currentUser.toKey()]=c}(n,i.batchId,r),await lf(n,i.changes),await Td(n.remoteStore)}catch(i){const a=jx(i,"Failed to persist write");r.reject(a)}}async function V4(t,e){const r=$e(t);try{const n=await CU(r.localStore,e);e.targetChanges.forEach((i,a)=>{const s=r.Na.get(a);s&&(xt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?xt(s.va):i.removedDocuments.size>0&&(xt(s.va),s.va=!1))}),await lf(r,n,e)}catch(n){await rf(n)}}function e2(t,e,r){const n=$e(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((a,s)=>{const o=s.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(s,o){const l=$e(s);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const d of h.j_)d.Z_(o)&&(c=!0)}),c&&Bx(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function mz(t,e,r){const n=$e(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),a=i&&i.key;if(a){let s=new Ht(Oe.comparator);s=s.insert(a,Kr.newNoDocument(a,He.min()));const o=tt().add(a),l=new yd(He.min(),new Map,new Ht(ht),s,o);await V4(n,l),n.Oa=n.Oa.remove(a),n.Na.delete(e),Vx(n)}else await xg(n.localStore,e,!1).then(()=>yg(n,e,r)).catch(rf)}async function gz(t,e){const r=$e(t),n=e.batch.batchId;try{const i=await bU(r.localStore,e);z4(r,n,null),U4(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await lf(r,i)}catch(i){await rf(i)}}async function vz(t,e,r){const n=$e(t);try{const i=await function(s,o){const l=$e(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(xt(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);z4(n,e,r),U4(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await lf(n,i)}catch(i){await rf(i)}}function U4(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function z4(t,e,r){const n=$e(t);let i=n.Ba[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function yg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||W4(t,n)})}function W4(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Px(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Vx(t))}function t2(t,e,r){for(const n of r)n instanceof M4?(t.La.addReference(n.key,e),xz(t,n)):n instanceof j4?(Re("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||W4(t,n.key)):We()}function xz(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Re("SyncEngine","New document in limbo: "+r),t.xa.add(n),Vx(t))}function Vx(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Oe(Rt.fromString(e)),n=t.qa.next();t.Na.set(n,new oz(r)),t.Oa=t.Oa.insert(r,n),b4(t.remoteStore,new Wa(Ni(Sx(r.path)),n,"TargetPurposeLimboResolution",_x.oe))}}async function lf(t,e,r){const n=$e(t),i=[],a=[],s=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{s.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Fx.Wi(l.targetId,c);a.push(h)}}))}),await Promise.all(s),n.Ca.d_(i),await async function(l,c){const u=$e(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>me.forEach(c,d=>me.forEach(d.$i,p=>u.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>me.forEach(d.Ui,p=>u.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!nf(h))throw h;Re("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=u.os.get(d),g=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(d,m)}}}(n.localStore,a))}async function _z(t,e){const r=$e(t);if(!r.currentUser.isEqual(e)){Re("SyncEngine","User change. New user:",e.toKey());const n=await k4(r.localStore,e);r.currentUser=e,function(a,s){a.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ce(fe.CANCELLED,s))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await lf(r,n.hs)}}function yz(t,e){const r=$e(t),n=r.Na.get(e);if(n&&n.va)return tt().add(n.key);{let i=tt();const a=r.Ma.get(e);if(!a)return i;for(const s of a){const o=r.Fa.get(s);i=i.unionWith(o.view.Va)}return i}}function H4(t){const e=$e(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=V4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mz.bind(null,e),e.Ca.d_=nz.bind(null,e.eventManager),e.Ca.$a=iz.bind(null,e.eventManager),e}function wz(t){const e=$e(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vz.bind(null,e),e}class Rh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return IU(this.persistence,new SU,e.initialUser,this.serializer)}Ga(e){return new EU(Rx.Zr,this.serializer)}Wa(e){return new DU}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Rh.provider={build:()=>new Rh};class wg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>e2(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=_z.bind(null,this.syncEngine),await ez(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new rz}()}createDatastore(e){const r=wd(e.databaseInfo.databaseId),n=function(a){return new jU(a)}(e.databaseInfo);return function(a,s,o,l){return new UU(a,s,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,s,o){return new WU(n,i,a,s,o)}(this.localStore,this.datastore,e.asyncQueue,r=>e2(this.syncEngine,r,0),function(){return Xw.D()?new Xw:new OU}())}createSyncEngine(e,r){return function(i,a,s,o,l,c,u){const h=new lz(i,a,s,o,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const a=$e(i);Re("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await of(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}wg.provider={build:()=>new wg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):fa("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ez{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Wr.UNAUTHENTICATED,this.clientId=$A.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async s=>{Re("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Re("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new na;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=jx(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Up(t,e){t.asyncQueue.verifyOperationInProgress(),Re("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await k4(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function r2(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Tz(t);Re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Yw(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Yw(e.remoteStore,i)),t._onlineComponents=e}async function Tz(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Re("FirestoreClient","Using user provided OfflineComponentProvider");try{await Up(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===fe.FAILED_PRECONDITION||i.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;bl("Error using user provided cache. Falling back to memory cache: "+r),await Up(t,new Rh)}}else Re("FirestoreClient","Using default OfflineComponentProvider"),await Up(t,new Rh);return t._offlineComponents}async function G4(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Re("FirestoreClient","Using user provided OnlineComponentProvider"),await r2(t,t._uninitializedComponentsProvider._online)):(Re("FirestoreClient","Using default OnlineComponentProvider"),await r2(t,new wg))),t._onlineComponents}function kz(t){return G4(t).then(e=>e.syncEngine)}async function q4(t){const e=await G4(t),r=e.eventManager;return r.onListen=cz.bind(null,e.syncEngine),r.onUnlisten=hz.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=uz.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=dz.bind(null,e.syncEngine),r}function Sz(t,e,r={}){const n=new na;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,l,c){const u=new $4({next:d=>{u.Za(),s.enqueueAndForget(()=>O4(a,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new Ce(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new Ce(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new L4(Sx(o.path),u,{includeMetadataChanges:!0,_a:!0});return D4(a,h)}(await q4(t),t.asyncQueue,e,r,n)),n.promise}function Az(t,e,r={}){const n=new na;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,l,c){const u=new $4({next:d=>{u.Za(),s.enqueueAndForget(()=>O4(a,h)),d.fromCache&&l.source==="server"?c.reject(new Ce(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new L4(o,u,{includeMetadataChanges:!0,_a:!0});return D4(a,h)}(await q4(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K4(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X4(t,e,r){if(!r)throw new Ce(fe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Iz(t,e,r,n){if(e===!0&&n===!0)throw new Ce(fe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function i2(t){if(!Oe.isDocumentKey(t))throw new Ce(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function a2(t){if(Oe.isDocumentKey(t))throw new Ce(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function kd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":We()}function Oi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ce(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=kd(t);throw new Ce(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ce(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Iz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=K4((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ce(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ce(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ce(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sd{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new s2({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new s2(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new $B;switch(n.type){case"firstParty":return new XB(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ce(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=n2.get(r);n&&(Re("ComponentProvider","Removing Datastore"),n2.delete(r),n.terminate())}(this),Promise.resolve()}}function bz(t,e,r,n={}){var i;const a=(t=Oi(t,Sd))._getSettings(),s=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==s&&bl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:s,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Wr.MOCK_USER;else{o=_j(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Ce(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Wr(c)}t._authCredentials=new GB(new HA(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Eo(this.firestore,e,this._query)}}class Tn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}}class rs extends Eo{constructor(e,r,n){super(e,r,Sx(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new Oe(e))}withConverter(e){return new rs(this.firestore,e,this._path)}}function Lt(t,e,...r){if(t=tr(t),X4("collection","path",e),t instanceof Sd){const n=Rt.fromString(e,...r);return a2(n),new rs(t,null,n)}{if(!(t instanceof Tn||t instanceof rs))throw new Ce(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Rt.fromString(e,...r));return a2(n),new rs(t.firestore,null,n)}}function mn(t,e,...r){if(t=tr(t),arguments.length===1&&(e=$A.newId()),X4("doc","path",e),t instanceof Sd){const n=Rt.fromString(e,...r);return i2(n),new Tn(t,null,new Oe(n))}{if(!(t instanceof Tn||t instanceof rs))throw new Ce(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Rt.fromString(e,...r));return i2(n),new Tn(t.firestore,t instanceof rs?t.converter:null,new Oe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new A4(this,"async_queue_retry"),this.Vu=()=>{const n=Vp();n&&Re("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Vp();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Vp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new na;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!nf(e))throw e;Re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(n);throw fa("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Mx.createAndSchedule(this,e,r,n,a=>this.yu(a));return this.Tu.push(i),i}fu(){this.Eu&&We()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class To extends Sd{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new o2,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new o2(e),this._firestoreClient=void 0,await e}}}function Cz(t,e){const r=typeof t=="object"?t:OA(),n=typeof t=="string"?t:"(default)",i=vx(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=vj("firestore");a&&bz(i,...a)}return i}function Ad(t){if(t._terminated)throw new Ce(fe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Nz(t),t._firestoreClient}function Nz(t){var e,r,n;const i=t._freezeSettings(),a=function(o,l,c,u){return new lV(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,K4(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new Ez(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dl(Or.fromBase64String(e))}catch(r){throw new Ce(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Dl(Or.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ce(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ce(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ce(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ht(this._lat,e._lat)||ht(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rz=/^__.*__$/;class Fz{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new _s(e,this.data,this.fieldMask,r,this.fieldTransforms):new af(e,this.data,r,this.fieldTransforms)}}class Y4{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new _s(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Q4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw We()}}class Hx{constructor(e,r,n,i,a,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Hx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Fh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Q4(this.Cu)&&Rz.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Pz{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||wd(e)}Qu(e,r,n,i=!1){return new Hx({Cu:e,methodName:r,qu:n,path:Rr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Id(t){const e=t._freezeSettings(),r=wd(t._databaseId);return new Pz(t._databaseId,!!e.ignoreUndefinedProperties,r)}function J4(t,e,r,n,i,a={}){const s=t.Qu(a.merge||a.mergeFields?2:0,e,r,i);$x("Data must be an object, but it was:",s,n);const o=tI(n,s);let l,c;if(a.merge)l=new Dn(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const d=Eg(e,h,r);if(!s.contains(d))throw new Ce(fe.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);nI(u,d)||u.push(d)}l=new Dn(u),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new Fz(new gn(o),l,c)}class bd extends Ux{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bd}}function Z4(t,e,r,n){const i=t.Qu(1,e,r);$x("Data must be an object, but it was:",i,n);const a=[],s=gn.empty();yo(n,(l,c)=>{const u=Gx(e,l,r);c=tr(c);const h=i.Nu(u);if(c instanceof bd)a.push(u);else{const d=uf(c,h);d!=null&&(a.push(u),s.set(u,d))}});const o=new Dn(a);return new Y4(s,o,i.fieldTransforms)}function eI(t,e,r,n,i,a){const s=t.Qu(1,e,r),o=[Eg(e,n,r)],l=[i];if(a.length%2!=0)throw new Ce(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<a.length;d+=2)o.push(Eg(e,a[d])),l.push(a[d+1]);const c=[],u=gn.empty();for(let d=o.length-1;d>=0;--d)if(!nI(c,o[d])){const p=o[d];let g=l[d];g=tr(g);const m=s.Nu(p);if(g instanceof bd)c.push(p);else{const _=uf(g,m);_!=null&&(c.push(p),u.set(p,_))}}const h=new Dn(c);return new Y4(u,h,s.fieldTransforms)}function Dz(t,e,r,n=!1){return uf(r,t.Qu(n?4:3,e))}function uf(t,e){if(rI(t=tr(t)))return $x("Unsupported field value:",e,t),tI(t,e);if(t instanceof Ux)return function(n,i){if(!Q4(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const a=[];let s=0;for(const o of n){let l=uf(o,i.Lu(s));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=tr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return NV(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=mr.fromDate(n);return{timestampValue:Ch(i.serializer,a)}}if(n instanceof mr){const a=new mr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ch(i.serializer,a)}}if(n instanceof zx)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Dl)return{bytesValue:v4(i.serializer,n._byteString)};if(n instanceof Tn){const a=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Cx(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Wx)return function(s,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Ax(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${kd(n)}`)}(t,e)}function tI(t,e){const r={};return GA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yo(t,(n,i)=>{const a=uf(i,e.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function rI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof mr||t instanceof zx||t instanceof Dl||t instanceof Tn||t instanceof Ux||t instanceof Wx)}function $x(t,e,r){if(!rI(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=kd(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Eg(t,e,r){if((e=tr(e))instanceof cf)return e._internalPath;if(typeof e=="string")return Gx(t,e);throw Fh("Field path arguments must be of type string or ",t,!1,void 0,r)}const Oz=new RegExp("[~\\*/\\[\\]]");function Gx(t,e,r){if(e.search(Oz)>=0)throw Fh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new cf(...e.split("."))._internalPath}catch{throw Fh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Fh(t,e,r,n,i){const a=n&&!n.isEmpty(),s=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=` in field ${n}`),s&&(l+=` in document ${i}`),l+=")"),new Ce(fe.INVALID_ARGUMENT,o+t+l)}function nI(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Lz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Cd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Lz extends iI{data(){return super.data()}}function Cd(t,e){return typeof e=="string"?Gx(t,e):e instanceof cf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ce(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qx{}class aI extends qx{}function Hr(t,e,...r){let n=[];e instanceof qx&&n.push(e),n=n.concat(r),function(a){const s=a.filter(l=>l instanceof Kx).length,o=a.filter(l=>l instanceof Nd).length;if(s>1||s>0&&o>0)throw new Ce(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Nd extends aI{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Nd(e,r,n)}_apply(e){const r=this._parse(e);return sI(e._query,r),new Eo(e.firestore,e.converter,hg(e._query,r))}_parse(e){const r=Id(e.firestore);return function(a,s,o,l,c,u,h){let d;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ce(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){c2(h,u);const p=[];for(const g of h)p.push(l2(l,a,g));d={arrayValue:{values:p}}}else d=l2(l,a,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||c2(h,u),d=Dz(o,s,h,u==="in"||u==="not-in");return cr.create(c,u,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ir(t,e,r){const n=e,i=Cd("where",t);return Nd._create(i,n,r)}class Kx extends qx{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Kx(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:pi.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,a){let s=i;const o=a.getFlattenedFilters();for(const l of o)sI(s,l),s=hg(s,l)}(e._query,r),new Eo(e.firestore,e.converter,hg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Xx extends aI{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Xx(e,r)}_apply(e){const r=function(i,a,s){if(i.startAt!==null)throw new Ce(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ce(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Lu(a,s)}(e._query,this._field,this._direction);return new Eo(e.firestore,e.converter,function(i,a){const s=i.explicitOrderBy.concat([a]);return new Hl(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function Yx(t,e="asc"){const r=e,n=Cd("orderBy",t);return Xx._create(n,r)}function l2(t,e,r){if(typeof(r=tr(r))=="string"){if(r==="")throw new Ce(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!t4(e)&&r.indexOf("/")!==-1)throw new Ce(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Rt.fromString(r));if(!Oe.isDocumentKey(n))throw new Ce(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Nw(t,new Oe(n))}if(r instanceof Tn)return Nw(t,r._key);throw new Ce(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kd(r)}.`)}function c2(t,e){if(!Array.isArray(t)||t.length===0)throw new Ce(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sI(t,e){const r=function(i,a){for(const s of i)for(const o of s.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ce(fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ce(fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class jz{convertValue(e,r="none"){switch(oo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(so(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw We()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return yo(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,i;const a=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(s=>Jt(s.doubleValue));return new Wx(a)}convertGeoPoint(e){return new zx(Jt(e.latitude),Jt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=wx(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Pu(e));default:return null}}convertTimestamp(e){const r=fs(e);return new mr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Rt.fromString(e);xt(T4(n));const i=new Du(n.get(1),n.get(3)),a=new Oe(n.popFirst(5));return i.isEqual(r)||fa(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lI extends iI{constructor(e,r,n,i,a,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new C0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Cd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class C0 extends lI{data(e={}){return super.data(e)}}class Bz{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Ac(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new C0(this._firestore,this._userDataWriter,n.key,n,new Ac(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ce(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const l=new C0(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ac(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new C0(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Ac(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:Vz(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Vz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return We()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t){t=Oi(t,Tn);const e=Oi(t.firestore,To);return Sz(Ad(e),t._key).then(r=>Uz(e,t,r))}class cI extends jz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,r)}}function sn(t){t=Oi(t,Eo);const e=Oi(t.firestore,To),r=Ad(e),n=new cI(e);return Mz(t._query),Az(r,t._query).then(i=>new Bz(e,n,t,i))}function fl(t,e,r,...n){t=Oi(t,Tn);const i=Oi(t.firestore,To),a=Id(i);let s;return s=typeof(e=tr(e))=="string"||e instanceof cf?eI(a,"updateDoc",t._key,e,r,n):Z4(a,"updateDoc",t._key,e),Rd(i,[s.toMutation(t._key,En.exists(!0))])}function Xc(t){return Rd(Oi(t.firestore,To),[new _d(t._key,En.none())])}function ns(t,e){const r=Oi(t.firestore,To),n=mn(t),i=oI(t.converter,e);return Rd(r,[J4(Id(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,En.exists(!1))]).then(()=>n)}function Rd(t,e){return function(n,i){const a=new na;return n.asyncQueue.enqueueAndForget(async()=>pz(await kz(n),i,a)),a.promise}(Ad(t),e)}function Uz(t,e,r){const n=r.docs.get(e._key),i=new cI(t);return new lI(t,i,e._key,n,new Ac(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Id(e)}set(e,r,n){this._verifyNotCommitted();const i=zp(e,this._firestore),a=oI(i.converter,r,n),s=J4(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,n);return this._mutations.push(s.toMutation(i._key,En.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const a=zp(e,this._firestore);let s;return s=typeof(r=tr(r))=="string"||r instanceof cf?eI(this._dataReader,"WriteBatch.update",a._key,r,n,i):Z4(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(s.toMutation(a._key,En.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=zp(e,this._firestore);return this._mutations=this._mutations.concat(new _d(r._key,En.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ce(fe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zp(t,e){if((t=tr(t)).firestore!==e)throw new Ce(fe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t){return Ad(t=Oi(t,To)),new zz(t,e=>Rd(t,e))}(function(e,r=!0){(function(i){Wl=i})(zl),Il(new io("firestore",(n,{instanceIdentifier:i,options:a})=>{const s=n.getProvider("app").getImmediate(),o=new To(new qB(n.getProvider("auth-internal")),new QB(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ce(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Du(c.options.projectId,u)}(s,i),s);return a=Object.assign({useFetchStreams:r},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),ts(Sw,"4.7.3",e),ts(Sw,"4.7.3","esm2017")})();function uI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Wz=uI,fI=new ef("auth","Firebase",uI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=new mx("@firebase/auth");function Hz(t,...e){Ph.logLevel<=rt.WARN&&Ph.warn(`Auth (${zl}): ${t}`,...e)}function N0(t,...e){Ph.logLevel<=rt.ERROR&&Ph.error(`Auth (${zl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t,...e){throw Qx(t,...e)}function Fi(t,...e){return Qx(t,...e)}function hI(t,e,r){const n=Object.assign(Object.assign({},Wz()),{[e]:r});return new ef("auth","Firebase",n).create(e,{appName:t.name})}function ia(t){return hI(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qx(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return fI.create(t,...e)}function Ve(t,e,...r){if(!t)throw Qx(e,...r)}function Yi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw N0(e),new Error(e)}function da(t,e){t||Yi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function dI(){return f2()==="http:"||f2()==="https:"}function f2(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $z(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dI()||Tj()||"connection"in navigator)?navigator.onLine:!0}function Gz(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,r){this.shortDelay=e,this.longDelay=r,da(r>e,"Short delay should be less than long delay!"),this.isMobile=yj()||kj()}get(){return $z()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t,e){da(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kz=new ff(3e4,6e4);function _a(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ya(t,e,r,n,i={}){return mI(t,i,async()=>{let a={},s={};n&&(e==="GET"?s=n:a={body:JSON.stringify(n)});const o=tf(Object.assign({key:t.config.apiKey},s)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},a);return Ej()||(c.referrerPolicy="no-referrer"),pI.fetch()(gI(t,t.config.apiHost,r,o),c)})}async function mI(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},qz),e);try{const i=new Yz(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw f0(t,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const o=a.ok?s.errorMessage:s.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw f0(t,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw f0(t,"email-already-in-use",s);if(l==="USER_DISABLED")throw f0(t,"user-disabled",s);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw hI(t,u,c);mi(t,u)}}catch(i){if(i instanceof xa)throw i;mi(t,"network-request-failed",{message:String(i)})}}async function hf(t,e,r,n,i={}){const a=await ya(t,e,r,n,i);return"mfaPendingCredential"in a&&mi(t,"multi-factor-auth-required",{_serverResponse:a}),a}function gI(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Jx(t.config,i):`${t.config.apiScheme}://${i}`}function Xz(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Yz{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Fi(this.auth,"network-request-failed")),Kz.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function f0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Fi(t,e,n);return i.customData._tokenResponse=r,i}function h2(t){return t!==void 0&&t.enterprise!==void 0}class Qz{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Xz(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Jz(t,e){return ya(t,"GET","/v2/recaptchaConfig",_a(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zz(t,e){return ya(t,"POST","/v1/accounts:delete",e)}async function vI(t,e){return ya(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eW(t,e=!1){const r=tr(t),n=await r.getIdToken(e),i=Zx(n);Ve(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,s=a==null?void 0:a.sign_in_provider;return{claims:i,token:n,authTime:Yc(Wp(i.auth_time)),issuedAtTime:Yc(Wp(i.iat)),expirationTime:Yc(Wp(i.exp)),signInProvider:s||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Wp(t){return Number(t)*1e3}function Zx(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return N0("JWT malformed, contained fewer than 3 sections"),null;try{const i=bA(r);return i?JSON.parse(i):(N0("Failed to decode base64 JWT payload"),null)}catch(i){return N0("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function d2(t){const e=Zx(t);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof xa&&tW(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function tW({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rW{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yc(this.lastLoginAt),this.creationTime=Yc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oh(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Bu(t,vI(r,{idToken:n}));Ve(i==null?void 0:i.users.length,r,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const s=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?xI(a.providerUserInfo):[],o=iW(t.providerData,s),l=t.isAnonymous,c=!(t.email&&a.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,h={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new kg(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function nW(t){const e=tr(t);await Oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iW(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function xI(t){return t.map(e=>{var{providerId:r}=e,n=Sv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aW(t,e){const r=await mI(t,{},async()=>{const n=tf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,s=gI(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",pI.fetch()(s,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function sW(t,e){return ya(t,"POST","/v2/accounts:revokeToken",_a(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):d2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const r=d2(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await aW(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,s=new hl;return n&&(Ve(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(Ve(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),a&&(Ve(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hl,this.toJSON())}_performRefresh(){return Yi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(t,e){Ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qi{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,a=Sv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new rW(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new kg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Bu(this,this.stsTokenManager.getToken(this.auth,e));return Ve(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return eW(this,e)}reload(){return nW(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Qi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Oh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ii(this.auth.app))return Promise.reject(ia(this.auth));const e=await this.getIdToken();return await Bu(this,Zz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,a,s,o,l,c,u;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,g=(s=r.photoURL)!==null&&s!==void 0?s:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=r.createdAt)!==null&&c!==void 0?c:void 0,T=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:w,emailVerified:R,isAnonymous:j,providerData:D,stsTokenManager:E}=r;Ve(w&&E,e,"internal-error");const S=hl.fromJSON(this.name,E);Ve(typeof w=="string",e,"internal-error"),Ia(h,e.name),Ia(d,e.name),Ve(typeof R=="boolean",e,"internal-error"),Ve(typeof j=="boolean",e,"internal-error"),Ia(p,e.name),Ia(g,e.name),Ia(m,e.name),Ia(_,e.name),Ia(y,e.name),Ia(T,e.name);const k=new Qi({uid:w,auth:e,email:d,emailVerified:R,displayName:h,isAnonymous:j,photoURL:g,phoneNumber:p,tenantId:m,stsTokenManager:S,createdAt:y,lastLoginAt:T});return D&&Array.isArray(D)&&(k.providerData=D.map(I=>Object.assign({},I))),_&&(k._redirectEventId=_),k}static async _fromIdTokenResponse(e,r,n=!1){const i=new hl;i.updateFromServerResponse(r);const a=new Qi({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Oh(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Ve(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?xI(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),o=new hl;o.updateFromIdToken(n);const l=new Qi({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new kg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2=new Map;function Ji(t){da(t instanceof Function,"Expected a class definition");let e=p2.get(t);return e?(da(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,p2.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}_I.type="NONE";const m2=_I;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(t,e,r){return`firebase:${t}:${e}:${r}`}class dl{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=R0(this.userKey,i.apiKey,a),this.fullPersistenceKey=R0("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Qi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new dl(Ji(m2),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=i[0]||Ji(m2);const s=R0(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(s);if(u){const h=Qi._fromJSON(e,u);c!==a&&(o=h),a=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new dl(a,e,n):(a=l[0],o&&await a._set(s,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(s)}catch{}})),new dl(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(TI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(SI(e))return"Blackberry";if(AI(e))return"Webos";if(wI(e))return"Safari";if((e.includes("chrome/")||EI(e))&&!e.includes("edge/"))return"Chrome";if(kI(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function yI(t=Zr()){return/firefox\//i.test(t)}function wI(t=Zr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function EI(t=Zr()){return/crios\//i.test(t)}function TI(t=Zr()){return/iemobile/i.test(t)}function kI(t=Zr()){return/android/i.test(t)}function SI(t=Zr()){return/blackberry/i.test(t)}function AI(t=Zr()){return/webos/i.test(t)}function e1(t=Zr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function oW(t=Zr()){var e;return e1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function lW(){return Sj()&&document.documentMode===10}function II(t=Zr()){return e1(t)||kI(t)||AI(t)||SI(t)||/windows phone/i.test(t)||TI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(t,e=[]){let r;switch(t){case"Browser":r=g2(Zr());break;case"Worker":r=`${g2(Zr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${zl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cW{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((s,o)=>{try{const l=e(a);s(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uW(t,e={}){return ya(t,"GET","/v2/passwordPolicy",_a(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW=6;class hW{constructor(e){var r,n,i,a;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=s.minPasswordLength)!==null&&r!==void 0?r:fW,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,a,s,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsUppercaseLetter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(s=l.containsNumericCharacter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dW{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new v2(this),this.idTokenSubscription=new v2(this),this.beforeStateQueue=new cW(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ji(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await dl.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await vI(this,{idToken:e}),n=await Qi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Ii(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===o)&&(l!=null&&l.user)&&(i=l.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Oh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Gz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ii(this.app))return Promise.reject(ia(this));const r=e?tr(e):null;return r&&Ve(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ii(this.app)?Promise.reject(ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ii(this.app)?Promise.reject(ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ji(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uW(this),r=new hW(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ef("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await sW(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ji(e)||this._popupRedirectResolver;Ve(r,this,"argument-error"),this.redirectPersistenceManager=await dl.create(this,[Ji(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(o,this,"internal-error"),o.then(()=>{s||a(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{s=!0,l()}}else{const l=e.addObserver(r);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Hz(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ko(t){return tr(t)}class v2{constructor(e){this.auth=e,this.observer=null,this.addObserver=Pj(r=>this.observer=r)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pW(t){Fd=t}function CI(t){return Fd.loadJS(t)}function mW(){return Fd.recaptchaEnterpriseScript}function gW(){return Fd.gapiScript}function vW(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const xW="recaptcha-enterprise",_W="NO_RECAPTCHA";class yW{constructor(e){this.type=xW,this.auth=ko(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(s,o)=>{Jz(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new Qz(l);return a.tenantId==null?a._agentRecaptchaConfig=c:a._tenantRecaptchaConfigs[a.tenantId]=c,s(c.siteKey)}}).catch(l=>{o(l)})})}function i(a,s,o){const l=window.grecaptcha;h2(l)?l.enterprise.ready(()=>{l.enterprise.execute(a,{action:e}).then(c=>{s(c)}).catch(()=>{s(_W)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,s)=>{n(this.auth).then(o=>{if(!r&&h2(window.grecaptcha))i(o,a,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let l=mW();l.length!==0&&(l+=o),CI(l).then(()=>{i(o,a,s)}).catch(c=>{s(c)})}}).catch(o=>{s(o)})})}}async function x2(t,e,r,n=!1){const i=new yW(t);let a;try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const s=Object.assign({},e);return n?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Sg(t,e,r,n){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await x2(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await x2(t,e,r,r==="getOobCode");return n(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wW(t,e){const r=vx(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Th(a,e??{}))return i;mi(i,"already-initialized")}return r.initialize({options:e})}function EW(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ji);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function TW(t,e,r){const n=ko(t);Ve(n._canInitEmulator,n,"emulator-config-failed"),Ve(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=NI(e),{host:s,port:o}=kW(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${a}//${s}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),SW()}function NI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function kW(t){const e=NI(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:_2(n.substr(a.length+1))}}else{const[a,s]=n.split(":");return{host:a,port:_2(s)}}}function _2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function SW(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Yi("not implemented")}_getIdTokenResponse(e){return Yi("not implemented")}_linkToIdToken(e,r){return Yi("not implemented")}_getReauthenticationResolver(e){return Yi("not implemented")}}async function AW(t,e){return ya(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IW(t,e){return hf(t,"POST","/v1/accounts:signInWithPassword",_a(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bW(t,e){return hf(t,"POST","/v1/accounts:signInWithEmailLink",_a(t,e))}async function CW(t,e){return hf(t,"POST","/v1/accounts:signInWithEmailLink",_a(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends t1{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Vu(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Vu(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sg(e,r,"signInWithPassword",IW);case"emailLink":return bW(e,{email:this._email,oobCode:this._password});default:mi(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sg(e,n,"signUpPassword",AW);case"emailLink":return CW(e,{idToken:r,email:this._email,oobCode:this._password});default:mi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pl(t,e){return hf(t,"POST","/v1/accounts:signInWithIdp",_a(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NW="http://localhost";class lo extends t1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new lo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):mi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,a=Sv(r,["providerId","signInMethod"]);if(!n||!i)return null;const s=new lo(n,i);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return pl(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,pl(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,pl(e,r)}buildRequest(){const e={requestUri:NW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=tf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RW(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function FW(t){const e=wc(Ec(t)).link,r=e?wc(Ec(e)).deep_link_id:null,n=wc(Ec(t)).deep_link_id;return(n?wc(Ec(n)).link:null)||n||r||e||t}class r1{constructor(e){var r,n,i,a,s,o;const l=wc(Ec(e)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,u=(n=l.oobCode)!==null&&n!==void 0?n:null,h=RW((i=l.mode)!==null&&i!==void 0?i:null);Ve(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=(a=l.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(s=l.languageCode)!==null&&s!==void 0?s:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const r=FW(e);try{return new r1(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(){this.providerId=ql.PROVIDER_ID}static credential(e,r){return Vu._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=r1.parseLink(r);return Ve(n,"argument-error"),Vu._fromEmailAndCode(e,n.code,n.tenantId)}}ql.PROVIDER_ID="password";ql.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ql.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df extends RI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da extends df{constructor(){super("facebook.com")}static credential(e){return lo._fromParams({providerId:Da.PROVIDER_ID,signInMethod:Da.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Da.credentialFromTaggedObject(e)}static credentialFromError(e){return Da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Da.credential(e.oauthAccessToken)}catch{return null}}}Da.FACEBOOK_SIGN_IN_METHOD="facebook.com";Da.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends df{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return lo._fromParams({providerId:Oa.PROVIDER_ID,signInMethod:Oa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Oa.credentialFromTaggedObject(e)}static credentialFromError(e){return Oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Oa.credential(r,n)}catch{return null}}}Oa.GOOGLE_SIGN_IN_METHOD="google.com";Oa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends df{constructor(){super("github.com")}static credential(e){return lo._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return La.credentialFromTaggedObject(e)}static credentialFromError(e){return La.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return La.credential(e.oauthAccessToken)}catch{return null}}}La.GITHUB_SIGN_IN_METHOD="github.com";La.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma extends df{constructor(){super("twitter.com")}static credential(e,r){return lo._fromParams({providerId:Ma.PROVIDER_ID,signInMethod:Ma.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ma.credentialFromTaggedObject(e)}static credentialFromError(e){return Ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ma.credential(r,n)}catch{return null}}}Ma.TWITTER_SIGN_IN_METHOD="twitter.com";Ma.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PW(t,e){return hf(t,"POST","/v1/accounts:signUp",_a(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Qi._fromIdTokenResponse(e,n,i),s=y2(n);return new co({user:a,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=y2(n);return new co({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function y2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends xa{constructor(e,r,n,i){var a;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Lh.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Lh(e,r,n,i)}}function FI(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Lh._fromErrorAndOperation(t,a,e,n):a})}async function DW(t,e,r=!1){const n=await Bu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return co._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OW(t,e,r=!1){const{auth:n}=t;if(Ii(n.app))return Promise.reject(ia(n));const i="reauthenticate";try{const a=await Bu(t,FI(n,i,e,t),r);Ve(a.idToken,n,"internal-error");const s=Zx(a.idToken);Ve(s,n,"internal-error");const{sub:o}=s;return Ve(t.uid===o,n,"user-mismatch"),co._forOperation(t,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&mi(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PI(t,e,r=!1){if(Ii(t.app))return Promise.reject(ia(t));const n="signIn",i=await FI(t,n,e),a=await co._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function LW(t,e){return PI(ko(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DI(t){const e=ko(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function MW(t,e,r){if(Ii(t.app))return Promise.reject(ia(t));const n=ko(t),s=await Sg(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",PW).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&DI(t),l}),o=await co._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(o.user),o}function jW(t,e,r){return Ii(t.app)?Promise.reject(ia(t)):LW(tr(t),ql.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&DI(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BW(t,e){return ya(t,"POST","/v1/accounts:createAuthUri",_a(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VW(t,e){const r=dI()?Dh():"http://localhost",n={identifier:e,continueUri:r},{signinMethods:i}=await BW(tr(t),n);return i||[]}function UW(t,e,r,n){return tr(t).onIdTokenChanged(e,r,n)}function zW(t,e,r){return tr(t).beforeAuthStateChanged(e,r)}function WW(t,e,r,n){return tr(t).onAuthStateChanged(e,r,n)}function HW(t){return tr(t).signOut()}const Mh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Mh,"1"),this.storage.removeItem(Mh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=1e3,GW=10;class LI extends OI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=II(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,o,l)=>{this.notifyListeners(s,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},a=this.storage.getItem(n);lW()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,GW):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},$W)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}LI.type="LOCAL";const qW=LI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI extends OI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}MI.type="SESSION";const jI=MI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KW(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Pd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,s=this.handlersMap[i];if(!(s!=null&&s.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async c=>c(r.origin,a)),l=await KW(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Pd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,s;return new Promise((o,l)=>{const c=n1("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(d.data.response);break;default:clearTimeout(u),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pi(){return window}function YW(t){Pi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BI(){return typeof Pi().WorkerGlobalScope<"u"&&typeof Pi().importScripts=="function"}async function QW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JW(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function ZW(){return BI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="firebaseLocalStorageDb",eH=1,jh="firebaseLocalStorage",UI="fbase_key";class pf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Dd(t,e){return t.transaction([jh],e?"readwrite":"readonly").objectStore(jh)}function tH(){const t=indexedDB.deleteDatabase(VI);return new pf(t).toPromise()}function Ag(){const t=indexedDB.open(VI,eH);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(jh,{keyPath:UI})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(jh)?e(n):(n.close(),await tH(),e(await Ag()))})})}async function w2(t,e,r){const n=Dd(t,!0).put({[UI]:e,value:r});return new pf(n).toPromise()}async function rH(t,e){const r=Dd(t,!1).get(e),n=await new pf(r).toPromise();return n===void 0?null:n.value}function E2(t,e){const r=Dd(t,!0).delete(e);return new pf(r).toPromise()}const nH=800,iH=3;class zI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ag(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>iH)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return BI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Pd._getInstance(ZW()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await QW(),!this.activeServiceWorker)return;this.sender=new XW(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ag();return await w2(e,Mh,"1"),await E2(e,Mh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>w2(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>rH(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>E2(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Dd(i,!1).getAll();return new pf(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nH)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zI.type="LOCAL";const aH=zI;new ff(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sH(t,e){return e?Ji(e):(Ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1 extends t1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pl(e,this._buildIdpRequest())}_linkToIdToken(e,r){return pl(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return pl(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function oH(t){return PI(t.auth,new i1(t),t.bypassAuthState)}function lH(t){const{auth:e,user:r}=t;return Ve(r,e,"internal-error"),OW(r,new i1(t),t.bypassAuthState)}async function cH(t){const{auth:e,user:r}=t;return Ve(r,e,"internal-error"),DW(r,new i1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:s,type:o}=e;if(s){this.reject(s);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return oH;case"linkViaPopup":case"linkViaRedirect":return cH;case"reauthViaPopup":case"reauthViaRedirect":return lH;default:mi(this.auth,"internal-error")}}resolve(e){da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uH=new ff(2e3,1e4);class Jo extends WI{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Jo.currentPopupAction&&Jo.currentPopupAction.cancel(),Jo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){da(this.filter.length===1,"Popup operations only handle one event");const e=n1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Fi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,uH.get())};e()}}Jo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fH="pendingRedirect",F0=new Map;class hH extends WI{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=F0.get(this.auth._key());if(!e){try{const n=await dH(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}F0.set(this.auth._key(),e)}return this.bypassAuthState||F0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dH(t,e){const r=gH(e),n=mH(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function pH(t,e){F0.set(t._key(),e)}function mH(t){return Ji(t._redirectPersistence)}function gH(t){return R0(fH,t.config.apiKey,t.name)}async function vH(t,e,r=!1){if(Ii(t.app))return Promise.reject(ia(t));const n=ko(t),i=sH(n,e),s=await new hH(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xH=10*60*1e3;class _H{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yH(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!HI(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Fi(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xH&&this.cachedEventUids.clear(),this.cachedEventUids.has(T2(e))}saveEventToCache(e){this.cachedEventUids.add(T2(e)),this.lastProcessedEventTime=Date.now()}}function T2(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function HI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function yH(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wH(t,e={}){return ya(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EH=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TH=/^https?/;async function kH(t){if(t.config.emulator)return;const{authorizedDomains:e}=await wH(t);for(const r of e)try{if(SH(r))return}catch{}mi(t,"unauthorized-domain")}function SH(t){const e=Dh(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!TH.test(r))return!1;if(EH.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AH=new ff(3e4,6e4);function k2(){const t=Pi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function IH(t){return new Promise((e,r)=>{var n,i,a;function s(){k2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{k2(),r(Fi(t,"network-request-failed"))},timeout:AH.get()})}if(!((i=(n=Pi().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((a=Pi().gapi)===null||a===void 0)&&a.load)s();else{const o=vW("iframefcb");return Pi()[o]=()=>{gapi.load?s():r(Fi(t,"network-request-failed"))},CI(`${gW()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw P0=null,e})}let P0=null;function bH(t){return P0=P0||IH(t),P0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CH=new ff(5e3,15e3),NH="__/auth/iframe",RH="emulator/auth/iframe",FH={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PH=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function DH(t){const e=t.config;Ve(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Jx(e,RH):`https://${t.config.authDomain}/${NH}`,n={apiKey:e.apiKey,appName:t.name,v:zl},i=PH.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${tf(n).slice(1)}`}async function OH(t){const e=await bH(t),r=Pi().gapi;return Ve(r,t,"internal-error"),e.open({where:document.body,url:DH(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FH,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const s=Fi(t,"network-request-failed"),o=Pi().setTimeout(()=>{a(s)},CH.get());function l(){Pi().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{a(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MH=500,jH=600,BH="_blank",VH="http://localhost";class S2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UH(t,e,r,n=MH,i=jH){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},LH),{width:n.toString(),height:i.toString(),top:a,left:s}),c=Zr().toLowerCase();r&&(o=EI(c)?BH:r),yI(c)&&(e=e||VH,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[p,g])=>`${d}${p}=${g},`,"");if(oW(c)&&o!=="_self")return zH(e||"",o),new S2(null);const h=window.open(e||"",o,u);Ve(h,t,"popup-blocked");try{h.focus()}catch{}return new S2(h)}function zH(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WH="__/auth/handler",HH="emulator/auth/handler",$H=encodeURIComponent("fac");async function A2(t,e,r,n,i,a){Ve(t.config.authDomain,t,"auth-domain-config-required"),Ve(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:zl,eventId:i};if(e instanceof RI){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",Fj(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))s[u]=h}if(e instanceof df){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(s.scopes=u.join(","))}t.tenantId&&(s.tid=t.tenantId);const o=s;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${$H}=${encodeURIComponent(l)}`:"";return`${GH(t)}?${tf(o).slice(1)}${c}`}function GH({config:t}){return t.emulator?Jx(t,HH):`https://${t.authDomain}/${WH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="webStorageSupport";class qH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jI,this._completeRedirectFn=vH,this._overrideRedirectResult=pH}async _openPopup(e,r,n,i){var a;da((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const s=await A2(e,r,n,Dh(),i);return UH(e,s,n1())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await A2(e,r,n,Dh(),i);return YW(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(da(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await OH(e),n=new _H(e);return r.register("authEvent",i=>(Ve(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Hp,{type:Hp},i=>{var a;const s=(a=i==null?void 0:i[0])===null||a===void 0?void 0:a[Hp];s!==void 0&&r(!!s),mi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=kH(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return II()||wI()||e1()}}const KH=qH;var I2="@firebase/auth",b2="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YH(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function QH(t){Il(new io("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Ve(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bI(t)},c=new dW(n,i,a,l);return EW(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Il(new io("auth-internal",e=>{const r=ko(e.getProvider("auth").getImmediate());return(n=>new XH(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ts(I2,b2,YH(t)),ts(I2,b2,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JH=5*60,ZH=RA("authIdTokenMaxAge")||JH;let C2=null;const e$=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>ZH)return;const i=r==null?void 0:r.token;C2!==i&&(C2=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function t$(t=OA()){const e=vx(t,"auth");if(e.isInitialized())return e.getImmediate();const r=wW(t,{popupRedirectResolver:KH,persistence:[aH,qW,jI]}),n=RA("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const s=e$(a.toString());zW(r,s,()=>s(r.currentUser)),UW(r,o=>s(o))}}const i=CA("auth");return i&&TW(r,`http://${i}`),r}function r$(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}pW({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=Fi("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",r$().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});QH("Browser");const n$={apiKey:"AIzaSyBIeVS6j5EmN80XPVnAh2LdZ141qz2crjg",authDomain:"dswd-83cc6.firebaseapp.com",projectId:"dswd-83cc6",storageBucket:"dswd-83cc6.firebasestorage.app",messagingSenderId:"302017629484",appId:"1:302017629484:web:30e5e9c346e45db6f03089"},$I=DA(n$),Qe=Cz($I),Ic=t$($I),i$=Lt(Qe,"beneficiaries");Hr(i$,Ir("form_link_id","==",""),Yx("created_at","desc"));const a$={january:"01",february:"02",march:"03",april:"04",may:"05",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"},ba=[{key:"last_name",label:"Last Name"},{key:"first_name",label:"First Name"},{key:"middle_name",label:"Middle Name"},{key:"extension_name",label:"Extension Name"},{key:"birth_month",label:"Birth Month"},{key:"birth_day",label:"Birth Day"},{key:"birth_year",label:"Birth Year"},{key:"sex",label:"Sex"},{key:"barangay",label:"Barangay"},{key:"psgc_city",label:"PSGC City"},{key:"city",label:"City"},{key:"province",label:"Province"},{key:"type_of_assistance",label:"Type of Assistance"},{key:"amount",label:"Amount"},{key:"philsys_number",label:"PhilSys Number"},{key:"beneficiary_uniq",label:"Beneficiary ID"},{key:"contact_number",label:"Contact Number"},{key:"target_sector",label:"Target Sector"},{key:"sub_category",label:"Sub Category"},{key:"civil_status",label:"Civil Status"}],N2=t=>ba.every(({key:e})=>{const r=t[e];return r==null||r===""||r===0}),h0=t=>{if(!t)return"";const e=t.toLowerCase().trim();return/^([1-9]|1[0-2])$/.test(e)?e.padStart(2,"0"):isNaN(Number(e))&&a$[e]||e};function s$({teamId:t}){const[e,r]=X.useState([]),[n,i]=X.useState(!0),[a,s]=X.useState(null),[o,l]=X.useState({column:"",direction:null}),[c,u]=X.useState(!1),[h,d]=X.useState(new Set),[p,g]=X.useState(null),[m,_]=X.useState(null),[y,T]=X.useState({}),[w,R]=X.useState("");X.useEffect(()=>{t?j():(r([]),i(!1))},[t]);const j=async()=>{if(t)try{i(!0);const P=Lt(Qe,"beneficiaries"),Q=Hr(P,Ir("team_id","==",t)),O=(await sn(Q)).docs.map(q=>({...q.data(),docId:q.id})).filter(q=>!N2(q));r(O),s(null)}catch(P){s("Failed to load beneficiaries"),console.error("Load error:",P)}finally{i(!1)}},D=e.filter(P=>w.trim()?ba.some(({key:Q})=>{const re=P[Q];return re&&re.toString().toLowerCase().includes(w.toLowerCase())}):!0),E=async()=>{if(t&&window.confirm("Are you sure you want to clear all beneficiary data for this team? This action cannot be undone.")){u(!0),s(null);try{const P=Lt(Qe,"beneficiaries"),Q=Hr(P,Ir("team_id","==",t)),re=await sn(Q),O=500,q=re.docs;for(let H=0;H<q.length;H+=O){const G=q.slice(H,Math.min(q.length,H+O));await Promise.all(G.map(K=>Xc(K.ref)))}r([]),l({column:"",direction:null})}catch(P){s("Failed to clear data"),console.error("Clear error:",P)}finally{u(!1)}}},S=()=>{const P=e.reduce((Q,re)=>{const O=[re.last_name,re.first_name,re.middle_name,re.birth_month,re.birth_day,re.birth_year].map(q=>String(q||"").toLowerCase()).join("|");return Q[O]||(Q[O]=[]),Q[O].push(re),Q},{});return Object.values(P).filter(Q=>Q.length>1)},k=async()=>{const P=S();if(P.length===0){alert("No duplicates found!");return}const Q=P.reduce((re,O)=>re+(O.length-1),0);if(window.confirm(`Found ${Q} duplicate entries. Do you want to remove them?`)){i(!0),s(null);try{for(const re of P){const O=re.slice(1);for(const q of O){const H=q.docId;H&&await Xc(mn(Qe,"beneficiaries",H))}}await j(),alert("Duplicates removed successfully!")}catch(re){s("Failed to remove duplicates"),console.error("Remove duplicates error:",re)}finally{i(!1)}}},I=P=>{const Q=o.column===P&&o.direction==="asc"?"desc":o.column===P&&o.direction==="desc"?null:"asc";if(l({column:P,direction:Q}),!Q){j();return}const re=[...e].sort((O,q)=>{let H=O[P],G=q[P];return P==="birth_month"?(H=h0(H),G=h0(G)):P==="amount"?(H=Number(H)||0,G=Number(G)||0):(H=String(H||"").toLowerCase(),G=String(G||"").toLowerCase()),Q==="asc"?H<G?-1:H>G?1:0:G<H?-1:G>H?1:0});r(re)},b=()=>{const P=e.filter(q=>!N2(q)).map(q=>{const H={};return ba.forEach(({key:G,label:K})=>{var ne;G==="amount"&&q[G]?H[K]=`${(ne=q[G])==null?void 0:ne.toLocaleString()}`:G==="birth_month"?H[K]=h0(q[G]):H[K]=q[G]||""}),H}),Q=cl.json_to_sheet(P),re=ba.map(()=>({wch:15}));Q["!cols"]=re;const O=cl.book_new();cl.book_append_sheet(O,Q,"Beneficiaries"),Y7(O,"beneficiaries.xlsx")},N=P=>{d(Q=>{const re=new Set(Q);return re.has(P)?re.delete(P):re.add(P),re})},F=()=>{h.size===D.length?d(new Set):d(new Set(D.map(P=>P.docId)))},he=async()=>{if(h.size!==0&&window.confirm(`Are you sure you want to delete ${h.size} selected records?`)){i(!0),s(null);try{await Promise.all(Array.from(h).map(P=>Xc(mn(Qe,"beneficiaries",P)))),await j(),d(new Set),alert("Selected records deleted successfully!")}catch(P){s("Failed to delete selected records"),console.error("Delete error:",P)}finally{i(!1)}}},de=P=>{const Q=e.find(re=>re.docId===P);Q&&(T({...Q}),_(P),g("single"))},Ae=()=>{if(h.size===0){alert("Please select rows to edit");return}g("mass"),T({})},ve=async()=>{i(!0),s(null);try{p==="single"&&m?await fl(mn(Qe,"beneficiaries",m),y):p==="mass"&&await Promise.all(Array.from(h).map(P=>fl(mn(Qe,"beneficiaries",P),y))),await j(),g(null),_(null),T({}),d(new Set)}catch(P){s("Failed to save changes"),console.error("Save error:",P)}finally{i(!1)}},le=()=>{g(null),_(null),T({})};return n?x.jsx("div",{className:"flex items-center justify-center h-64",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a?x.jsx("div",{className:"p-4 bg-red-50 text-red-700 rounded-md",children:a}):x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Beneficiary List"}),x.jsxs("div",{className:"flex gap-2",children:[h.size>0&&x.jsxs(x.Fragment,{children:[x.jsxs("button",{onClick:Ae,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[x.jsx(oh,{className:"w-4 h-4 mr-2"}),"Edit Selected (",h.size,")"]}),x.jsxs("button",{onClick:he,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:[x.jsx(gu,{className:"w-4 h-4 mr-2"}),"Delete Selected (",h.size,")"]})]}),x.jsxs("button",{onClick:k,disabled:n||e.length===0,className:"flex items-center px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x.jsx(dk,{className:"w-4 h-4 mr-2"}),"Remove Duplicates"]}),x.jsxs("button",{onClick:E,disabled:c||e.length===0,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x.jsx(gu,{className:"w-4 h-4 mr-2"}),c?"Clearing...":"Clear Data"]}),x.jsxs("button",{onClick:b,disabled:e.length===0,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x.jsx(JR,{className:"w-4 h-4 mr-2"}),"Export to Excel"]})]})]}),x.jsx("div",{className:"mb-4",children:x.jsx("input",{type:"text",placeholder:"Search beneficiaries...",value:w,onChange:P=>R(P.target.value),className:"px-4 py-2 border rounded-md w-full"})}),p==="mass"&&x.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[x.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Mass Edit ",h.size," Records"]}),x.jsx("div",{className:"grid grid-cols-4 gap-4 mb-4",children:ba.map(({key:P,label:Q})=>x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:Q}),x.jsx("input",{type:P==="amount"?"number":"text",value:y[P]||"",onChange:re=>T({...y,[P]:re.target.value}),className:"w-full px-3 py-2 border rounded-md",placeholder:"Leave blank to keep unchanged"})]},P))}),x.jsxs("div",{className:"flex justify-end gap-2",children:[x.jsxs("button",{onClick:le,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:[x.jsx(vu,{className:"w-4 h-4 mr-2 inline"}),"Cancel"]}),x.jsxs("button",{onClick:ve,className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700",children:[x.jsx(mu,{className:"w-4 h-4 mr-2 inline"}),"Save Changes"]})]})]}),x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[x.jsx("thead",{className:"bg-gray-50",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"#"}),x.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:x.jsx("div",{className:"flex items-center",children:x.jsx("input",{type:"checkbox",checked:D.length>0&&h.size===D.length,onChange:F,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"})})}),x.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"}),ba.map(({key:P,label:Q})=>x.jsx("th",{onClick:()=>I(P),className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 group",children:x.jsxs("div",{className:"flex items-center space-x-1",children:[x.jsx("span",{children:Q}),x.jsxs("span",{className:"text-gray-400",children:[o.column===P&&o.direction==="asc"&&x.jsx(Va,{className:"w-4 h-4"}),o.column===P&&o.direction==="desc"&&x.jsx(Ms,{className:"w-4 h-4"}),(o.column!==P||!o.direction)&&x.jsx("span",{className:"opacity-0 group-hover:opacity-100",children:x.jsx(Va,{className:"w-4 h-4"})})]})]})},Q))]})}),x.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.length===0?x.jsx("tr",{children:x.jsx("td",{colSpan:ba.length+3,className:"px-3 py-2 text-center",children:"No matching records found."})}):D.map((P,Q)=>x.jsxs("tr",{className:`hover:bg-gray-50 ${h.has(P.docId)?"bg-blue-50":""}`,children:[x.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:Q+1}),x.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:x.jsx("input",{type:"checkbox",checked:h.has(P.docId),onChange:()=>N(P.docId),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"})}),x.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:m===P.docId?x.jsxs("div",{className:"flex space-x-2",children:[x.jsx("button",{onClick:ve,className:"text-green-600 hover:text-green-800",children:x.jsx(mu,{className:"w-4 h-4"})}),x.jsx("button",{onClick:le,className:"text-gray-600 hover:text-gray-800",children:x.jsx(vu,{className:"w-4 h-4"})})]}):x.jsx("button",{onClick:()=>de(P.docId),className:"text-blue-600 hover:text-blue-800",children:x.jsx(oh,{className:"w-4 h-4"})})}),ba.map(({key:re})=>{var O;return x.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:m===P.docId?x.jsx("input",{type:re==="amount"?"number":"text",value:y[re]||"",onChange:q=>T({...y,[re]:q.target.value}),className:"w-full px-2 py-1 border rounded"}):re==="amount"&&P[re]?`${(O=P[re])==null?void 0:O.toLocaleString()}`:re==="birth_month"?h0(P[re]):P[re]||""},re)})]},P.beneficiary_uniq||Q))})]})})]})}const GI=X.createContext(null),mf=()=>{const t=X.useContext(GI);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},o$=({children:t})=>{const[e,r]=X.useState(null),[n,i]=X.useState(!0);X.useEffect(()=>WW(Ic,u=>{r(u),i(!1)}),[]);const l={currentUser:e,loading:n,signIn:async(c,u)=>(await jW(Ic,c,u)).user,signUp:async(c,u)=>(await MW(Ic,c,u)).user,signOut:()=>HW(Ic)};return x.jsx(GI.Provider,{value:l,children:!n&&t})},qI=X.createContext(null),So=()=>{const t=X.useContext(qI);if(!t)throw new Error("useTeam must be used within a TeamProvider");return t},l$=({children:t})=>{const{currentUser:e}=mf(),[r,n]=X.useState([]),[i,a]=X.useState(null),[s,o]=X.useState([]),[l,c]=X.useState([]),[u,h]=X.useState(!0);X.useEffect(()=>{(async()=>{var S;if(!e){n([]),a(null),o([]),c([]),h(!1);return}try{h(!0);const k=Hr(Lt(Qe,"team_members"),Ir("userId","==",e.uid)),I=Hr(Lt(Qe,"team_members"),Ir("email","==",(S=e.email)==null?void 0:S.toLowerCase())),[b,N]=await Promise.all([sn(k),sn(I)]),F=[...b.docs,...N.docs],he=Array.from(new Set(F.map(re=>re.data().teamId))),de=N.docs.filter(re=>re.data().pending===!0).map(re=>({id:re.id,...re.data()}));if(c(de),he.length===0){n([]),a(null),o([]),h(!1);return}const Ae=Hr(Lt(Qe,"teams"),Ir("__name__","in",he)),le=(await sn(Ae)).docs.map(re=>({id:re.id,...re.data()}));n(le);const P=localStorage.getItem("currentTeamId"),Q=P&&le.find(re=>re.id===P)||le[0];Q&&(a(Q),localStorage.setItem("currentTeamId",Q.id),await d(Q.id))}catch(k){console.error("Error loading teams:",k)}finally{h(!1)}})()},[e]);const d=async E=>{try{const S=Hr(Lt(Qe,"team_members"),Ir("teamId","==",E)),I=(await sn(S)).docs.map(b=>({id:b.id,...b.data()}));o(I)}catch(S){console.error("Error loading team members:",S)}},D={teams:r,currentTeam:i,teamMembers:s,loading:u,createTeam:async(E,S)=>{if(!e)throw new Error("User not authenticated");try{const k=await ns(Lt(Qe,"teams"),{name:E,description:S,createdAt:new Date});await ns(Lt(Qe,"team_members"),{teamId:k.id,userId:e.uid,role:"admin",email:e.email,createdAt:new Date});const I={id:k.id,name:E,description:S};return n(b=>[...b,I]),a(I),localStorage.setItem("currentTeamId",I.id),await d(I.id),I}catch(k){throw console.error("Error creating team:",k),k}},updateTeam:async(E,S,k)=>{try{const I=mn(Qe,"teams",E);await fl(I,{name:S,description:k}),n(b=>b.map(N=>N.id===E?{...N,name:S,description:k}:N)),(i==null?void 0:i.id)===E&&a(b=>b?{...b,name:S,description:k}:null)}catch(I){throw console.error("Error updating team:",I),I}},deleteTeam:async E=>{try{if(await Xc(mn(Qe,"teams",E)),n(S=>S.filter(k=>k.id!==E)),(i==null?void 0:i.id)===E){const S=r.find(k=>k.id!==E)||null;a(S),S?(localStorage.setItem("currentTeamId",S.id),await d(S.id)):(localStorage.removeItem("currentTeamId"),o([]))}}catch(S){throw console.error("Error deleting team:",S),S}},selectTeam:async E=>{const S=r.find(k=>k.id===E);S&&(a(S),localStorage.setItem("currentTeamId",S.id),await d(S.id))},addTeamMember:async(E,S,k)=>{try{const I=Hr(Lt(Qe,"team_members"),Ir("teamId","==",E),Ir("email","==",S.toLowerCase()));if(!(await sn(I)).empty)throw new Error("This user is already a member of this team.");const N=Hr(Lt(Qe,"users"),Ir("email","==",S.toLowerCase())),F=await sn(N);let he="";F.empty||(he=F.docs[0].id),await ns(Lt(Qe,"team_members"),{teamId:E,email:S.toLowerCase(),userId:he,role:k,createdAt:new Date,pending:he===""}),await d(E)}catch(I){throw console.error("Error adding team member:",I),I}},removeTeamMember:async E=>{try{await Xc(mn(Qe,"team_members",E)),o(S=>S.filter(k=>k.id!==E))}catch(S){throw console.error("Error removing team member:",S),S}},updateTeamMemberRole:async(E,S)=>{try{const k=mn(Qe,"team_members",E);await fl(k,{role:S}),o(I=>I.map(b=>b.id===E?{...b,role:S}:b))}catch(k){throw console.error("Error updating team member role:",k),k}},checkUserExists:async E=>{try{const S=Hr(Lt(Qe,"users"),Ir("email","==",E.toLowerCase()));if(!(await sn(S)).empty)return!0;const I=Hr(Lt(Qe,"team_members"),Ir("email","==",E.toLowerCase()));if(!(await sn(I)).empty)return!0;try{if((await VW(Ic,E)).length>0)return!0}catch(N){console.log("Auth check failed, continuing with other checks:",N)}return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?(console.log("Development mode: allowing all emails for testing"),!0):!1}catch(S){return console.error("Error checking if user exists:",S),!0}},acceptTeamInvitation:async E=>{if(!e)throw new Error("User not authenticated");try{const S=mn(Qe,"team_members",E);await fl(S,{userId:e.uid,pending:!1}),c(I=>I.filter(b=>b.id!==E));const k=await Tg(S);if(k.exists()){const I=k.data().teamId,b=await Tg(mn(Qe,"teams",I));if(b.exists()){const N={id:b.id,...b.data()};n(F=>F.some(he=>he.id===I)?F:[...F,N])}}}catch(S){throw console.error("Error accepting team invitation:",S),S}},pendingInvitations:l};return x.jsx(qI.Provider,{value:D,children:t})};function c$({onToggleForm:t}){const[e,r]=X.useState(""),[n,i]=X.useState(""),[a,s]=X.useState(null),[o,l]=X.useState(!1),{signIn:c}=mf(),u=async h=>{if(h.preventDefault(),!e||!n){s("Please enter both email and password");return}try{s(null),l(!0),await c(e,n)}catch(d){s(d.message||"Failed to sign in"),console.error("Login error:",d)}finally{l(!1)}};return x.jsxs("div",{className:"w-full max-w-md",children:[x.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Sign In"}),a&&x.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-md mb-4",children:a}),x.jsxs("form",{onSubmit:u,className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),x.jsx("input",{id:"email",type:"email",value:e,onChange:h=>r(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"your@email.com",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),x.jsx("input",{id:"password",type:"password",value:n,onChange:h=>i(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"",required:!0})]}),x.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:o?"Signing in...":"Sign In"})]}),x.jsx("div",{className:"mt-4 text-center",children:x.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",x.jsx("button",{onClick:t,className:"text-blue-600 hover:text-blue-800 font-medium",children:"Sign Up"})]})})]})}function u$({onToggleForm:t}){const[e,r]=X.useState(""),[n,i]=X.useState(""),[a,s]=X.useState(""),[o,l]=X.useState(null),[c,u]=X.useState(!1),{signUp:h}=mf(),d=async p=>{if(p.preventDefault(),!e||!n){l("Please enter both email and password");return}if(n!==a){l("Passwords do not match");return}if(n.length<6){l("Password must be at least 6 characters");return}try{l(null),u(!0),await h(e,n)}catch(g){l(g.message||"Failed to create account"),console.error("Registration error:",g)}finally{u(!1)}};return x.jsxs("div",{className:"w-full max-w-md",children:[x.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Create Account"}),o&&x.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-md mb-4",children:o}),x.jsxs("form",{onSubmit:d,className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),x.jsx("input",{id:"email",type:"email",value:e,onChange:p=>r(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"your@email.com",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),x.jsx("input",{id:"password",type:"password",value:n,onChange:p=>i(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),x.jsx("input",{id:"confirm-password",type:"password",value:a,onChange:p=>s(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"",required:!0})]}),x.jsx("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:c?"Creating Account...":"Sign Up"})]}),x.jsx("div",{className:"mt-4 text-center",children:x.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",x.jsx("button",{onClick:t,className:"text-blue-600 hover:text-blue-800 font-medium",children:"Sign In"})]})})]})}function f$(){const[t,e]=X.useState(!0),r=()=>{e(!t)};return x.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[x.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[x.jsx("h1",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Beneficiary Data Management"}),x.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Team-based system for managing beneficiary data"})]}),x.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:x.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:t?x.jsx(c$,{onToggleForm:r}):x.jsx(u$,{onToggleForm:r})})})]})}function h$({children:t}){const{currentUser:e,loading:r}=mf();return r?x.jsx("div",{className:"min-h-screen flex items-center justify-center",children:x.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e?x.jsx(x.Fragment,{children:t}):x.jsx(f$,{})}function d$({onCreateTeamClick:t}){const{teams:e,currentTeam:r,selectTeam:n}=So(),[i,a]=X.useState(!1),s=()=>a(!i),o=l=>{n(l),a(!1)};return x.jsxs("div",{className:"relative",children:[x.jsxs("button",{onClick:s,className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md","aria-expanded":i,children:[x.jsx(lh,{className:"w-5 h-5 text-gray-500"}),x.jsx("span",{className:"max-w-[150px] truncate",children:r?r.name:"Select Team"}),x.jsx(Ms,{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`})]}),i&&x.jsx("div",{className:"absolute left-0 mt-1 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:x.jsxs("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[e.map(l=>x.jsx("button",{onClick:()=>o(l.id),className:`block w-full text-left px-4 py-2 text-sm ${(r==null?void 0:r.id)===l.id?"bg-gray-100 text-gray-900":"text-gray-700 hover:bg-gray-50"}`,role:"menuitem",children:l.name},l.id)),x.jsx("div",{className:"border-t border-gray-100 my-1"}),x.jsxs("button",{onClick:()=>{t(),a(!1)},className:"block w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-gray-50 flex items-center",role:"menuitem",children:[x.jsx(n3,{className:"w-4 h-4 mr-2"}),"Create New Team"]})]})})]})}function p$({isOpen:t,onClose:e}){const[r,n]=X.useState(""),[i,a]=X.useState(""),[s,o]=X.useState(null),[l,c]=X.useState(!1),{createTeam:u}=So(),h=async d=>{if(d.preventDefault(),!r.trim()){o("Team name is required");return}try{o(null),c(!0),await u(r.trim(),i.trim()||void 0),n(""),a(""),e()}catch(p){o(p.message||"Failed to create team"),console.error("Create team error:",p)}finally{c(!1)}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Create New Team"}),x.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-500",children:x.jsx(vu,{className:"w-5 h-5"})})]}),s&&x.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-md mb-4",children:s}),x.jsxs("form",{onSubmit:h,className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"team-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Team Name*"}),x.jsx("input",{id:"team-name",type:"text",value:r,onChange:d=>n(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter team name",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"team-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),x.jsx("textarea",{id:"team-description",value:i,onChange:d=>a(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter team description",rows:3})]}),x.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[x.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),x.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:l?"Creating...":"Create Team"})]})]})]})}):null}function m$(){const{teamMembers:t,currentTeam:e,addTeamMember:r,removeTeamMember:n,updateTeamMemberRole:i,checkUserExists:a,teams:s}=So(),[o,l]=X.useState(""),[c,u]=X.useState("member"),[h,d]=X.useState(null),[p,g]=X.useState(null),[m,_]=X.useState(!1),[y,T]=X.useState(!1),[w,R]=X.useState(null),j=async k=>{const I=k.target.value;if(l(I),d(null),g(null),!I||!I.includes("@")||I.length<5){R(null);return}const b=setTimeout(async()=>{try{T(!0);const N=await a(I);R(N),d(null)}catch(N){console.error("Error verifying email:",N)}finally{T(!1)}},500);return()=>clearTimeout(b)},D=async k=>{if(k.preventDefault(),!e){d("No team selected");return}if(!o.trim()){d("Email is required");return}try{d(null),g(null),_(!0),await r(e.id,o.trim(),c),l(""),u("member"),R(null),g(`Successfully added ${o.trim()} to the team.`)}catch(I){d(I.message||"Failed to add team member"),console.error("Add member error:",I)}finally{_(!1)}},E=async(k,I)=>{if(confirm(`Are you sure you want to remove ${I} from this team?`))try{_(!0),await n(k),g(`Successfully removed ${I} from the team.`)}catch(b){d(b.message||"Failed to remove team member"),console.error("Remove member error:",b)}finally{_(!1)}},S=async(k,I,b)=>{try{_(!0),await i(k,I),g(`Successfully updated ${b}'s role to ${I}.`)}catch(N){d(N.message||"Failed to update role"),console.error("Update role error:",N)}finally{_(!1)}};return e?x.jsx("div",{className:"space-y-6",children:x.jsxs("div",{children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Team Members"}),h&&x.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-md mb-4",children:h}),p&&x.jsx("div",{className:"bg-green-50 text-green-700 p-3 rounded-md mb-4",children:p}),x.jsxs("form",{onSubmit:D,className:"flex flex-col sm:flex-row gap-3 mb-6",children:[x.jsxs("div",{className:"flex-1 relative",children:[x.jsx("input",{type:"email",value:o,onChange:j,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${w===!0?"border-green-300 focus:ring-green-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Email address",required:!0,disabled:m}),y&&x.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:x.jsx(ny,{className:"w-4 h-4 animate-spin text-gray-400"})}),w===!0&&!y&&x.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:x.jsx(iy,{className:"w-4 h-4 text-green-500"})})]}),x.jsxs("select",{value:c,onChange:k=>u(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:m,children:[x.jsx("option",{value:"member",children:"Member"}),x.jsx("option",{value:"admin",children:"Admin"})]}),x.jsx("button",{type:"submit",disabled:m||y,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:m?x.jsxs(x.Fragment,{children:[x.jsx(ny,{className:"w-4 h-4 mr-2 animate-spin"}),"Adding..."]}):x.jsxs(x.Fragment,{children:[x.jsx(gk,{className:"w-4 h-4 mr-2"}),"Add Member"]})})]}),x.jsx("div",{className:"mb-4 p-3 bg-blue-50 text-blue-700 rounded-md",children:x.jsxs("p",{className:"text-sm",children:[x.jsx("strong",{children:"Note:"})," Enter the email address of the person you want to add to your team. They will be able to access this team once added."]})}),t.length===0?x.jsx("p",{className:"text-gray-500 text-center py-4",children:"No team members yet."}):x.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:x.jsx("ul",{className:"divide-y divide-gray-200",children:t.map(k=>{var I,b;return x.jsx("li",{className:"px-4 py-4 sm:px-6",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-gray-200 rounded-full flex items-center justify-center",children:x.jsx("span",{className:"text-gray-500 font-medium",children:((I=k.email)==null?void 0:I.charAt(0).toUpperCase())||"U"})}),x.jsxs("div",{className:"ml-4",children:[x.jsx("div",{className:"text-sm font-medium text-gray-900",children:k.email||"Pending User"}),x.jsxs("div",{className:"flex text-sm text-gray-500",children:[x.jsx("span",{className:"mr-2",children:k.role.charAt(0).toUpperCase()+k.role.slice(1)}),k.teamId&&x.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full",children:((b=s.find(N=>N.id===k.teamId))==null?void 0:b.name)||"Unknown Team"})]})]})]}),x.jsxs("div",{className:"flex space-x-2",children:[k.role==="member"?x.jsx("button",{onClick:()=>S(k.id,"admin",k.email||""),className:"text-blue-600 hover:text-blue-800 disabled:opacity-50",title:"Make admin",disabled:m,children:x.jsx(iy,{className:"w-5 h-5"})}):x.jsx("button",{onClick:()=>S(k.id,"member",k.email||""),className:"text-yellow-600 hover:text-yellow-800 disabled:opacity-50",title:"Make member",disabled:m,children:x.jsx(a3,{className:"w-5 h-5"})}),x.jsx("button",{onClick:()=>E(k.id,k.email||""),className:"text-red-600 hover:text-red-800 disabled:opacity-50",title:"Remove member",disabled:m,children:x.jsx(gu,{className:"w-5 h-5"})})]})]})},k.id)})})})]})}):x.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-700 rounded-md",children:"Please select or create a team to manage members."})}const dc=[{key:"last_name",label:"Last Name"},{key:"first_name",label:"First Name"},{key:"middle_name",label:"Middle Name"},{key:"extension_name",label:"Extension Name"},{key:"birth_month",label:"Birth Month"},{key:"birth_day",label:"Birth Day"},{key:"birth_year",label:"Birth Year"},{key:"sex",label:"Sex"},{key:"civil_status",label:"Civil Status"},{key:"contact_number",label:"Contact Number"},{key:"barangay",label:"Barangay"},{key:"city",label:"City"},{key:"province",label:"Province"},{key:"type_of_assistance",label:"Type of Assistance"},{key:"amount",label:"Amount"},{key:"philsys_number",label:"PhilSys Number"},{key:"beneficiary_uniq",label:"Beneficiary ID"},{key:"target_sector",label:"Target Sector"},{key:"sub_category",label:"Sub Category"}];function g$(){const{currentTeam:t}=So(),[e,r]=X.useState("links"),[n,i]=X.useState([]),[a,s]=X.useState(!0),[o,l]=X.useState(null),[c,u]=X.useState(""),[h,d]=X.useState(null),[p,g]=X.useState(null),[m,_]=X.useState([]),[y,T]=X.useState(new Set),[w,R]=X.useState(""),[j,D]=X.useState(null),[E,S]=X.useState(new Set(dc.map(K=>K.key))),[k,I]=X.useState(new Set),[b,N]=X.useState(!1);X.useEffect(()=>{t&&F()},[t]),X.useEffect(()=>{p&&ve(p)},[p]);const F=async()=>{if(t)try{s(!0);const K=Hr(Lt(Qe,"form_links"),Ir("team_id","==",t.id),Yx("created_at","desc")),ne=await sn(K),ae=await Promise.all(ne.docs.map(async ue=>{const ce=ue.data(),De=Hr(Lt(Qe,"form_submissions"),Ir("form_link_id","==",ue.id)),W=await sn(De);return{id:ue.id,...ce,created_at:ce.created_at.toDate(),submissions_count:W.size}}));i(ae)}catch(K){console.error("Error loading form links:",K),l("Failed to load form links")}finally{s(!1)}},he=async K=>{if(K.preventDefault(),!(!t||!c.trim()))try{s(!0),await ns(Lt(Qe,"form_links"),{name:c.trim(),team_id:t.id,created_at:new Date}),u(""),await F()}catch(ne){console.error("Error creating form link:",ne),l("Failed to create form link")}finally{s(!1)}},de=async K=>{if(confirm("Are you sure you want to delete this form link? This will also delete all submissions associated with this link."))try{s(!0);const ne=Hr(Lt(Qe,"form_submissions"),Ir("form_link_id","==",K)),ae=await sn(ne),ue=u2(Qe);ae.docs.forEach(ce=>{ue.delete(ce.ref)}),ue.delete(mn(Qe,"form_links",K)),await ue.commit(),p===K&&(g(null),_([])),await F()}catch(ne){console.error("Error deleting form link:",ne),l("Failed to delete form link and its submissions")}finally{s(!1)}},Ae=async K=>{const ne=`${window.location.origin}/apply/${t==null?void 0:t.id}/${K}`;try{await navigator.clipboard.writeText(ne),d(K),setTimeout(()=>d(null),2e3)}catch(ae){console.error("Failed to copy:",ae)}},ve=async K=>{try{s(!0);const ne=Hr(Lt(Qe,"form_submissions"),Ir("form_link_id","==",K)),ae=await sn(ne);_(ae.docs.map(ue=>({id:ue.id,...ue.data()})))}catch(ne){console.error("Error loading submissions:",ne),l("Failed to load submissions")}finally{s(!1)}},le=async K=>{if(t)try{T(ne=>new Set(ne).add(K.id)),await ns(Lt(Qe,"beneficiaries"),{...K,team_id:t.id,created_at:new Date}),alert("Successfully added to Beneficiary List")}catch(ne){console.error("Error adding to beneficiary list:",ne),alert("Failed to add to Beneficiary List")}finally{T(ne=>{const ae=new Set(ne);return ae.delete(K.id),ae})}},P=async()=>{if(!(!t||k.size===0)&&confirm(`Are you sure you want to add ${k.size} submissions to the beneficiary list?`))try{N(!0);const K=u2(Qe);let ne=0,ae=0;const ue=m.filter(ce=>k.has(ce.id));for(const ce of ue)try{await ns(Lt(Qe,"beneficiaries"),{...ce,team_id:t.id,created_at:new Date}),ne++}catch(De){console.error("Error adding submission to beneficiary list:",De),ae++}I(new Set),alert(`Added ${ne} submissions to Beneficiary List. ${ae>0?`Failed to add ${ae} submissions.`:""}`)}catch(K){console.error("Error in bulk add operation:",K),alert("Failed to complete bulk add operation")}finally{N(!1)}},Q=K=>{I(ne=>{const ae=new Set(ne);return ae.has(K)?ae.delete(K):ae.add(K),ae})},re=()=>{k.size===G.length?I(new Set):I(new Set(G.map(K=>K.id)))},O=K=>{D(ne=>(ne==null?void 0:ne.field)===K?ne.direction==="asc"?{field:K,direction:"desc"}:null:{field:K,direction:"asc"})},q=K=>{S(ne=>{const ae=new Set(ne);return ae.has(K)?ae.delete(K):ae.add(K),ae})},G=[...m.filter(K=>w?dc.some(({key:ne})=>{const ae=K[ne];return ae&&ae.toString().toLowerCase().includes(w.toLowerCase())}):!0)].sort((K,ne)=>{if(!j)return 0;const ae=K[j.field],ue=ne[j.field];if(!ae&&!ue)return 0;if(!ae)return 1;if(!ue)return-1;const ce=ae.toString().localeCompare(ue.toString());return j.direction==="asc"?ce:-ce});return t?x.jsxs("div",{className:"space-y-6",children:[x.jsx("div",{className:"border-b border-gray-200",children:x.jsxs("nav",{className:"-mb-px flex space-x-8",children:[x.jsxs("button",{onClick:()=>r("links"),className:`py-4 px-1 inline-flex items-center border-b-2 font-medium text-sm ${e==="links"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(e3,{className:"w-5 h-5 mr-2"}),"Form Links"]}),x.jsxs("button",{onClick:()=>r("submissions"),className:`py-4 px-1 inline-flex items-center border-b-2 font-medium text-sm ${e==="submissions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(ry,{className:"w-5 h-5 mr-2"}),"Submissions"]})]})}),o&&x.jsx("div",{className:"p-4 bg-red-50 text-red-700 rounded-md",children:o}),e==="links"?x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Form Links"}),x.jsxs("form",{onSubmit:he,className:"flex gap-2",children:[x.jsx("input",{type:"text",value:c,onChange:K=>u(K.target.value),placeholder:"Enter form name",className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),x.jsx("button",{type:"submit",disabled:a||!c.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:"Create Link"})]})]}),x.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:x.jsx("ul",{className:"divide-y divide-gray-200",children:n.map(K=>x.jsx("li",{className:"p-4",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"text-lg font-medium text-gray-900",children:K.name}),x.jsxs("p",{className:"text-sm text-gray-500",children:["Created: ",K.created_at.toLocaleDateString()]}),x.jsxs("p",{className:"text-sm text-gray-500",children:["Submissions: ",K.submissions_count]})]}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("button",{onClick:()=>{g(K.id),r("submissions")},className:"p-2 text-blue-600 hover:text-blue-800",title:"View Submissions",children:x.jsx(ry,{className:"w-5 h-5"})}),x.jsx("button",{onClick:()=>Ae(K.id),className:"p-2 text-gray-600 hover:text-gray-800",title:"Copy Link",children:h===K.id?x.jsx(YR,{className:"w-5 h-5 text-green-600"}):x.jsx(dk,{className:"w-5 h-5"})}),x.jsx("button",{onClick:()=>de(K.id),className:"p-2 text-red-600 hover:text-red-800",title:"Delete Link",children:x.jsx(gu,{className:"w-5 h-5"})})]})]})},K.id))})})]}):x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("div",{className:"flex-1 max-w-lg",children:x.jsxs("div",{className:"relative",children:[x.jsx(Iv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),x.jsx("input",{type:"text",value:w,onChange:K=>R(K.target.value),placeholder:"Search submissions...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),x.jsxs("div",{className:"flex items-center space-x-4",children:[k.size>0&&x.jsxs("button",{onClick:P,disabled:b||k.size===0,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center",children:[x.jsx(QR,{className:"w-4 h-4 mr-2"}),"Bulk Add (",k.size,")"]}),x.jsxs("select",{value:p||"",onChange:K=>g(K.target.value||null),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[x.jsx("option",{value:"",children:"Select Form Link"}),n.map(K=>x.jsxs("option",{value:K.id,children:[K.name," (",K.submissions_count,")"]},K.id))]}),x.jsxs("div",{className:"relative",children:[x.jsxs("button",{type:"button",className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 flex items-center",onClick:()=>{const K=document.getElementById("column-menu");K==null||K.classList.toggle("hidden")},children:[x.jsx(ZR,{className:"w-4 h-4 mr-2"}),"Columns"]}),x.jsx("div",{id:"column-menu",className:"hidden absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",children:x.jsx("div",{className:"py-1",role:"menu",children:dc.map(({key:K,label:ne})=>x.jsxs("label",{className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:E.has(K),onChange:()=>q(K),className:"mr-2"}),ne]},K))})})]})]})]}),x.jsx("div",{className:"bg-white shadow overflow-x-auto rounded-lg",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[x.jsx("thead",{className:"bg-gray-50",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:x.jsx("input",{type:"checkbox",checked:k.size>0&&k.size===G.length,onChange:re,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"}),dc.filter(({key:K})=>E.has(K)).map(({key:K,label:ne})=>x.jsx("th",{onClick:()=>O(K),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap cursor-pointer group hover:bg-gray-100",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{children:ne}),x.jsx("span",{className:"ml-2",children:(j==null?void 0:j.field)===K?j.direction==="asc"?x.jsx(Va,{className:"w-4 h-4"}):x.jsx(Ms,{className:"w-4 h-4"}):x.jsx(Va,{className:"w-4 h-4 opacity-0 group-hover:opacity-50"})})]})},K)),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Submitted"})]})}),x.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[G.map(K=>{var ne;return x.jsxs("tr",{className:"hover:bg-gray-50",children:[x.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:x.jsx("input",{type:"checkbox",checked:k.has(K.id),onChange:()=>Q(K.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsx("button",{onClick:()=>le(K),disabled:y.has(K.id),className:"text-green-600 hover:text-green-800 disabled:opacity-50",title:"Add to Beneficiary List",children:x.jsx(gk,{className:"w-5 h-5"})})}),dc.filter(({key:ae})=>E.has(ae)).map(({key:ae})=>x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae==="amount"&&K[ae]?`${K[ae].toLocaleString()}`:K[ae]||"-"},ae)),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date((ne=K.created_at)==null?void 0:ne.toDate()).toLocaleDateString()})]},K.id)}),G.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:E.size+2,className:"px-6 py-4 text-center text-gray-500",children:"No submissions found"})})]})]})})]})]}):x.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-700 rounded-md",children:"Please select a team to manage form links."})}function v$(){const{currentTeam:t,updateTeam:e,deleteTeam:r}=So(),[n,i]=X.useState((t==null?void 0:t.name)||""),[a,s]=X.useState((t==null?void 0:t.description)||""),[o,l]=X.useState(null),[c,u]=X.useState(null),[h,d]=X.useState(!1),[p,g]=X.useState(!1);zh.useEffect(()=>{t&&(i(t.name),s(t.description||""))},[t]);const m=async y=>{if(y.preventDefault(),!t){l("No team selected");return}if(!n.trim()){l("Team name is required");return}try{l(null),u(null),d(!0),await e(t.id,n.trim(),a.trim()||void 0),u("Team settings updated successfully")}catch(T){l(T.message||"Failed to update team"),console.error("Update team error:",T)}finally{d(!1)}},_=async()=>{if(t)try{await r(t.id),g(!1)}catch(y){console.error("Delete team error:",y),l("Failed to delete team")}};return t?x.jsxs("div",{className:"space-y-8",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Team Settings"}),o&&x.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-md mb-4",children:o}),c&&x.jsx("div",{className:"bg-green-50 text-green-700 p-3 rounded-md mb-4",children:c}),x.jsxs("form",{onSubmit:m,className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"team-name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Team Name*"}),x.jsx("input",{id:"team-name",type:"text",value:n,onChange:y=>i(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter team name",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"team-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),x.jsx("textarea",{id:"team-description",value:a,onChange:y=>s(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter team description",rows:3})]}),x.jsxs("div",{className:"flex justify-between pt-2",children:[x.jsxs("button",{type:"button",onClick:()=>g(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-red-700 bg-red-50 rounded-md hover:bg-red-100",children:[x.jsx(gu,{className:"w-4 h-4 mr-2"}),"Delete Team"]}),x.jsxs("button",{type:"submit",disabled:h,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:[x.jsx(mu,{className:"w-4 h-4 mr-2"}),h?"Saving...":"Save Changes"]})]})]})]}),x.jsx("div",{className:"border-t border-gray-200 pt-8",children:x.jsx(g$,{})}),p&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Team"}),x.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:['Are you sure you want to delete the team "',t.name,'"? This action cannot be undone.']}),x.jsxs("div",{className:"flex justify-end space-x-3",children:[x.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),x.jsx("button",{onClick:_,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"Delete"})]})]})})]}):x.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-700 rounded-md",children:"Please select or create a team to manage settings."})}function x$(){const{pendingInvitations:t,acceptTeamInvitation:e,removeTeamMember:r}=So();return t.length===0?null:x.jsxs("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"Pending Team Invitations"}),x.jsx("p",{className:"text-sm text-blue-700 mb-4",children:"You have been invited to join the following teams. Accept to join or decline to remove the invitation."}),x.jsx("div",{className:"space-y-3",children:t.map(n=>x.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-md shadow-sm",children:[x.jsxs("div",{children:[x.jsx("p",{className:"font-medium",children:"Team Invitation"}),x.jsxs("p",{className:"text-sm text-gray-500",children:["Role: ",n.role.charAt(0).toUpperCase()+n.role.slice(1)]})]}),x.jsxs("div",{className:"flex space-x-2",children:[x.jsx("button",{onClick:()=>e(n.id),className:"p-1.5 bg-green-100 text-green-700 rounded-full hover:bg-green-200",title:"Accept invitation",children:x.jsx(KR,{className:"w-4 h-4"})}),x.jsx("button",{onClick:()=>r(n.id),className:"p-1.5 bg-red-100 text-red-700 rounded-full hover:bg-red-200",title:"Decline invitation",children:x.jsx(vu,{className:"w-4 h-4"})})]})]},n.id))})]})}function R2(){const{signOut:t,currentUser:e}=mf(),[r,n]=X.useState("members"),[i,a]=X.useState(!1);return x.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[x.jsxs("div",{className:"flex justify-between items-center mb-6",children:[x.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Team Management"}),x.jsxs("div",{className:"flex items-center space-x-4",children:[x.jsx(d$,{onCreateTeamClick:()=>a(!0)}),x.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[x.jsx("span",{className:"mr-2",children:e==null?void 0:e.email}),x.jsx("button",{onClick:()=>t(),className:"text-red-600 hover:text-red-800",title:"Sign Out",children:x.jsx(r3,{className:"w-4 h-4"})})]})]})]}),x.jsx(x$,{}),x.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[x.jsx("div",{className:"border-b border-gray-200",children:x.jsxs("nav",{className:"flex -mb-px",children:[x.jsxs("button",{onClick:()=>n("members"),className:`py-4 px-6 inline-flex items-center border-b-2 font-medium text-sm ${r==="members"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(lh,{className:"w-5 h-5 mr-2"}),"Team Members"]}),x.jsxs("button",{onClick:()=>n("settings"),className:`py-4 px-6 inline-flex items-center border-b-2 font-medium text-sm ${r==="settings"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(pk,{className:"w-5 h-5 mr-2"}),"Team Settings"]})]})}),x.jsx("div",{className:"p-6",children:r==="members"?x.jsx(m$,{}):x.jsx(v$,{})})]}),x.jsx(p$,{isOpen:i,onClose:()=>a(!1)})]})}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bh(){return Bh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bh.apply(this,arguments)}var Ha;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ha||(Ha={}));const F2="popstate";function _$(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:s,hash:o}=n.location;return Ig("",{pathname:a,search:s,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:XI(i)}return w$(e,r,null,t)}function Sn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function KI(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function y$(){return Math.random().toString(36).substr(2,8)}function P2(t,e){return{usr:t.state,key:t.key,idx:e}}function Ig(t,e,r,n){return r===void 0&&(r=null),Bh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Od(e):e,{state:r,key:e&&e.key||n||y$()})}function XI(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Od(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function w$(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,s=i.history,o=Ha.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(Bh({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function h(){o=Ha.Pop;let _=u(),y=_==null?null:_-c;c=_,l&&l({action:o,location:m.location,delta:y})}function d(_,y){o=Ha.Push;let T=Ig(m.location,_,y);c=u()+1;let w=P2(T,c),R=m.createHref(T);try{s.pushState(w,"",R)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(R)}a&&l&&l({action:o,location:m.location,delta:1})}function p(_,y){o=Ha.Replace;let T=Ig(m.location,_,y);c=u();let w=P2(T,c),R=m.createHref(T);s.replaceState(w,"",R),a&&l&&l({action:o,location:m.location,delta:0})}function g(_){let y=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof _=="string"?_:XI(_);return T=T.replace(/ $/,"%20"),Sn(y,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,y)}let m={get action(){return o},get location(){return t(i,s)},listen(_){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(F2,h),l=_,()=>{i.removeEventListener(F2,h),l=null}},createHref(_){return e(i,_)},createURL:g,encodeLocation(_){let y=g(_);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:p,go(_){return s.go(_)}};return m}var D2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(D2||(D2={}));function E$(t,e,r){return r===void 0&&(r="/"),T$(t,e,r,!1)}function T$(t,e,r,n){let i=typeof e=="string"?Od(e):e,a=JI(i.pathname||"/",r);if(a==null)return null;let s=YI(t);k$(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let c=O$(a);o=P$(s[l],c,n)}return o}function YI(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,s,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};l.relativePath.startsWith("/")&&(Sn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ml([n,l.relativePath]),u=r.concat(l);a.children&&a.children.length>0&&(Sn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),YI(a.children,e,u,c)),!(a.path==null&&!a.index)&&e.push({path:c,score:R$(c,a.index),routesMeta:u})};return t.forEach((a,s)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,s);else for(let l of QI(a.path))i(a,s,l)}),e}function QI(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let s=QI(n.join("/")),o=[];return o.push(...s.map(l=>l===""?a:[a,l].join("/"))),i&&o.push(...s),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function k$(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:F$(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const S$=/^:[\w-]+$/,A$=3,I$=2,b$=1,C$=10,N$=-2,O2=t=>t==="*";function R$(t,e){let r=t.split("/"),n=r.length;return r.some(O2)&&(n+=N$),e&&(n+=I$),r.filter(i=>!O2(i)).reduce((i,a)=>i+(S$.test(a)?A$:a===""?b$:C$),n)}function F$(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function P$(t,e,r){let{routesMeta:n}=t,i={},a="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",h=L2({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=L2({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(i,h.params),s.push({params:i,pathname:ml([a,h.pathname]),pathnameBase:L$(ml([a,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(a=ml([a,h.pathnameBase]))}return s}function L2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=D$(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let m=o[h]||"";s=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[h];return p&&!g?c[d]=void 0:c[d]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:s,pattern:t}}function D$(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),KI(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function O$(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return KI(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function JI(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const ml=t=>t.join("/").replace(/\/\/+/g,"/"),L$=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/");function M$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const ZI=["post","put","patch","delete"];new Set(ZI);const j$=["get",...ZI];new Set(j$);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vh(){return Vh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vh.apply(this,arguments)}const B$=X.createContext(null),V$=X.createContext(null),eb=X.createContext(null),Ld=X.createContext(null),gf=X.createContext({outlet:null,matches:[],isDataRoute:!1}),tb=X.createContext(null);function a1(){return X.useContext(Ld)!=null}function U$(){return a1()||Sn(!1),X.useContext(Ld).location}function z$(){let{matches:t}=X.useContext(gf),e=t[t.length-1];return e?e.params:{}}function W$(t,e){return H$(t,e)}function H$(t,e,r,n){a1()||Sn(!1);let{navigator:i,static:a}=X.useContext(eb),{matches:s}=X.useContext(gf),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=U$(),h;if(e){var d;let y=typeof e=="string"?Od(e):e;c==="/"||(d=y.pathname)!=null&&d.startsWith(c)||Sn(!1),h=y}else h=u;let p=h.pathname||"/",g=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=!a&&r&&r.matches&&r.matches.length>0?r.matches:E$(t,{pathname:g}),_=X$(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:ml([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:ml([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&_?X.createElement(Ld.Provider,{value:{location:Vh({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ha.Pop}},_):_}function $$(){let t=Z$(),e=M$(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),r?X.createElement("pre",{style:i},r):null,null)}const G$=X.createElement($$,null);class q$ extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?X.createElement(gf.Provider,{value:this.props.routeContext},X.createElement(tb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function K$(t){let{routeContext:e,match:r,children:n}=t,i=X.useContext(B$);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),X.createElement(gf.Provider,{value:e},n)}function X$(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let u=s.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||Sn(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<s.length;u++){let h=s[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:p}=r,g=h.route.loader&&d[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||g){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,h,d)=>{let p,g=!1,m=null,_=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||G$,l&&(c<0&&d===0?(g=!0,_=null):c===d&&(g=!0,_=h.route.hydrateFallbackElement||null)));let y=e.concat(s.slice(0,d+1)),T=()=>{let w;return p?w=m:g?w=_:h.route.Component?w=X.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=u,X.createElement(K$,{match:h,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?X.createElement(q$,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:T(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):T()},null)}var bg=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(bg||{});function Y$(t){let e=X.useContext(V$);return e||Sn(!1),e}function Q$(t){let e=X.useContext(gf);return e||Sn(!1),e}function J$(t){let e=Q$(),r=e.matches[e.matches.length-1];return r.route.id||Sn(!1),r.route.id}function Z$(){var t;let e=X.useContext(tb),r=Y$(bg.UseRouteError),n=J$(bg.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function eG(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Cg(t){Sn(!1)}function tG(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ha.Pop,navigator:a,static:s=!1,future:o}=t;a1()&&Sn(!1);let l=e.replace(/^\/*/,"/"),c=X.useMemo(()=>({basename:l,navigator:a,static:s,future:Vh({v7_relativeSplatPath:!1},o)}),[l,o,a,s]);typeof n=="string"&&(n=Od(n));let{pathname:u="/",search:h="",hash:d="",state:p=null,key:g="default"}=n,m=X.useMemo(()=>{let _=JI(u,l);return _==null?null:{location:{pathname:_,search:h,hash:d,state:p,key:g},navigationType:i}},[l,u,h,d,p,g,i]);return m==null?null:X.createElement(eb.Provider,{value:c},X.createElement(Ld.Provider,{children:r,value:m}))}function rG(t){let{children:e,location:r}=t;return W$(Ng(e),r)}new Promise(()=>{});function Ng(t,e){e===void 0&&(e=[]);let r=[];return X.Children.forEach(t,(n,i)=>{if(!X.isValidElement(n))return;let a=[...e,i];if(n.type===X.Fragment){r.push.apply(r,Ng(n.props.children,a));return}n.type!==Cg&&Sn(!1),!n.props.index||!n.props.children||Sn(!1);let s={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Ng(n.props.children,a)),r.push(s)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const nG="6";try{window.__reactRouterVersion=nG}catch{}const iG="startTransition",M2=Ob[iG];function aG(t){let{basename:e,children:r,future:n,window:i}=t,a=X.useRef();a.current==null&&(a.current=_$({window:i,v5Compat:!0}));let s=a.current,[o,l]=X.useState({action:s.action,location:s.location}),{v7_startTransition:c}=n||{},u=X.useCallback(h=>{c&&M2?M2(()=>l(h)):l(h)},[l,c]);return X.useLayoutEffect(()=>s.listen(u),[s,u]),X.useEffect(()=>eG(n),[n]),X.createElement(tG,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}var j2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(j2||(j2={}));var B2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(B2||(B2={}));const $p={last_name:"",first_name:"",middle_name:"",extension_name:"",birth_month:"",birth_day:"",birth_year:"",sex:"",barangay:"",psgc_city:"",city:"",province:"",type_of_assistance:"",amount:"",philsys_number:"",beneficiary_uniq:"",contact_number:"",target_sector:"",sub_category:"",civil_status:""};function sG(){const{teamId:t,formLinkId:e}=z$(),[r,n]=X.useState("form"),[i,a]=X.useState($p),[s,o]=X.useState(!1),[l,c]=X.useState(null),[u,h]=X.useState({}),[d,p]=X.useState(!1),[g,m]=X.useState(null),[_,y]=X.useState([]),[T,w]=X.useState(null),[R,j]=X.useState(""),[D,E]=X.useState(null);X.useEffect(()=>{t&&e&&(k(),S())},[t,e]);const S=async()=>{try{const P=Hr(Lt(Qe,"form_submissions"),Ir("form_link_id","==",e),Yx("created_at","desc")),Q=await sn(P);y(Q.docs.map(re=>{var O;return{id:re.id,...re.data(),created_at:(O=re.data().created_at)==null?void 0:O.toDate()}}))}catch(P){console.error("Error loading previous submissions:",P)}},k=async()=>{try{const P=await Tg(mn(Qe,"form_links",e));if(!P.exists()){c("Invalid form link");return}m(P.data())}catch(P){console.error("Error loading form link:",P),c("Failed to load form")}},I=P=>{const{name:Q,value:re}=P.target;Q==="middle_name"&&re.length===1?h(O=>({...O,middle_name:"Please enter complete middle name, not just an initial"})):h(O=>({...O,[Q]:""})),a(O=>({...O,[Q]:re}))},b=()=>{const P={};let Q=!0;if([{key:"last_name",label:"Last Name"},{key:"first_name",label:"First Name"},{key:"middle_name",label:"Middle Name"},{key:"birth_month",label:"Birth Month"},{key:"birth_day",label:"Birth Day"},{key:"birth_year",label:"Birth Year"},{key:"sex",label:"Sex"},{key:"civil_status",label:"Civil Status"},{key:"province",label:"Province"},{key:"city",label:"City"},{key:"barangay",label:"Barangay"}].forEach(({key:O,label:q})=>{var H;(H=i[O])!=null&&H.trim()||(P[O]=`${q} is required`,Q=!1)}),i.middle_name.trim().length===1&&(P.middle_name="Please enter complete middle name, not just an initial",Q=!1),i.birth_year&&i.birth_month&&i.birth_day){const O=new Date(parseInt(i.birth_year),["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(i.birth_month),parseInt(i.birth_day)),q=new Date;let H=q.getFullYear()-O.getFullYear();const G=q.getMonth()-O.getMonth();(G<0||G===0&&q.getDate()<O.getDate())&&H--,H<18&&(P.birth_year="Applicant must be 18 years or older",Q=!1)}return h(P),Q},N=async P=>{if(P.preventDefault(),c(null),!t||!e){c("Invalid form link");return}if(!b()){c("Please complete all required fields correctly");return}o(!0);try{const Q={...i,amount:parseFloat(i.amount)||0,team_id:t,form_link_id:e,created_at:new Date};T?await fl(mn(Qe,"form_submissions",T),{...Q,updated_at:new Date}):await ns(Lt(Qe,"form_submissions"),Q),await S(),p(!0),a($p),h({}),w(null),n("submissions")}catch(Q){console.error("Submit error:",Q),c("Failed to submit application. Please try again.")}finally{o(!1)}},F=P=>{var Q;a({last_name:P.last_name||"",first_name:P.first_name||"",middle_name:P.middle_name||"",extension_name:P.extension_name||"",birth_month:P.birth_month||"",birth_day:P.birth_day||"",birth_year:P.birth_year||"",sex:P.sex||"",barangay:P.barangay||"",psgc_city:P.psgc_city||"",city:P.city||"",province:P.province||"",type_of_assistance:P.type_of_assistance||"",amount:((Q=P.amount)==null?void 0:Q.toString())||"",philsys_number:P.philsys_number||"",beneficiary_uniq:P.beneficiary_uniq||"",contact_number:P.contact_number||"",target_sector:P.target_sector||"",sub_category:P.sub_category||"",civil_status:P.civil_status||""}),w(P.id),p(!1),n("form"),window.scrollTo({top:0,behavior:"smooth"})},he=()=>{a($p),w(null),h({})},de=P=>{E(Q=>(Q==null?void 0:Q.field)===P?Q.direction==="asc"?{field:P,direction:"desc"}:null:{field:P,direction:"asc"})},ve=[..._.filter(P=>R?["last_name","first_name","middle_name","barangay","city","province","type_of_assistance"].some(re=>{var O;return(O=P[re])==null?void 0:O.toString().toLowerCase().includes(R.toLowerCase())}):!0)].sort((P,Q)=>{if(!D)return 0;const re=P[D.field],O=Q[D.field];if(!re&&!O)return 0;if(!re)return 1;if(!O)return-1;const q=re.toString().localeCompare(O.toString());return D.direction==="asc"?q:-q});if(l)return x.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:x.jsx("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow",children:x.jsxs("div",{className:"text-center",children:[x.jsx("h2",{className:"text-3xl font-extrabold text-red-600 mb-4",children:"Error"}),x.jsx("p",{className:"text-gray-600 mb-8",children:l})]})})});if(d&&r==="form")return x.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:x.jsx("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow",children:x.jsxs("div",{className:"text-center",children:[x.jsx("h2",{className:"text-3xl font-extrabold text-green-600 mb-4",children:"Application Submitted!"}),x.jsx("p",{className:"text-gray-600 mb-8",children:"Thank you for submitting your application. The team will review your information."}),x.jsxs("div",{className:"space-x-4",children:[x.jsxs("button",{onClick:()=>p(!1),className:"inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[x.jsx(qR,{className:"w-5 h-5 mr-2"}),"Submit Another Application"]}),x.jsxs("button",{onClick:()=>n("submissions"),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[x.jsx(lh,{className:"w-5 h-5 mr-2"}),"View All Submissions"]})]})]})})});const le=P=>u[P]?x.jsxs("div",{className:"mt-1 text-sm text-red-600 flex items-center",children:[x.jsx(XR,{className:"w-4 h-4 mr-1"}),u[P]]}):null;return x.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:x.jsx("div",{className:"max-w-6xl mx-auto",children:x.jsxs("div",{className:"bg-white p-8 rounded-lg shadow",children:[x.jsxs("div",{className:"flex justify-between items-center mb-8",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:(g==null?void 0:g.name)||"Beneficiary Application Form"}),T&&x.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Editing existing submission"})]}),x.jsx("div",{className:"border-b border-gray-200",children:x.jsxs("nav",{className:"-mb-px flex space-x-8",children:[x.jsxs("button",{onClick:()=>n("form"),className:`py-4 px-1 inline-flex items-center border-b-2 font-medium text-sm ${r==="form"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(oh,{className:"w-5 h-5 mr-2"}),"Application Form"]}),x.jsxs("button",{onClick:()=>n("submissions"),className:`py-4 px-1 inline-flex items-center border-b-2 font-medium text-sm ${r==="submissions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(lh,{className:"w-5 h-5 mr-2"}),"Previous Submissions"]})]})})]}),r==="form"?x.jsxs("form",{onSubmit:N,className:"space-y-6",children:[x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Personal Information"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Last Name",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"text",name:"last_name",value:i.last_name,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.last_name?"border-red-300":"border-gray-300"}`}),le("last_name")]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["First Name",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"text",name:"first_name",value:i.first_name,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.first_name?"border-red-300":"border-gray-300"}`}),le("first_name")]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Middle Name",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"text",name:"middle_name",value:i.middle_name,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.middle_name?"border-red-300":"border-gray-300"}`}),le("middle_name")]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Extension Name"}),x.jsx("input",{type:"text",name:"extension_name",value:i.extension_name,onChange:I,placeholder:"Jr., Sr., III, etc.",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]})]}),x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Birth Information",x.jsx("span",{className:"text-red-600",children:"*"}),x.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"(Must be 18 years or older)"})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Birth Month",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsxs("select",{name:"birth_month",value:i.birth_month,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.birth_month?"border-red-300":"border-gray-300"}`,children:[x.jsx("option",{value:"",children:"Select Month"}),["January","February","March","April","May","June","July","August","September","October","November","December"].map(P=>x.jsx("option",{value:P,children:P},P))]}),le("birth_month")]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Birth Day",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"number",name:"birth_day",value:i.birth_day,onChange:I,min:"1",max:"31",required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.birth_day?"border-red-300":"border-gray-300"}`}),le("birth_day")]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Birth Year",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"number",name:"birth_year",value:i.birth_year,onChange:I,min:"1900",max:new Date().getFullYear()-18,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.birth_year?"border-red-300":"border-gray-300"}`}),le("birth_year")]})]})]}),x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Information"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Sex",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsxs("select",{name:"sex",value:i.sex,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.sex?"border-red-300":"border-gray-300"}`,children:[x.jsx("option",{value:"",children:"Select Sex"}),x.jsx("option",{value:"Male",children:"Male"}),x.jsx("option",{value:"Female",children:"Female"})]}),le("sex")]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Civil Status",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsxs("select",{name:"civil_status",value:i.civil_status,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.civil_status?"border-red-300":"border-gray-300"}`,children:[x.jsx("option",{value:"",children:"Select Civil Status"}),x.jsx("option",{value:"Single",children:"Single"}),x.jsx("option",{value:"Married",children:"Married"}),x.jsx("option",{value:"Widowed",children:"Widowed"}),x.jsx("option",{value:"Separated",children:"Separated"})]}),le("civil_status")]})]})]}),x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Address Information"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Province",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"text",name:"province",value:i.province,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.province?"border-red-300":"border-gray-300"}`}),le("province")]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["City",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"text",name:"city",value:i.city,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.city?"border-red-300":"border-gray-300"}`}),le("city")]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Barangay",x.jsx("span",{className:"text-red-600",children:"*"})]}),x.jsx("input",{type:"text",name:"barangay",value:i.barangay,onChange:I,required:!0,className:`mt-1 block w-full rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${u.barangay?"border-red-300":"border-gray-300"}`}),le("barangay")]})]})]}),x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Contact Information"}),x.jsx("div",{className:"grid grid-cols-1 gap-4",children:x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Number"}),x.jsx("input",{type:"tel",name:"contact_number",value:i.contact_number,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})})]}),x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Assistance Information"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type of Assistance"}),x.jsx("input",{type:"text",name:"type_of_assistance",value:i.type_of_assistance,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),x.jsx("input",{type:"number",name:"amount",value:i.amount,onChange:I,min:"0",step:"0.01",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]})]}),x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Identification"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PhilSys Number"}),x.jsx("input",{type:"text",name:"philsys_number",value:i.philsys_number,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Beneficiary ID"}),x.jsx("input",{type:"text",name:"beneficiary_uniq",value:i.beneficiary_uniq,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]})]}),x.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Classification"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Target Sector"}),x.jsx("input",{type:"text",name:"target_sector",value:i.target_sector,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Sub Category"}),x.jsx("input",{type:"text",name:"sub_category",value:i.sub_category,onChange:I,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]})]}),x.jsxs("div",{className:"flex justify-end space-x-4",children:[T&&x.jsxs("button",{type:"button",onClick:he,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:[x.jsx(vu,{className:"w-5 h-5 mr-2 inline"}),"Cancel Edit"]}),x.jsxs("button",{type:"submit",disabled:s,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[x.jsx(mu,{className:"w-5 h-5 mr-2"}),s?"Submitting...":T?"Update Application":"Submit Application"]})]})]}):x.jsxs("div",{className:"space-y-6",children:[x.jsx("div",{className:"flex items-center justify-between",children:x.jsx("div",{className:"flex-1 max-w-lg",children:x.jsxs("div",{className:"relative",children:[x.jsx(Iv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),x.jsx("input",{type:"text",value:R,onChange:P=>j(P.target.value),placeholder:"Search submissions...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})})}),x.jsx("div",{className:"bg-white shadow overflow-x-auto rounded-lg",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[x.jsx("thead",{className:"bg-gray-50",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"}),x.jsx("th",{onClick:()=>de("last_name"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{children:"Name"}),x.jsx("span",{className:"ml-2",children:(D==null?void 0:D.field)==="last_name"?D.direction==="asc"?x.jsx(Va,{className:"w-4 h-4"}):x.jsx(Ms,{className:"w-4 h-4"}):null})]})}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),x.jsx("th",{onClick:()=>de("type_of_assistance"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{children:"Type of Assistance"}),x.jsx("span",{className:"ml-2",children:(D==null?void 0:D.field)==="type_of_assistance"?D.direction==="asc"?x.jsx(Va,{className:"w-4 h-4"}):x.jsx(Ms,{className:"w-4 h-4"}):null})]})}),x.jsx("th",{onClick:()=>de("amount"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{children:"Amount"}),x.jsx("span",{className:"ml-2",children:(D==null?void 0:D.field)==="amount"?D.direction==="asc"?x.jsx(Va,{className:"w-4 h-4"}):x.jsx(Ms,{className:"w-4 h-4"}):null})]})}),x.jsx("th",{onClick:()=>de("created_at"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{children:"Submitted"}),x.jsx("span",{className:"ml-2",children:(D==null?void 0:D.field)==="created_at"?D.direction==="asc"?x.jsx(Va,{className:"w-4 h-4"}):x.jsx(Ms,{className:"w-4 h-4"}):null})]})})]})}),x.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[ve.map(P=>x.jsxs("tr",{className:"hover:bg-gray-50",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.jsx("button",{onClick:()=>F(P),className:"text-blue-600 hover:text-blue-800",children:x.jsx(oh,{className:"w-5 h-5"})})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:`${P.last_name}, ${P.first_name} ${P.middle_name}`}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P.contact_number||"-"}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P.type_of_assistance||"-"}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P.amount?`${P.amount.toLocaleString()}`:"-"}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P.created_at.toLocaleDateString()})]},P.id)),ve.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"No submissions found"})})]})]})})]})]})})})}function oG(){const[t,e]=X.useState("import"),[r,n]=X.useState([]),[i,a]=X.useState([]),[s,o]=X.useState({}),[l,c]=X.useState(""),[u,h]=X.useState([]),[d,p]=X.useState(!1),[g,m]=X.useState(null),[_,y]=X.useState({}),{currentTeam:T}=So(),w=(D,E,S)=>{n(D),a(Object.keys(D[0]||{})),h(E),c(E[0]),y(S),m(null)},R=(D,E)=>{o(S=>({...S,[D]:E}))},j=async()=>{if(!T){m({type:"error",text:"Please select or create a team before importing data."});return}p(!0),m(null);try{const D=Lt(Qe,"beneficiaries"),E=r.map(k=>{const I={team_id:T.id};return Object.entries(s).forEach(([b,N])=>{var F;N&&k[b]!==void 0&&(N==="amount"?I[N]=parseFloat(k[b])||0:I[N]=(F=k[b])==null?void 0:F.toString().trim())}),I}),S=500;for(let k=0;k<E.length;k+=S){const I=E.slice(k,k+S);await Promise.all(I.map(b=>ns(D,b)))}m({type:"success",text:"Beneficiary data imported successfully!"}),n([]),a([]),o({}),c(""),h([]),y({})}catch(D){m({type:"error",text:"Failed to import data. Please check your column mappings and try again."}),console.error("Import error:",D)}finally{p(!1)}};return!T&&t!=="team"?x.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:x.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[x.jsx("div",{className:"bg-yellow-50 p-4 rounded-md text-yellow-700 mb-4",children:"Please select or create a team to continue."}),x.jsx(R2,{})]})}):x.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:x.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[x.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"Beneficiary Data Management"}),x.jsxs("div",{className:"bg-white rounded-lg shadow-md mb-6",children:[x.jsx("div",{className:"border-b border-gray-200",children:x.jsxs("nav",{className:"flex -mb-px",children:[x.jsxs("button",{onClick:()=>e("import"),className:`py-4 px-6 inline-flex items-center border-b-2 font-medium text-sm ${t==="import"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(mk,{className:"w-5 h-5 mr-2"}),"Import Data"]}),x.jsxs("button",{onClick:()=>e("list"),className:`py-4 px-6 inline-flex items-center border-b-2 font-medium text-sm ${t==="list"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(t3,{className:"w-5 h-5 mr-2"}),"View List"]}),x.jsxs("button",{onClick:()=>e("team"),className:`py-4 px-6 inline-flex items-center border-b-2 font-medium text-sm ${t==="team"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[x.jsx(pk,{className:"w-5 h-5 mr-2"}),"Team Settings"]})]})}),x.jsx("div",{className:"p-6",children:t==="import"?x.jsxs("div",{className:"space-y-6",children:[x.jsx(lj,{onFileLoad:w}),r.length>0&&x.jsxs("div",{className:"space-y-6",children:[u.length>1&&x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Sheet"}),x.jsx("select",{value:l,onChange:D=>c(D.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(D=>x.jsx("option",{value:D,children:D},D))})]}),x.jsx(cj,{columns:i,mappings:s,onMappingChange:R,columnRefs:_}),g&&x.jsx("div",{className:`p-4 rounded-md ${g.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:g.text}),x.jsxs("button",{onClick:j,disabled:d,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:[x.jsx(mu,{className:"w-5 h-5 mr-2"}),d?"Importing...":"Import Beneficiary Data"]})]})]}):t==="list"?x.jsx(s$,{teamId:T==null?void 0:T.id}):x.jsx(R2,{})})]})]})})}function lG(){return x.jsx(aG,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:x.jsx(o$,{children:x.jsx(l$,{children:x.jsxs(rG,{children:[x.jsx(Cg,{path:"/apply/:teamId/:formLinkId",element:x.jsx(sG,{})}),x.jsx(Cg,{path:"/",element:x.jsx(h$,{children:x.jsx(oG,{})})})]})})})})}Gp.createRoot(document.getElementById("root")).render(x.jsx(zh.StrictMode,{children:x.jsx(lG,{})}));
